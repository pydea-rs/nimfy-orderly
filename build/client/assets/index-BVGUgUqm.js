import{c7 as z,c8 as L,c9 as I,ca as S,cb as ee,aH as Y,cc as te,cd as ae,ce as re,cf as ne,cg as oe,ch as se,an as A,h as ie,ci as ce,n as x,cj as de,ck as U,cl as le,cm as ue,cn as me,aa as R,a1 as he,a3 as G,a2 as M,a4 as j,l as fe,ad as ge,by as pe,co as ye,cp as we,ab as T,bm as be,cq as X,bq as ve,bg as _,aI as V,r as Pe,bi as Ee,cr as ke,cs as Ce,ah as P,E as Ie,bv as Se,bt as xe,o as v,ct as H,bX as C,cu as O,cv as We}from"./index-Bhg9DOVY.js";import{r as d,j as y}from"./index-_b-vxSi4.js";function Ne(t,e,n){const r=z(t,n),a=z(e,n);return+r==+a}const Me={lessThanXSeconds:{one:"不到 1 秒",other:"不到 {{count}} 秒"},xSeconds:{one:"1 秒",other:"{{count}} 秒"},halfAMinute:"半分钟",lessThanXMinutes:{one:"不到 1 分钟",other:"不到 {{count}} 分钟"},xMinutes:{one:"1 分钟",other:"{{count}} 分钟"},xHours:{one:"1 小时",other:"{{count}} 小时"},aboutXHours:{one:"大约 1 小时",other:"大约 {{count}} 小时"},xDays:{one:"1 天",other:"{{count}} 天"},aboutXWeeks:{one:"大约 1 个星期",other:"大约 {{count}} 个星期"},xWeeks:{one:"1 个星期",other:"{{count}} 个星期"},aboutXMonths:{one:"大约 1 个月",other:"大约 {{count}} 个月"},xMonths:{one:"1 个月",other:"{{count}} 个月"},aboutXYears:{one:"大约 1 年",other:"大约 {{count}} 年"},xYears:{one:"1 年",other:"{{count}} 年"},overXYears:{one:"超过 1 年",other:"超过 {{count}} 年"},almostXYears:{one:"将近 1 年",other:"将近 {{count}} 年"}},Ae=(t,e,n)=>{let r;const a=Me[t];return typeof a=="string"?r=a:e===1?r=a.one:r=a.other.replace("{{count}}",String(e)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?r+"内":r+"前":r},De={full:"y'年'M'月'd'日' EEEE",long:"y'年'M'月'd'日'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},Le={full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},Te={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},_e={date:L({formats:De,defaultWidth:"full"}),time:L({formats:Le,defaultWidth:"full"}),dateTime:L({formats:Te,defaultWidth:"full"})};function K(t,e,n){const r="eeee p";return Ne(t,e,n)?r:t.getTime()>e.getTime()?"'下个'"+r:"'上个'"+r}const Oe={lastWeek:K,yesterday:"'昨天' p",today:"'今天' p",tomorrow:"'明天' p",nextWeek:K,other:"PP p"},$e=(t,e,n,r)=>{const a=Oe[t];return typeof a=="function"?a(e,n,r):a},Re={narrow:["前","公元"],abbreviated:["前","公元"],wide:["公元前","公元"]},je={narrow:["1","2","3","4"],abbreviated:["第一季","第二季","第三季","第四季"],wide:["第一季度","第二季度","第三季度","第四季度"]},qe={narrow:["一","二","三","四","五","六","七","八","九","十","十一","十二"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},Fe={narrow:["日","一","二","三","四","五","六"],short:["日","一","二","三","四","五","六"],abbreviated:["周日","周一","周二","周三","周四","周五","周六"],wide:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},ze={narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},Ue={narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},Xe=(t,e)=>{const n=Number(t);switch(e==null?void 0:e.unit){case"date":return n.toString()+"日";case"hour":return n.toString()+"时";case"minute":return n.toString()+"分";case"second":return n.toString()+"秒";default:return"第 "+n.toString()}},Ve={ordinalNumber:Xe,era:I({values:Re,defaultWidth:"wide"}),quarter:I({values:je,defaultWidth:"wide",argumentCallback:t=>t-1}),month:I({values:qe,defaultWidth:"wide"}),day:I({values:Fe,defaultWidth:"wide"}),dayPeriod:I({values:ze,defaultWidth:"wide",formattingValues:Ue,defaultFormattingWidth:"wide"})},He=/^(第\s*)?\d+(日|时|分|秒)?/i,Ke=/\d+/i,Qe={narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},Je={any:[/^(前)/i,/^(公元)/i]},Ye={narrow:/^[1234]/i,abbreviated:/^第[一二三四]刻/i,wide:/^第[一二三四]刻钟/i},Ge={any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},Be={narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},Ze={narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},et={narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^周[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},tt={any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},at={any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨|)/i},rt={any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},nt={ordinalNumber:ee({matchPattern:He,parsePattern:Ke,valueCallback:t=>parseInt(t,10)}),era:S({matchPatterns:Qe,defaultMatchWidth:"wide",parsePatterns:Je,defaultParseWidth:"any"}),quarter:S({matchPatterns:Ye,defaultMatchWidth:"wide",parsePatterns:Ge,defaultParseWidth:"any",valueCallback:t=>t+1}),month:S({matchPatterns:Be,defaultMatchWidth:"wide",parsePatterns:Ze,defaultParseWidth:"any"}),day:S({matchPatterns:et,defaultMatchWidth:"wide",parsePatterns:tt,defaultParseWidth:"any"}),dayPeriod:S({matchPatterns:at,defaultMatchWidth:"any",parsePatterns:rt,defaultParseWidth:"any"})},ot={code:"zh-CN",formatDistance:Ae,formatLong:_e,formatRelative:$e,localize:Ve,match:nt,options:{weekStartsOn:1,firstWeekContainsDate:4}};var st=()=>{d.useEffect(()=>{let t=new URLSearchParams(window.location.search).get("ref");t&&localStorage.setItem("referral_code",t)},[])},Q="orderly:wallet-info";function it(){let{connectedChain:t,disconnect:e}=j(),[n,r]=fe("orderly_link_device",{}),{account:a}=R(),{isMobile:i}=ge(),c=M(),o=async s=>{localStorage.removeItem(Q),await a.disconnect(),await e({label:s})};d.useEffect(()=>{let s=$(),u=JSON.parse(localStorage.getItem(Q)??"{}");s&&u&&o(u.label)},[]);let l=async()=>{let s=$();if(!s)return;let{address:u,secretKey:m,chainId:f,chainNamespace:b}=s;if(!await a.importOrderlyKey({address:u,secretKey:m,chainNamespace:b}))return;r({chainId:f,chainNamespace:b});let E=new URL(window.location.href);E.searchParams.delete("link"),E.searchParams.append("utm_medium","qrcode");let D=decodeURIComponent(E.toString());history.replaceState(null,"",D)};d.useEffect(()=>{i&&!t&&l()},[a,t,i]);let g=async()=>{let{chainId:s,chainNamespace:u}=ct()||{};if(i&&!t&&s&&u){let m=a.keyStore.getAddress(),f=a.keyStore.getOrderlyKey(),b=a.keyStore.getAccountId(m);await a.checkOrderlyKey(m,f,b)&&c.set("chainNamespace",u)}};return d.useEffect(()=>{g()},[a,i,t]),{linkDevice:l}}function ct(){try{let t=localStorage.getItem("orderly_link_device");return t?We(t):null}catch{}}function $(){let t=new URL(window.location.href).searchParams.get("link");if(!t)return;let{a:e,k:n,i:r,n:a}=dt(t)||{};if(e&&n&&r&&a)return{address:e,secretKey:n,chainId:r,chainNamespace:a}}function dt(t){try{let e=JSON.parse(window.atob(t)),n=Math.floor(Date.now()/1e3),r=e.t;return!r||n>r?void 0:e}catch{}}var J="orderly:wallet-info",lt=t=>{let{wallet:e,connect:n,connectedChain:r,disconnect:a,namespace:i}=j();if(typeof n!="function")throw new pe("Please provide a wallet connector provider");A();let c=d.useRef(!1);M("brokerId");let{account:o,state:l}=R(),g=ye(),s=M("networkId"),[u,{checkChainSupport:m}]=G(),[f,b]=d.useState(!1),{track:E,setTrackUserId:D}=Y(),W=d.useMemo(()=>{var h,p;return(p=(h=e==null?void 0:e.accounts)==null?void 0:h[0])==null?void 0:p.address},[e]),w=d.useMemo(()=>{var k,N,q,F;let h=(N=(k=e==null?void 0:e.chains)==null?void 0:k[0])==null?void 0:N.id,p=(F=(q=e==null?void 0:e.chains)==null?void 0:q[0])==null?void 0:F.namespace;if(!(typeof h>"u"))return{id:we(h),namespace:p}},[e]);return d.useEffect(()=>{l.status>=T.EnableTrading&&o.accountId&&D(o.accountId)},[o,l]),d.useEffect(()=>{if(!r){b(!1);return}let h=m(r.id,s);be.has(parseInt(r.id))&&(e==null?void 0:e.label)!=="AGW"&&(h=!1),b(!h)},[r,u,m,s,e]),d.useEffect(()=>{X(()=>{let h=g.getAddress(),p=JSON.parse(localStorage.getItem(J)??"{}");(r==null?void 0:r.namespace)!==ve.solana&&h&&o.address!==h&&p.label&&n({autoSelect:{label:p.label,disableModals:!0}}).then(k=>{},k=>{})})},[e,o.address]),d.useEffect(()=>{if(e===null&&l.status>T.NotConnected&&!l.validating){o.disconnect();return}if(f||!r||c.current)return;let h=$();W&&W!==o.address&&!h&&(o.setAddress(W,{provider:e==null?void 0:e.provider,chain:{id:_(w.id),namespace:w.namespace.toUpperCase()},wallet:{name:(e==null?void 0:e.label)??""},additionalInfo:(e==null?void 0:e.additionalInfo)??{}}),E(V.walletConnect,{wallet:(e==null?void 0:e.label)??"",network:w.namespace.toUpperCase()}),X(()=>{localStorage.setItem(J,JSON.stringify({label:(e==null?void 0:e.label)??""}))})),(w==null?void 0:w.id)!==o.chainId&&o.switchChainId(w==null?void 0:w.id)},[e,r,W,w,o.address,l,o.chainId,f]),{connectWallet:async()=>(c.current=!0,n({chainId:t.currentChainId}).then(async h=>{if(Array.isArray(h)&&h.length>0&&h[0]&&h[0].accounts.length>0){let p=h[0],k=_(p.chains[0].id);if(!m(k,s))return{wrongNetwork:!0};if(!o)throw new Error("account is not initialized");l.status===T.EnableTradingWithoutConnected&&(localStorage.removeItem("orderly_link_device"),await o.disconnect());let N=await o.setAddress(p.accounts[0].address,{provider:p.provider,chain:{id:_(p.chains[0].id),namespace:p.chains[0].namespace.toUpperCase()},wallet:{name:p.label}});return E(V.walletConnect,{wallet:p.label,network:p.chains[0].namespace.toUpperCase()}),{wallet:p,status:N,wrongNetwork:!1}}return null}).finally(()=>{c.current=!1})),wrongNetwork:f}};function ut(){let{t}=x(),e=A(),n=d.useRef({}),[r,a]=Pe("orderly_wallet_change_id",{});n.current=r,Ee({onMessage:i=>{let{id:c,side:o,transStatus:l}=i,g=!0;if(["DEPOSIT","WITHDRAW"].includes(o)&&["COMPLETED","FAILED"].includes(l)){let s=n.current[c];a({...r,[c]:s?void 0:!0}),g=!s}if(l==="COMPLETED"&&g){let s=`${O(o)} completed`;o==="DEPOSIT"?s=t("transfer.deposit.completed"):o==="WITHDRAW"&&(s=t("transfer.withdraw.completed")),P.success(s)}else if(l==="FAILED"&&g){let s=`${O(o)} failed`;o==="DEPOSIT"?s=t("transfer.deposit.failed"):o==="WITHDRAW"&&(s=t("transfer.withdraw.failed")),P.error(s)}e.emit("wallet:changed",i)}})}function mt(){let{t}=x();ke({onMessage:e=>{let{status:n}=e;switch(n){case"COMPLETED":P.success(t("settle.settlement.completed"));break;case"FAILED":P.error(t("settle.settlement.failed"));break}}})}function ht(){let{t}=x(),e=A(),{setLedgerAddress:n}=Ce();return d.useEffect(()=>{e.on("wallet:connect-error",r=>{P.error(r.message)}),e.on("wallet:sign-message-with-ledger-error",r=>{window.setTimeout(()=>{Ie.confirm({title:t("connector.ledger.signMessageFailed"),content:t("connector.ledger.signMessageFailed.description"),size:"sm",onOk:async()=>(n(r.userAddress),Promise.resolve()),okLabel:t("common.ok"),onCancel:async()=>(P.error(r.message),Promise.resolve()),cancelLabel:t("common.no")}).then(a=>{})})})},[e,t]),{}}function ft(t){let{storageChain:e,setStorageChain:n}=he(),[r,a]=d.useState(),[i]=G(),c=M("networkId"),{connectedChain:o}=j();return d.useEffect(()=>{var l,g,s;if(o)a==null||a(typeof o.id=="number"?o.id:parseInt(o.id));else{if(r)return;let u,m=c==="mainnet"?(l=i.mainnet)==null?void 0:l[0]:(g=i.testnet)==null?void 0:g[0];typeof t=="function"?u=t(c,i):typeof t=="object"&&(u=c==="mainnet"?t==null?void 0:t.mainnet:t==null?void 0:t.testnet);let f=(u==null?void 0:u.id)||((s=m==null?void 0:m.network_infos)==null?void 0:s.chain_id);if(!f)return;e?a==null||a(e.chainId):(n(f),a==null||a(f))}},[o,i,r,c,a,t]),[r,a]}var B=d.createContext({setCurrentChainId:t=>{},restrictedInfo:{},setShowAnnouncement:t=>{}}),gt=()=>d.useContext(B),pt=t=>{let[e,n]=d.useState(!1),[r,a]=ft(t.defaultChain);it(),ue();let{connectWallet:i,wrongNetwork:c}=lt({currentChainId:r});ut(),mt(),ht();let o=me(t.restrictedInfo),l=o.restrictedOpen,g=d.useMemo(()=>({connectWallet:i,wrongNetwork:c,currentChainId:r,setCurrentChainId:a,onChainChanged:t.onChainChanged,disabledConnect:l,restrictedInfo:o,showAnnouncement:e,setShowAnnouncement:n}),[i,r,l,t.onChainChanged,o,a,e,c]);return y.jsx(B.Provider,{value:g,children:t.children})},Z=d.createContext({}),It=()=>d.useContext(Z),yt=t=>y.jsx(Z.Provider,{value:t,children:t.children});function wt(t){return t==="BUY"?v.t("common.buy"):t==="SELL"?v.t("common.sell"):O(t)}function bt(t,e){let{symbol:n,side:r,quantity:a}=t,i="total_executed_quantity"in t?t.total_executed_quantity:0,c="status"in t?t.status:t.algo_status,o=e[n],l=o("base_dp"),g=wt(r),s=Se(n),u="algo_type"in t&&t.algo_type===xe.POSITIONAL_TP_SL?v.t("tpsl.entirePosition"):l===void 0?a:H(a,{dp:l}),m="",f="";switch(c){case C.NEW:m=v.t("orders.status.opened.toast.title"),f=`${g} ${s} ${u}`;break;case C.FILLED:case C.PARTIAL_FILLED:let b=l===void 0?i:H(i,{dp:l});m=v.t("orders.status.filled.toast.title"),f=`${g} ${s} ${b} / ${u}`;break;case C.CANCELLED:m=v.t("orders.status.canceled.toast.title"),f=`${g} ${s} ${u}`;break;case C.REJECTED:m=v.t("orders.status.rejected.toast.title"),f=`${g} ${s} ${u}`;break;case C.REPLACED:m=v.t("orders.status.replaced.toast.title"),f=`${r} ${s} ${i} / ${u}`;break}return{title:m,msg:f}}function vt(){let t=A(),e=ie(),n=d.useRef({});d.useEffect(()=>{n.current=e},[e]);let r=ce(a=>{(i=>{let{title:c,msg:o}=bt(i,n.current);c&&o&&P.success(y.jsxs("div",{children:[c,y.jsx("br",{}),y.jsx("div",{className:"orderly-text-white/[0.54] orderly-text-xs",children:o})]}))})(a)},100);d.useEffect(()=>(t.on("orders:changed",r),()=>{t.off("orders:changed",r)}),[])}function Pt(){let{t}=x(),e=de();return d.useMemo(()=>{let n={[U.en]:le,[U.zh]:ot};return{locale:e,dialog:{ok:t("common.ok"),cancel:t("common.cancel")},modal:{confirm:t("common.confirm"),cancel:t("common.cancel")},pagination:{morePages:t("ui.pagination.morePages"),rowsPerPage:t("ui.pagination.rowsPerPage")},picker:{selectDate:t("ui.picker.selectDate"),dayPicker:n[e]},empty:{description:t("ui.empty.description")}}},[t,e])}var Et=t=>{let{components:e,appIcons:n,onChainChanged:r,defaultChain:a,...i}=t;Y(),st(),vt();let c=Pt();return y.jsx(yt,{appIcons:n,brokerName:t.brokerName,children:y.jsx(te,{components:e,overrides:t.overrides,children:y.jsxs(ae,{...i,children:[y.jsx(pt,{onChainChanged:r,defaultChain:a,restrictedInfo:t.restrictedInfo,children:y.jsx(re,{locale:c,children:y.jsx(ne,{delayDuration:300,children:y.jsx(oe,{children:t.children})})})}),y.jsx(se,{})]})})})};Et.displayName="OrderlyAppProvider";var St=(t,e)=>{let{wrongNetwork:n,disabledConnect:r}=gt(),{state:a}=R();return e!=null&&e.skip?t:n||r||typeof(e==null?void 0:e.accountStatus)<"u"&&a.status<e.accountStatus?typeof(e==null?void 0:e.fallbackData)<"u"?e.fallbackData:null:t};function xt(t){let{t:e}=x(),n=(r,a,i)=>{var c;return(c={quantity:{required:e("orderEntry.orderQuantity.error.required"),min:e("orderEntry.orderQuantity.error.min",{value:a}),max:e("orderEntry.orderQuantity.error.max",{value:a})},order_quantity:{required:e("orderEntry.orderQuantity.error.required"),min:e("orderEntry.orderQuantity.error.min",{value:a}),max:e("orderEntry.orderQuantity.error.max",{value:a})},order_price:{required:e("orderEntry.orderPrice.error.required"),min:e("orderEntry.orderPrice.error.min",{value:a}),max:e("orderEntry.orderPrice.error.max",{value:a})},trigger_price:{required:e("orderEntry.triggerPrice.error.required"),min:e("orderEntry.triggerPrice.error.min",{value:a}),max:e("orderEntry.triggerPrice.error.max",{value:a})},tp_trigger_price:{min:e("orderEntry.tpTriggerPrice.error.min",{value:a}),max:e("orderEntry.tpTriggerPrice.error.max",{value:a})},sl_trigger_price:{min:e("orderEntry.slTriggerPrice.error.min",{value:a}),max:e("orderEntry.slTriggerPrice.error.max",{value:a})},total:{min:e("orderEntry.total.error.min",{value:a})}}[r])==null?void 0:c[i]};return{parseErrorMsg:r=>{let{type:a,value:i}=(t==null?void 0:t[r])||{};return a?n(r,i,a):""}}}export{gt as L,St as T,xt as a,It as o,Et as s};
