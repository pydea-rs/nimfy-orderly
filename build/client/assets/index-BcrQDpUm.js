import{b0 as z,b1 as N,b2 as C,b3 as I,b4 as ee,aF as Y,b5 as te,b6 as re,b7 as ae,b8 as ne,b9 as oe,ba as se,aa as L,n as ie,bb as ce,Z as x,bc as de,bd as U,be as le,bf as ue,bg as me,H as he,J as G,I as D,K as R,r as fe,T as q,a0 as ge,bh as pe,bi as ye,bj as be,U as _,am as K,bk as we,bl as A,aG as Q,w as ve,bm as Pe,bn as Ee,bo as ke,a4 as P,G as Se,bp as Ce,bq as Ie,q as v,br as V,bs as k,bt as O,bu as xe}from"./index-hxeryC1o.js";import{r as d,j as y}from"./index-_b-vxSi4.js";function We(e,t,n){const a=z(e,n),r=z(t,n);return+a==+r}const Te={lessThanXSeconds:{one:"不到 1 秒",other:"不到 {{count}} 秒"},xSeconds:{one:"1 秒",other:"{{count}} 秒"},halfAMinute:"半分钟",lessThanXMinutes:{one:"不到 1 分钟",other:"不到 {{count}} 分钟"},xMinutes:{one:"1 分钟",other:"{{count}} 分钟"},xHours:{one:"1 小时",other:"{{count}} 小时"},aboutXHours:{one:"大约 1 小时",other:"大约 {{count}} 小时"},xDays:{one:"1 天",other:"{{count}} 天"},aboutXWeeks:{one:"大约 1 个星期",other:"大约 {{count}} 个星期"},xWeeks:{one:"1 个星期",other:"{{count}} 个星期"},aboutXMonths:{one:"大约 1 个月",other:"大约 {{count}} 个月"},xMonths:{one:"1 个月",other:"{{count}} 个月"},aboutXYears:{one:"大约 1 年",other:"大约 {{count}} 年"},xYears:{one:"1 年",other:"{{count}} 年"},overXYears:{one:"超过 1 年",other:"超过 {{count}} 年"},almostXYears:{one:"将近 1 年",other:"将近 {{count}} 年"}},De=(e,t,n)=>{let a;const r=Te[e];return typeof r=="string"?a=r:t===1?a=r.one:a=r.other.replace("{{count}}",String(t)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?a+"内":a+"前":a},Le={full:"y'年'M'月'd'日' EEEE",long:"y'年'M'月'd'日'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},Me={full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},Ne={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},_e={date:N({formats:Le,defaultWidth:"full"}),time:N({formats:Me,defaultWidth:"full"}),dateTime:N({formats:Ne,defaultWidth:"full"})};function X(e,t,n){const a="eeee p";return We(e,t,n)?a:e.getTime()>t.getTime()?"'下个'"+a:"'上个'"+a}const Ae={lastWeek:X,yesterday:"'昨天' p",today:"'今天' p",tomorrow:"'明天' p",nextWeek:X,other:"PP p"},Oe=(e,t,n,a)=>{const r=Ae[e];return typeof r=="function"?r(t,n,a):r},je={narrow:["前","公元"],abbreviated:["前","公元"],wide:["公元前","公元"]},Re={narrow:["1","2","3","4"],abbreviated:["第一季","第二季","第三季","第四季"],wide:["第一季度","第二季度","第三季度","第四季度"]},qe={narrow:["一","二","三","四","五","六","七","八","九","十","十一","十二"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},Fe={narrow:["日","一","二","三","四","五","六"],short:["日","一","二","三","四","五","六"],abbreviated:["周日","周一","周二","周三","周四","周五","周六"],wide:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},$e={narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},ze={narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},Ue=(e,t)=>{const n=Number(e);switch(t==null?void 0:t.unit){case"date":return n.toString()+"日";case"hour":return n.toString()+"时";case"minute":return n.toString()+"分";case"second":return n.toString()+"秒";default:return"第 "+n.toString()}},Ke={ordinalNumber:Ue,era:C({values:je,defaultWidth:"wide"}),quarter:C({values:Re,defaultWidth:"wide",argumentCallback:e=>e-1}),month:C({values:qe,defaultWidth:"wide"}),day:C({values:Fe,defaultWidth:"wide"}),dayPeriod:C({values:$e,defaultWidth:"wide",formattingValues:ze,defaultFormattingWidth:"wide"})},Qe=/^(第\s*)?\d+(日|时|分|秒)?/i,Ve=/\d+/i,Xe={narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},Je={any:[/^(前)/i,/^(公元)/i]},He={narrow:/^[1234]/i,abbreviated:/^第[一二三四]刻/i,wide:/^第[一二三四]刻钟/i},Ye={any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},Ge={narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},Be={narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},Ze={narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^周[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},et={any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},tt={any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨|)/i},rt={any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},at={ordinalNumber:ee({matchPattern:Qe,parsePattern:Ve,valueCallback:e=>parseInt(e,10)}),era:I({matchPatterns:Xe,defaultMatchWidth:"wide",parsePatterns:Je,defaultParseWidth:"any"}),quarter:I({matchPatterns:He,defaultMatchWidth:"wide",parsePatterns:Ye,defaultParseWidth:"any",valueCallback:e=>e+1}),month:I({matchPatterns:Ge,defaultMatchWidth:"wide",parsePatterns:Be,defaultParseWidth:"any"}),day:I({matchPatterns:Ze,defaultMatchWidth:"wide",parsePatterns:et,defaultParseWidth:"any"}),dayPeriod:I({matchPatterns:tt,defaultMatchWidth:"any",parsePatterns:rt,defaultParseWidth:"any"})},nt={code:"zh-CN",formatDistance:De,formatLong:_e,formatRelative:Oe,localize:Ke,match:at,options:{weekStartsOn:1,firstWeekContainsDate:4}};var ot=()=>{d.useEffect(()=>{let e=new URLSearchParams(window.location.search).get("ref");e&&localStorage.setItem("referral_code",e)},[])},J="orderly:wallet-info";function st(){let{connectedChain:e,disconnect:t}=R(),[n,a]=fe("orderly_link_device",{}),{account:r}=q(),{isMobile:i}=ge(),c=D(),o=async s=>{localStorage.removeItem(J),await r.disconnect(),await t({label:s})};d.useEffect(()=>{let s=j(),u=JSON.parse(localStorage.getItem(J)??"{}");s&&u&&o(u.label)},[]);let l=async()=>{let s=j();if(!s)return;let{address:u,secretKey:m,chainId:h,chainNamespace:w}=s;if(!await r.importOrderlyKey({address:u,secretKey:m,chainNamespace:w}))return;a({chainId:h,chainNamespace:w});let S=new URL(window.location.href);S.searchParams.delete("link");let M=decodeURIComponent(S.toString());history.replaceState(null,"",M)};d.useEffect(()=>{i&&!e&&l()},[r,e,i]);let p=async()=>{let{chainId:s,chainNamespace:u}=it()||{};if(i&&!e&&s&&u){let m=r.keyStore.getAddress(),h=r.keyStore.getOrderlyKey(),w=r.keyStore.getAccountId(m);await r.checkOrderlyKey(m,h,w)&&c.set("chainNamespace",u)}};return d.useEffect(()=>{p()},[r,i,e]),{linkDevice:l}}function it(){try{let e=localStorage.getItem("orderly_link_device");return e?xe(e):null}catch{}}function j(){let e=new URL(window.location.href).searchParams.get("link");if(!e)return;let{a:t,k:n,i:a,n:r}=ct(e)||{};if(t&&n&&a&&r)return{address:t,secretKey:n,chainId:a,chainNamespace:r}}function ct(e){try{let t=JSON.parse(window.atob(e)),n=Math.floor(Date.now()/1e3),a=t.t;return!a||n>a?void 0:t}catch{}}var H="orderly:wallet-info",dt=e=>{let{wallet:t,connect:n,connectedChain:a,disconnect:r,namespace:i}=R();if(typeof n!="function")throw new pe("Please provide a wallet connector provider");L();let c=d.useRef(!1);D("brokerId");let{account:o,state:l}=q(),p=ye(),s=D("networkId"),[u,{checkChainSupport:m}]=G(),[h,w]=d.useState(!1),{track:S,setTrackUserId:M}=Y(),W=d.useMemo(()=>{var f,g;return(g=(f=t==null?void 0:t.accounts)==null?void 0:f[0])==null?void 0:g.address},[t]),b=d.useMemo(()=>{var E,T,F,$;let f=(T=(E=t==null?void 0:t.chains)==null?void 0:E[0])==null?void 0:T.id,g=($=(F=t==null?void 0:t.chains)==null?void 0:F[0])==null?void 0:$.namespace;if(!(typeof f>"u"))return{id:be(f),namespace:g}},[t]);return d.useEffect(()=>{l.status>=_.EnableTrading&&o.accountId&&M(o.accountId)},[o,l]),d.useEffect(()=>{if(!a){w(!1);return}let f=m(a.id,s);w(!f)},[a,u,m,s]),d.useEffect(()=>{K(()=>{let f=p.getAddress(),g=JSON.parse(localStorage.getItem(H)??"{}");(a==null?void 0:a.namespace)!==we.solana&&f&&o.address!==f&&g.label&&n({autoSelect:{label:g.label,disableModals:!0}}).then(E=>{},E=>{})})},[t,o.address]),d.useEffect(()=>{if(t===null&&l.status>_.NotConnected&&!l.validating){o.disconnect();return}if(h||!a||c.current)return;let f=j();W&&W!==o.address&&!f&&(o.setAddress(W,{provider:t==null?void 0:t.provider,chain:{id:A(b.id),namespace:b.namespace.toUpperCase()},wallet:{name:(t==null?void 0:t.label)??""}}),S(Q.walletConnect,{wallet:(t==null?void 0:t.label)??"",network:b.namespace.toUpperCase()}),K(()=>{localStorage.setItem(H,JSON.stringify({label:(t==null?void 0:t.label)??""}))})),(b==null?void 0:b.id)!==o.chainId&&o.switchChainId(b==null?void 0:b.id)},[t,a,W,b,o.address,l,o.chainId,h]),{connectWallet:async()=>(c.current=!0,n({chainId:e.currentChainId}).then(async f=>{if(Array.isArray(f)&&f.length>0&&f[0]&&f[0].accounts.length>0){let g=f[0],E=A(g.chains[0].id);if(!m(E,s))return{wrongNetwork:!0};if(!o)throw new Error("account is not initialized");l.status===_.EnableTradingWithoutConnected&&(localStorage.removeItem("orderly_link_device"),await o.disconnect());let T=await o.setAddress(g.accounts[0].address,{provider:g.provider,chain:{id:A(g.chains[0].id),namespace:g.chains[0].namespace.toUpperCase()},wallet:{name:g.label}});return S(Q.walletConnect,{wallet:g.label,network:g.chains[0].namespace.toUpperCase()}),{wallet:g,status:T,wrongNetwork:!1}}return null}).finally(()=>{c.current=!1})),wrongNetwork:h}};function lt(){let{t:e}=x(),t=L(),n=d.useRef({}),[a,r]=ve("orderly_wallet_change_id",{});n.current=a,Pe({onMessage:i=>{let{id:c,side:o,transStatus:l}=i,p=!0;if(["DEPOSIT","WITHDRAW"].includes(o)&&["COMPLETED","FAILED"].includes(l)){let s=n.current[c];r({...a,[c]:s?void 0:!0}),p=!s}if(l==="COMPLETED"&&p){let s=`${O(o)} completed`;o==="DEPOSIT"?s=e("transfer.deposit.completed"):o==="WITHDRAW"&&(s=e("transfer.withdraw.completed")),P.success(s)}else if(l==="FAILED"&&p){let s=`${O(o)} failed`;o==="DEPOSIT"?s=e("transfer.deposit.failed"):o==="WITHDRAW"&&(s=e("transfer.withdraw.failed")),P.error(s)}t.emit("wallet:changed",i)}})}function ut(){let{t:e}=x();Ee({onMessage:t=>{let{status:n}=t;switch(n){case"COMPLETED":P.success(e("settle.settlement.completed"));break;case"FAILED":P.error(e("settle.settlement.failed"));break}}})}function mt(){let{t:e}=x(),t=L(),{setLedgerAddress:n}=ke();return d.useEffect(()=>{t.on("wallet:connect-error",a=>{P.error(a.message)}),t.on("wallet:sign-message-with-ledger-error",a=>{window.setTimeout(()=>{Se.confirm({title:e("connector.ledger.signMessageFailed"),content:e("connector.ledger.signMessageFailed.description"),size:"sm",onOk:async()=>(n(a.userAddress),Promise.resolve()),okLabel:e("common.ok"),onCancel:async()=>(P.error(a.message),Promise.resolve()),cancelLabel:e("common.no")}).then(r=>{})})})},[t,e]),{}}function ht(e){let{storageChain:t,setStorageChain:n}=he(),[a,r]=d.useState(),[i]=G(),c=D("networkId"),{connectedChain:o}=R();return d.useEffect(()=>{var l,p,s;if(o)r==null||r(typeof o.id=="number"?o.id:parseInt(o.id));else{if(a)return;let u,m=c==="mainnet"?(l=i.mainnet)==null?void 0:l[0]:(p=i.testnet)==null?void 0:p[0];typeof e=="function"?u=e(c,i):typeof e=="object"&&(u=c==="mainnet"?e==null?void 0:e.mainnet:e==null?void 0:e.testnet);let h=(u==null?void 0:u.id)||((s=m==null?void 0:m.network_infos)==null?void 0:s.chain_id);if(!h)return;t?r==null||r(t.chainId):(n(h),r==null||r(h))}},[o,i,a,c,r,e]),[a,r]}var B=d.createContext({}),ft=()=>d.useContext(B),gt=e=>{let[t,n]=d.useState(!1),[a,r]=ht(e.defaultChain);st(),ue();let{connectWallet:i,wrongNetwork:c}=dt({currentChainId:a});lt(),ut(),mt();let o=me(e.restrictedInfo),l=o.restrictedOpen;return y.jsx(B.Provider,{value:{connectWallet:i,wrongNetwork:c,currentChainId:a,setCurrentChainId:r,onChainChanged:e.onChainChanged,disabledConnect:l,restrictedInfo:o,showAnnouncement:t,setShowAnnouncement:n},children:e.children})},Z=d.createContext({}),St=()=>d.useContext(Z),pt=e=>y.jsx(Z.Provider,{value:e,children:e.children});function yt(e){return e==="BUY"?v.t("common.buy"):e==="SELL"?v.t("common.sell"):O(e)}function bt(e,t){let{symbol:n,side:a,quantity:r}=e,i="total_executed_quantity"in e?e.total_executed_quantity:0,c="status"in e?e.status:e.algo_status,o=t[n],l=o("base_dp"),p=yt(a),s=Ce(n),u="algo_type"in e&&e.algo_type===Ie.POSITIONAL_TP_SL?v.t("tpsl.entirePosition"):l===void 0?r:V(r,{dp:l}),m="",h="";switch(c){case k.NEW:m=v.t("orders.status.opened.toast.title"),h=`${p} ${s} ${u}`;break;case k.FILLED:case k.PARTIAL_FILLED:let w=l===void 0?i:V(i,{dp:l});m=v.t("orders.status.filled.toast.title"),h=`${p} ${s} ${w} / ${u}`;break;case k.CANCELLED:m=v.t("orders.status.canceled.toast.title"),h=`${p} ${s} ${u}`;break;case k.REJECTED:m=v.t("orders.status.rejected.toast.title"),h=`${p} ${s} ${u}`;break;case k.REPLACED:m=v.t("orders.status.replaced.toast.title"),h=`${a} ${s} ${i} / ${u}`;break}return{title:m,msg:h}}function wt(){let e=L(),t=ie(),n=d.useRef({});d.useEffect(()=>{n.current=t},[t]);let a=ce(r=>{(i=>{let{title:c,msg:o}=bt(i,n.current);c&&o&&P.success(y.jsxs("div",{children:[c,y.jsx("br",{}),y.jsx("div",{className:"orderly-text-white/[0.54] orderly-text-xs",children:o})]}))})(r)},100);d.useEffect(()=>(e.on("orders:changed",a),()=>{e.off("orders:changed",a)}),[])}function vt(){let{t:e}=x(),t=de();return d.useMemo(()=>{let n={[U.en]:le,[U.zh]:nt};return{locale:t,dialog:{ok:e("common.ok"),cancel:e("common.cancel")},modal:{confirm:e("common.confirm"),cancel:e("common.cancel")},pagination:{morePages:e("ui.pagination.morePages"),rowsPerPage:e("ui.pagination.rowsPerPage")},picker:{selectDate:e("ui.picker.selectDate"),dayPicker:n[t]},empty:{description:e("ui.empty.description")}}},[e,t])}var Pt=e=>{let{components:t,appIcons:n,onChainChanged:a,defaultChain:r,...i}=e;Y(),ot(),wt();let c=vt();return y.jsx(pt,{appIcons:n,brokerName:e.brokerName,children:y.jsx(te,{components:t,overrides:e.overrides,children:y.jsxs(re,{...i,children:[y.jsx(gt,{onChainChanged:a,defaultChain:r,restrictedInfo:e.restrictedInfo,children:y.jsx(ae,{locale:c,children:y.jsx(ne,{delayDuration:300,children:y.jsx(oe,{children:e.children})})})}),y.jsx(se,{})]})})})};Pt.displayName="OrderlyAppProvider";var Ct=(e,t)=>{let{wrongNetwork:n,disabledConnect:a}=ft(),{state:r}=q();return t!=null&&t.skip?e:n||a||typeof(t==null?void 0:t.accountStatus)<"u"&&r.status<t.accountStatus?typeof(t==null?void 0:t.fallbackData)<"u"?t.fallbackData:null:e};function It(e){let{t}=x(),n=(a,r,i)=>{var c;return(c={quantity:{required:t("orderEntry.orderQuantity.error.required"),min:t("orderEntry.orderQuantity.error.min",{value:r}),max:t("orderEntry.orderQuantity.error.max",{value:r})},order_quantity:{required:t("orderEntry.orderQuantity.error.required"),min:t("orderEntry.orderQuantity.error.min",{value:r}),max:t("orderEntry.orderQuantity.error.max",{value:r})},order_price:{required:t("orderEntry.orderPrice.error.required"),min:t("orderEntry.orderPrice.error.min",{value:r}),max:t("orderEntry.orderPrice.error.max",{value:r})},trigger_price:{required:t("orderEntry.triggerPrice.error.required"),min:t("orderEntry.triggerPrice.error.min",{value:r}),max:t("orderEntry.triggerPrice.error.max",{value:r})},tp_trigger_price:{min:t("orderEntry.tpTriggerPrice.error.min",{value:r}),max:t("orderEntry.tpTriggerPrice.error.max",{value:r})},sl_trigger_price:{min:t("orderEntry.slTriggerPrice.error.min",{value:r}),max:t("orderEntry.slTriggerPrice.error.max",{value:r})},total:{min:t("orderEntry.total.error.min",{value:r})}}[a])==null?void 0:c[i]};return{parseErrorMsg:a=>{let{type:r,value:i}=(e==null?void 0:e[a])||{};return r?n(a,i,r):""}}}export{ft as L,It as T,St as r,Pt as s,Ct as x};
