import{b3 as Ht,l as B,bI as N,bq as H,cq as Cs,a4 as ue,a5 as F,aO as gt,ah as xt,by as js,aP as Vt,n as w,a7 as st,z as m,M as b,v as J,bH as Pt,E as ee,cr as ws,Q as x,bw as _s,k as te,ai as bt,W as M,cs as q,ct as Ae,cu as Tt,b7 as qt,ak as me,S as ye,b6 as Ss,bd as et,ab as W,bf as Ns,aV as ks,bo as Ps,aX as Ts,bv as Os,g as L,F as Ft,br as fe,bA as jt,bB as Ls,bC as wi,a2 as Ms,o as pe,i as Ot,cd as Is,X as ft,h as He,bJ as _i,a8 as Pe,a9 as yt,aD as Es,aN as rt,bS as Ce,bR as se,w as Ve,y as qe,A as ot,B as Fe,bN as $e,cv as Ds,cw as ei,cx as Rs,c1 as As,aM as vt,b8 as zs,aY as Ut,aZ as Wt,aS as $s,x as at,j as nt,$ as Q,D as Bs,cy as Hs,bc as Vs,co as ti,cl as qs,cz as tt,cA as Si,bP as Fs,cc as Us,bO as Be,cB as Ws,cC as Ni,bn as ut,aL as Qs,f as Ks,cD as Ys,cE as Zs,Z as ki,ag as Pi,cF as Ti,bk as Oi,cG as Xs,am as Li,bE as Gs,m as Js,bU as er,aQ as tr,cH as ir,cI as Mi,au as sr,cJ as rr,cK as or,cL as ar,cM as nr,cn as ii,a$ as lr,ad as ur,cN as dr,bx as cr,Y as hr,bm as mr,cO as pr,cP as si,cQ as gr,cR as Ii}from"./index-Dc4zQRHI.js";import{o as xr,X as Lt,P as re,t as br,h as dt,L as fr,j as yr,H as vr,r as Cr,K as jr,M as wr,q as _r,G as Sr}from"./index-BfK5BwTR.js";import{W as he,j as i,r as u}from"./index-_b-vxSi4.js";import{L as lt,a as Ei,T as le}from"./index-Ciwy8fWJ.js";import{a as Di}from"./index-_HYtGIRS.js";import{X as Nr,W as kr,m as Pr,n as Tr}from"./index-Bs5_x_EQ.js";import{T as Mt}from"./Trans-DEQOX5TC.js";function Or(e){const t=Ht(e);return t.setSeconds(0,0),t}function Lr(e){const t=Ht(e);return t.setMinutes(0,0,0),t}function Mr(e){const t=Ht(e);return t.setMilliseconds(0),t}function ke(){return ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)({}).hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},ke.apply(null,arguments)}function Ir(e,t){if(e==null)return{};var s={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;s[r]=e[r]}return s}var Er=["prefixCls","className","children","mode","visiable","visible","renderBar","lineBar","disable","onDragEnd","onDragging"];class Ri extends he.Component{constructor(t){super(t),this.state={dragging:!1},this.warpper=void 0,this.paneNumber=void 0,this.startX=void 0,this.startY=void 0,this.move=void 0,this.target=void 0,this.boxWidth=void 0,this.boxHeight=void 0,this.preWidth=void 0,this.nextWidth=void 0,this.preHeight=void 0,this.nextHeight=void 0,this.preSize=void 0,this.nextSize=void 0,this.onDragEnd=this.onDragEnd.bind(this),this.onDragging=this.onDragging.bind(this)}componentWillUnmount(){this.removeEvent()}removeEvent(){window.removeEventListener("mousemove",this.onDragging,!1),window.removeEventListener("mouseup",this.onDragEnd,!1)}onMouseDown(t,s){if(!(!s.target||!this.warpper)){this.paneNumber=t,this.startX=s.clientX,this.startY=s.clientY,this.move=!0,this.target=s.target.parentNode;var r=this.target.previousElementSibling,o=this.target.nextElementSibling;this.boxWidth=this.warpper.clientWidth,this.boxHeight=this.warpper.clientHeight,r&&(this.preWidth=r.clientWidth,this.preHeight=r.clientHeight),o&&(this.nextWidth=o.clientWidth,this.nextHeight=o.clientHeight),window.addEventListener("mousemove",this.onDragging),window.addEventListener("mouseup",this.onDragEnd,!1),this.setState({dragging:!0})}}onDragging(t){if(this.move){this.state.dragging||this.setState({dragging:!0});var{mode:s,onDragging:r}=this.props,o=this.target.nextElementSibling,a=this.target.previousElementSibling,n=t.clientX-this.startX,l=t.clientY-this.startY;if(this.preSize=0,this.nextSize=0,s==="horizontal"){if(this.preSize=this.preWidth+n>-1?this.preWidth+n:0,this.nextSize=this.nextWidth-n>-1?this.nextWidth-n:0,this.preSize===0||this.nextSize===0)return;this.preSize=(this.preSize/this.boxWidth>=1?1:this.preSize/this.boxWidth)*100,this.nextSize=(this.nextSize/this.boxWidth>=1?1:this.nextSize/this.boxWidth)*100,a&&o&&(a.style.width=this.preSize+"%",o.style.width=this.nextSize+"%")}if(s==="vertical"&&this.preHeight+l>-1&&this.nextHeight-l>-1){if(this.preSize=this.preHeight+l>-1?this.preHeight+l:0,this.nextSize=this.nextHeight-l>-1?this.nextHeight-l:0,this.preSize=(this.preSize/this.boxHeight>=1?1:this.preSize/this.boxHeight)*100,this.nextSize=(this.nextSize/this.boxHeight>=1?1:this.nextSize/this.boxHeight)*100,this.preSize===0||this.nextSize===0)return;a&&o&&(a.style.height=this.preSize+"%",o.style.height=this.nextSize+"%")}r&&r(this.preSize,this.nextSize,this.paneNumber)}}onDragEnd(){var{onDragEnd:t}=this.props;this.move=!1,t&&t(this.preSize,this.nextSize,this.paneNumber),this.removeEvent(),this.setState({dragging:!1})}render(){var t,s=this.props,{prefixCls:r,className:o,children:a,mode:n,visible:l=(t=this.props.visible)!=null?t:this.props.visiable,renderBar:d,lineBar:c,disable:h}=s,p=Ir(s,Er),{dragging:g}=this.state,y=[r,o,r+"-"+n,g?"dragging":null].filter(Boolean).join(" ").trim(),f=he.Children.toArray(a);return i.jsx("div",ke({className:y},p,{ref:C=>this.warpper=C,children:he.Children.map(f,(C,j)=>{var _=Object.assign({},C.props,{className:[r+"-pane",C.props.className].filter(Boolean).join(" ").trim(),style:ke({},C.props.style)}),P=l===!0||l&&l.includes(j+1)||!1,k={className:[r+"-bar",c?r+"-line-bar":null,c?null:r+"-large-bar"].filter(Boolean).join(" ").trim()};(h===!0||h&&h.includes(j+1))&&(k.className=[k.className,h?"disable":null].filter(Boolean).join(" ").trim());var v=null;return j!==0&&P&&d?v=d(ke({},k,{onMouseDown:this.onMouseDown.bind(this,j+1)})):j!==0&&P&&(v=he.createElement("div",ke({},k),i.jsx("div",{onMouseDown:this.onMouseDown.bind(this,j+1)}))),i.jsxs(he.Fragment,{children:[v,he.cloneElement(C,ke({},_))]},j)})}))}}Ri.defaultProps={prefixCls:"w-split",visiable:!0,mode:"horizontal"};var Dr=e=>{let{pinned:t,orderTypeExtra:s}=e,{t:r}=w(),o=a=>n=>{e.onValueChange&&e.onValueChange("order_type_ext",n?a:"")};return u.useEffect(()=>{var a;(a=e.onValueChange)==null||a.call(e,"visible_quantity",e.hidden?0:1)},[e.hidden]),i.jsxs("div",{className:"oui-text-base-contrast-54",children:[i.jsxs(m,{justify:t?"start":"between",mb:3,width:t?"unset":"100%",className:"oui-gap-x-2 md:oui-gap-x-3",wrap:"wrap",gapY:1,children:[i.jsxs(m,{itemAlign:"center",children:[i.jsx(fe,{"data-testid":"oui-testid-orderEntry-postOnly-checkBox",id:"toggle_order_post_only",className:"oui-peer",color:"white",variant:"radio",disabled:!e.showExtra,checked:s===N.POST_ONLY,onCheckedChange:o(N.POST_ONLY)}),i.jsx("label",{htmlFor:"toggle_order_post_only",className:b("oui-text-2xs oui-ml-1 peer-data-[disabled]:oui-text-base-contrast-20","oui-break-normal oui-whitespace-nowrap"),children:r("orderEntry.orderType.postOnly")})]}),i.jsxs(m,{itemAlign:"center",children:[i.jsx(fe,{"data-testid":"oui-testid-orderEntry-ioc-checkBox",id:"toggle_order_iov",color:"white",className:"oui-peer",variant:"radio",checked:s===N.IOC,onCheckedChange:o(N.IOC),disabled:!e.showExtra}),i.jsx("label",{htmlFor:"toggle_order_iov",className:b("oui-text-2xs oui-ml-1 peer-data-[disabled]:oui-text-base-contrast-20","oui-break-normal oui-whitespace-nowrap"),children:r("orderEntry.orderType.ioc")})]}),i.jsxs(m,{itemAlign:"center",children:[i.jsx(fe,{"data-testid":"oui-testid-orderEntry-fox-checkBox",id:"toggle_order_fok",color:"white",variant:"radio",className:"oui-peer",checked:s===N.FOK,onCheckedChange:o(N.FOK),disabled:!e.showExtra}),i.jsx("label",{htmlFor:"toggle_order_fok",className:b("oui-text-2xs oui-ml-1 peer-data-[disabled]:oui-text-base-contrast-20","oui-break-normal oui-whitespace-nowrap"),children:r("orderEntry.orderType.fok")})]})]}),i.jsxs(m,{gapX:6,children:[i.jsxs(m,{children:[i.jsx(fe,{"data-testid":"oui-testid-orderEntry-orderConfirm-checkBox",id:"toggle_order_confirm",color:"white",checked:e.needConfirm,onCheckedChange:a=>{e.setNeedConfirm(!!a)}}),i.jsx("label",{htmlFor:"toggle_order_confirm",className:"oui-text-2xs oui-ml-1",children:r("orderEntry.orderConfirm")})]}),i.jsxs(m,{children:[i.jsx(fe,{"data-testid":"oui-testid-orderEntry-hidden-checkBox",id:"toggle_order_hidden",color:"white",checked:e.hidden,onCheckedChange:a=>{e.setHidden(a)}}),i.jsx("label",{htmlFor:"toggle_order_hidden",className:"oui-text-2xs oui-ml-1",children:r("orderEntry.hidden")})]})]}),!t&&i.jsxs(i.Fragment,{children:[i.jsx(te,{className:"oui-my-3"}),i.jsxs(m,{children:[i.jsx(bt,{"data-testid":"oui-testid-orderEntry-additional-keepVisible-switch",id:"toggle_order_keep_visible",onCheckedChange:a=>{e.setPinned(a)}}),i.jsx("label",{htmlFor:"toggle_order_keep_visible",className:"oui-text-2xs oui-ml-1",children:r("orderEntry.keepVisible")})]})]})]})},Rr=()=>({}),Ai=e=>{let t=Rr();return i.jsx(Dr,{...t,...e})};function It(e){let{order_type:t,order_type_ext:s}=e,r=[N.ASK,N.BID].includes(s);return t?t===N.LIMIT&&r:r}function Ar(e,t){if([q.COUNTERPARTY1,q.COUNTERPARTY5].includes(e))return t===H.BUY?N.ASK:N.BID;if([q.QUEUE1,q.QUEUE5].includes(e))return t===H.BUY?N.BID:N.ASK}function zr(e){if([q.COUNTERPARTY1,q.QUEUE1].includes(e))return Ae.ONE;if([q.COUNTERPARTY5,q.QUEUE5].includes(e))return Ae.FIVE}function $r(e){let{type:t,side:s,level:r}=e;if(t===N.ASK){if(r===Ae.ONE)return s===H.BUY?q.COUNTERPARTY1:q.QUEUE1;if(r===Ae.FIVE)return s===H.BUY?q.COUNTERPARTY5:q.QUEUE5}if(t===N.BID){if(r===Ae.ONE)return s===H.BUY?q.QUEUE1:q.COUNTERPARTY1;if(r===Ae.FIVE)return s===H.BUY?q.QUEUE5:q.COUNTERPARTY5}}var zi=e=>{let{baseDP:t,quoteDP:s,order:r,onConfirm:o,onCancel:a}=e,{side:n,order_type:l,order_type_ext:d,level:c}=r,{t:h}=w(),[p,g]=B("orderly_order_confirm",!0),y=()=>{if(l===N.MARKET||l===N.STOP_MARKET)return i.jsx(x,{intensity:80,children:h("common.marketPrice")});if(It({order_type:l,order_type_ext:d})){let f=$r({type:d,side:n,level:c}),C={[q.COUNTERPARTY1]:h("orderEntry.bbo.counterparty1"),[q.COUNTERPARTY5]:h("orderEntry.bbo.counterparty5"),[q.QUEUE1]:h("orderEntry.bbo.queue1"),[q.QUEUE5]:h("orderEntry.bbo.queue5")}[f];return i.jsx(x,{intensity:80,children:C})}return i.jsx(x.numeral,{unit:"USDC",rule:"price",className:"oui-text-base-contrast",unitClassName:"oui-text-base-contrast-36 oui-ml-1",dp:s,padding:!1,children:r.order_price})};return i.jsxs(i.Fragment,{children:[i.jsxs(m,{justify:"between",children:[i.jsx(x.formatted,{rule:"symbol",showIcon:!0,children:r.symbol}),i.jsxs(m,{justify:"end",gapX:1,children:[i.jsx(Br,{type:l}),n===H.BUY?i.jsx(Ot,{color:"buy",size:"sm",children:h("common.buy")}):i.jsx(Ot,{color:"sell",size:"sm",children:h("common.sell")})]})]}),i.jsx(te,{className:"oui-my-4"}),i.jsxs("div",{className:et({size:"sm",intensity:54,className:"oui-space-y-1"}),children:[i.jsxs(m,{justify:"between",children:[i.jsx(x,{children:h("common.qty")}),i.jsx(x.numeral,{rule:"price",dp:t,padding:!1,className:"oui-text-base-contrast",children:r.order_quantity})]}),r.trigger_price?i.jsxs(m,{justify:"between",children:[i.jsx(x,{children:h("common.trigger")}),i.jsx(x.numeral,{unit:"USDC",rule:"price",className:"oui-text-base-contrast",unitClassName:"oui-text-base-contrast-36 oui-ml-1",dp:s,padding:!1,children:r.trigger_price})]}):null,i.jsxs(m,{justify:"between",children:[i.jsx(x,{children:h("common.price")}),y()]}),i.jsxs(m,{justify:"between",children:[i.jsx(x,{children:h("common.notional")}),i.jsx(x.numeral,{unit:"USDC",rule:"price",dp:s,padding:!1,className:"oui-text-base-contrast",unitClassName:"oui-text-base-contrast-36 oui-ml-1",children:r.total})]})]}),r.tp_trigger_price||r.sl_trigger_price?i.jsxs(i.Fragment,{children:[i.jsx(te,{className:"oui-my-4"}),i.jsxs("div",{className:et({size:"sm",intensity:54,className:"oui-space-y-1"}),children:[r.tp_trigger_price&&i.jsxs(m,{justify:"between",children:[i.jsx(x,{children:h("orderEntry.tpMarkPrice")}),i.jsx(x.numeral,{unit:"USDC",rule:"price",coloring:!0,dp:s,padding:!1,unitClassName:"oui-text-base-contrast-36 oui-ml-1",children:r.tp_trigger_price})]}),r.sl_trigger_price&&i.jsxs(m,{justify:"between",children:[i.jsx(x,{children:h("orderEntry.slMarkPrice")}),i.jsx(x.numeral,{unit:"USDC",rule:"price",coloring:!0,className:"oui-text-trade-loss",unitClassName:"oui-text-base-contrast-36 oui-ml-1",dp:s,padding:!1,children:r.sl_trigger_price})]})]})]}):null,i.jsxs(m,{gapX:1,pt:4,pb:5,children:[i.jsx(fe,{id:"orderConfirm",color:"white",onCheckedChange:f=>{g(!f)}}),i.jsx("label",{htmlFor:"orderConfirm",className:et({size:"xs",intensity:54}),children:h("orderEntry.disableOrderConfirm")})]}),r.tp_trigger_price||r.sl_trigger_price?i.jsx(M,{py:3,px:3,className:"oui-text-center",children:i.jsx(x,{color:"warning",size:"xs",children:h("orderEntry.tpsl.trigger.description")})}):null,i.jsxs(ye,{cols:2,gapX:3,children:[i.jsx(J,{color:"secondary",size:"md",onClick:()=>a(),children:h("common.cancel")}),i.jsx(J,{size:"md",onClick:()=>o(),children:h("common.confirm")})]})]})};zi.displayName="OrderConfirmDialog";var Br=e=>{let{t}=w(),s=u.useMemo(()=>{switch(e.type){case N.LIMIT:return t("orderEntry.orderType.limit");case N.MARKET:return t("common.marketPrice");case N.STOP_LIMIT:return t("orderEntry.orderType.stopLimit");case N.STOP_MARKET:return t("orderEntry.orderType.stopMarket");default:return""}},[e.type]);return i.jsx(Ot,{color:"neutral",size:"sm",children:s})},Hr=e=>{let{close:t,resolve:s,reject:r,...o}=e;return i.jsx(zi,{...o,onCancel:t,onConfirm:()=>{s(),t()}})},$i="orderConfirm";Ms($i,Hr,{size:"sm",title:()=>pe.t("orderEntry.orderConfirm")});var Qt=u.createContext({}),Vr=Qt.Provider,Bi=u.createContext({}),Hi=()=>u.useContext(Bi),ri=e=>{let{type:t,values:s}=e,[r,o]=B("TP/SL_Mode","Offset%"),{t:a}=w(),n=u.useMemo(()=>!s.PnL||!e.values.trigger_price?null:i.jsxs(m,{children:[i.jsx("span",{className:"oui-text-xs oui-text-base-contrast-54",children:a(r==="PnL"?"orderEntry.estRoi":"orderEntry.estPnL")}),r==="PnL"?i.jsx(x.numeral,{rule:"percentages",className:b("oui-text-xs oui-ml-1",t==="TP"?"oui-text-trade-profit":"oui-text-trade-loss"),children:s.ROI}):i.jsx(x.numeral,{rule:"price",className:b("oui-text-xs oui-ml-1",t==="TP"?"oui-text-trade-profit":"oui-text-trade-loss"),children:s.PnL})]}),[r,e.values.PnL,e.values.trigger_price]);return i.jsx(Bi.Provider,{value:{mode:r,setMode:o,tipsEle:n},children:e.children})},qr=e=>{let{type:t,values:s,quote_dp:r}=e,{t:o}=w(),{mode:a,setMode:n,tipsEle:l}=Hi(),[d,c]=u.useState(!1),[h,p]=u.useState(!1),g=u.useMemo(()=>{switch(a){case"Offset":return`${t.toLowerCase()}_offset`;case"Offset%":return`${t.toLowerCase()}_offset_percentage`;default:return`${t.toLowerCase()}_pnl`}},[a]),[y,f]=u.useState(s[a]);u.useEffect(()=>{h||f(s[a])},[s,a,h]);let C=u.useMemo(()=>[{label:o("tpsl.pnl"),value:"PnL",testId:"PnL_menu_item"},{label:o("tpsl.offset"),value:"Offset",testId:"Offset_mneu_item"},{label:`${o("tpsl.offset")}%`,value:"Offset%",testId:"Offset%_menu_item"}],[o]),j=u.useMemo(()=>({PnL:o("tpsl.pnl"),Offset:o("tpsl.offset"),"Offset%":`${o("tpsl.offset")}%`}),[o]),_=u.useRef("");return{mode:a,modes:C,modeLabelMap:j,formatter:P=>{let{dp:k=2}=P;return{onRenderBefore:(v,S)=>(v=`${v}`,t==="SL"&&a==="PnL"&&(v=v.startsWith("-")?v:"-"+v),v===""||v==="-"?"":a==="Offset%"?`${new L(v.replace(new RegExp(_.current.replace(".","\\.")+"$"),"")).mul(100).todp(2,4).toString()}${_.current}`:(a==="Offset"&&(v=jt(v,k)),`${v}`)),onSendBefore:v=>{if(/^\-?0{2,}$/.test(v))return"0";if(a==="Offset%"){if(v!==""){v=jt(v,2);let S=v.match(/\.0{0,2}$/);S?_.current=S[0]:_.current="",v=new L(v).div(100).toString(),v=`${v}${_.current}`}}else v=jt(v,k);return v===""||v==="-"?"":v}}},onModeChange:P=>{n(P)},onFocus:()=>{c(!0),p(!0)},onBlur:()=>{c(!1),p(!1),e.onChange(g,y)},value:y,onValueChange:P=>{f(P),e.onChange(g,P)},quote_dp:r,tips:d?l:void 0}},Fr=e=>{var P,k;let{mode:t,modes:s,modeLabelMap:r,onModeChange:o,onValueChange:a,quote:n,quote_dp:l,value:d,type:c,tips:h,onFocus:p,onBlur:g}=e,[y,f]=u.useState(t),[C,j]=u.useState(t==="Offset%"?"%":n);u.useEffect(()=>{f(t),j(t==="Offset%"?"%":n)},[t]),u.useEffect(()=>{f(d?"":t)},[d]);let _=u.useMemo(()=>`${c.toLowerCase()}_${t.toLowerCase()}`,[]);return i.jsx(Ft.tooltip,{prefix:r[y]||y,size:"md",placeholder:C,id:_,align:"right",value:d,tooltip:h,tooltipProps:{content:{side:e.type==="TP"?"top":"bottom"}},"data-testid":(P=e.testIds)==null?void 0:P.input,autoComplete:"off",onValueChange:a,formatters:[e.formatter({dp:l,mode:t,type:c}),me.currencyFormatter],classNames:{root:c==="TP"?"oui-text-trade-profit":"oui-text-trade-loss",additional:"oui-text-base-contrast-54",input:"oui-text-inherit"},onFocus:()=>{f(""),j(""),p()},onBlur:()=>{f(d?"":t),j(t==="Offset%"?"%":n),g()},suffix:i.jsxs(i.Fragment,{children:[t==="Offset%"&&!!d&&i.jsx(x,{size:"2xs",color:"inherit",className:"oui-ml-[2px]",children:"%"}),i.jsx(Ur,{mode:t,modes:s,onModeChange:v=>o(v.value),testId:(k=e.testIds)==null?void 0:k.dropDown})]})})},Ur=e=>i.jsx(Ls,{currentValue:e.mode,menu:e.modes,align:"end",size:"xs",className:"oui-min-w-[80px]",onCloseAutoFocus:t=>t.preventDefault(),onSelect:t=>e.onModeChange(t),children:i.jsx("button",{className:"oui-p-2","data-testid":e.testId,children:i.jsx(wi,{size:12,color:"white"})})}),Wr=e=>{let{testIds:t,quote:s,...r}=e,o=qr(r);return i.jsx(Fr,{...o,testIds:t,quote:s,type:e.type})},Qr=e=>{let t=he.useRef(null),{t:s}=w();return u.useEffect(()=>{e.orderType!==N.LIMIT&&e.orderType!==N.MARKET&&e.onSwitchChanged(!1)},[e.orderType]),e.orderType!==N.LIMIT&&e.orderType!==N.MARKET||e.isReduceOnly?null:i.jsxs("div",{children:[i.jsxs(m,{itemAlign:"center",gapX:1,children:[i.jsx(bt,{id:"order_entry_tpsl",className:"oui-h-[14px]",checked:e.switchState,disabled:e.orderType!==N.LIMIT&&e.orderType!==N.MARKET||e.isReduceOnly,onCheckedChange:r=>{e.onSwitchChanged(r)}}),i.jsx("label",{htmlFor:"order_entry_tpsl",className:"oui-text-xs",children:s("common.tpsl")}),i.jsx(Ns,{color:"white",size:14,opacity:1,className:"oui-cursor-pointer oui-text-white/[.36] hover:oui-text-white/80",onClick:()=>{ee.dialog({title:s("common.tips"),size:"xs",content:i.jsx(x,{intensity:54,children:s("orderEntry.tpsl.tips")})})}})]}),i.jsx("div",{className:b("oui-max-h-0 oui-overflow-hidden oui-transition-all",e.switchState&&"oui-max-h-[100px]"),onTransitionEnd:()=>{var r;(r=t.current)==null||r.style.setProperty("opacity",e.switchState?"1":"0")},children:i.jsx(Vi,{ref:t,onChange:e.onChange,values:e.values,errors:e.errors,quote_dp:e.quote_dp})})]})},Vi=he.forwardRef((e,t)=>{let{parseErrorMsg:s}=Ei(e.errors);return i.jsxs("div",{ref:t,className:"oui-space-y-1 oui-px-px oui-py-2 oui-transition-all",children:[i.jsx(ri,{values:e.values.tp,type:"TP",children:i.jsx(oi,{type:"TP",error:s("tp_trigger_price"),onChange:e.onChange,values:e.values.tp,quote_dp:e.quote_dp,testIds:{first:"oui-testid-orderEntry-tpsl-tpPrice-input",second:"oui-testid-orderEntry-tpsl-tpPnl-input",dropDown:"oui-testid-orderEntry-tpsl-tp-dropDown-trigger-button"}})}),i.jsx(ri,{values:e.values.sl,type:"SL",children:i.jsx(oi,{type:"SL",error:s("sl_trigger_price"),onChange:e.onChange,values:e.values.sl,quote_dp:e.quote_dp,testIds:{first:"oui-testid-orderEntry-tpsl-slPrice-input",second:"oui-testid-orderEntry-tpsl-slPnl-input",dropDown:"oui-testid-orderEntry-tpsl-sl-dropDown-trigger-button"}})})]})});Vi.displayName="TPSLInputForm";var Kr=e=>{let{t}=w(),{errorMsgVisible:s}=u.useContext(Qt),{tipsEle:r}=Hi(),[o,a]=u.useState(`${e.type} Price`),[n,l]=u.useState("USDC"),[d,c]=u.useState(!1),[h,p]=u.useState(!1),[g,y]=u.useState(e.values.trigger_price??"");u.useEffect(()=>{h||y(e.values.trigger_price??"")},[e.values.trigger_price,h]);let f=u.useMemo(()=>e.error&&s?e.error:d?r:null,[e.error,s,d,r]),C=k=>{let v=e.type==="TP"?t("tpsl.tpPrice"):t("tpsl.slPrice");return k&&(v=e.type==="TP"?t("tpsl.tp"):t("tpsl.sl")),v},j=k=>{y(k),e.onChange(k)};u.useEffect(()=>{a(C(e.values.trigger_price)),h||y(e.values.trigger_price??"")},[e.type,e.values.trigger_price]);let _=()=>{a(e.type==="TP"?t("tpsl.tp"):t("tpsl.sl")),l(""),c(!0),p(!0)},P=()=>{a(C(e.values.trigger_price)),l("USDC"),c(!1),p(!1),e.onChange(g)};return i.jsx(Ft.tooltip,{"data-testid":e.testId,prefix:o,size:"md",placeholder:n,align:"right",onFocus:_,onBlur:P,tooltip:f,tooltipProps:{content:{side:e.type==="TP"?"top":"bottom"}},color:e.error?"danger":void 0,autoComplete:"off",value:g,classNames:{additional:"oui-text-base-contrast-54",root:"oui-pr-2 md:oui-pr-3",prefix:"oui-pr-1 md:oui-pr-2"},onValueChange:j,formatters:[me.numberFormatter,me.dpFormatter(e.quote_dp??2),me.currencyFormatter]})},oi=e=>{var s,r,o;let t=e.type==="SL"?"sl_trigger_price":"tp_trigger_price";return i.jsxs(ye,{cols:2,gapX:1,children:[i.jsx(Kr,{testId:(s=e.testIds)==null?void 0:s.first,type:e.type,error:e.error,values:e.values??"",onChange:a=>{e.onChange(t,a)},quote_dp:e.quote_dp}),i.jsx(Wr,{testIds:{input:(r=e.testIds)==null?void 0:r.second,dropDown:(o=e.testIds)==null?void 0:o.dropDown},onChange:e.onChange,quote:"USDC",quote_dp:e.quote_dp,type:e.type,values:{PnL:e.values.PnL,Offset:e.values.Offset,"Offset%":e.values["Offset%"],ROI:e.values.ROI}})]})},Yr=e=>{let{side:t,formattedOrder:s,setOrderValue:r,symbolInfo:o,maxQty:a,freeCollateral:n,helper:l,submit:d,metaState:c,bboStatus:h,bboType:p,onBBOChange:g,toggleBBO:y}=e,{curLeverage:f}=Vt(),{t:C}=w(),{isMobile:j}=st(),{errors:_,validated:P}=c,[k,v]=u.useState(!1),[S,T]=B("orderly_order_confirm",!0),[I,z]=B("orderly-order-additional-pinned",!0),[Z,K]=B("orderly-order-hidden",!1),R=u.useMemo(()=>t===H.BUY?C("orderEntry.buyLong"):C("orderEntry.sellShort"),[t,C]);u.useEffect(()=>{P&&v(!0)},[P]),u.useEffect(()=>{let E=G=>{G.target.closest("#order-entry-submit-button")||v(ae=>ae&&!1)};return k?document.addEventListener("click",E):document.removeEventListener("click",E),()=>{document.removeEventListener("click",E)}},[k]);let $=()=>{l.validate().then(()=>S?ee.show($i,{order:s,quote:o.quote,base:o.base,quoteDP:o.quote_dp,baseDP:o.base_dp}):!0,E=>{if(v(!0),typeof E=="object"&&(E.total!=null||E.order_quantity!=null||E.order_price!=null||E.trigger_price!=null))return Promise.reject()}).then(()=>d({resetOnSuccess:!1}).then(E=>{E.success||W.error(E.message)})).catch(E=>{E!=="cancel"&&typeof E=="object"&&E.message&&W.error(E.message)})},U=j&&e.canTrade;return i.jsx(Vr,{value:{errorMsgVisible:k},children:i.jsxs("div",{className:"oui-space-y-2 oui-text-base-contrast-54 xl:oui-space-y-3",ref:e.containerRef,children:[i.jsxs(m,{gapX:2,className:"oui-flex-col oui-gap-y-3 lg:oui-flex-row",children:[i.jsxs("div",{className:b("oui-grid oui-w-full oui-flex-1 oui-gap-x-2 lg:oui-flex lg:oui-gap-x-[6px]",U?"oui-grid-cols-3":"oui-grid-cols-2"),children:[i.jsx(J,{onClick:()=>{e.setOrderValue("side",H.BUY)},size:"md",fullWidth:!0,"data-type":H.BUY,className:b(t===H.BUY&&e.canTrade?"oui-bg-success-darken hover:oui-bg-success-darken/80 active:oui-bg-success-darken/80":"oui-bg-base-7 oui-text-base-contrast-36 hover:oui-bg-base-6 active:oui-bg-base-6"),"data-testid":"oui-testid-orderEntry-side-buy-button",children:C("common.buy")}),i.jsx(J,{onClick:()=>{e.setOrderValue("side",H.SELL)},"data-type":H.SELL,fullWidth:!0,size:"md",className:b(t===H.SELL&&e.canTrade?"oui-bg-danger-darken hover:oui-bg-danger-darken/80 active:oui-bg-danger-darken/80":"oui-bg-base-7 oui-text-base-contrast-36 hover:oui-bg-base-6 active:oui-bg-base-6"),"data-testid":"oui-testid-orderEntry-side-sell-button",children:C("common.sell")}),U&&i.jsx(J,{size:"md",fullWidth:!0,trailing:i.jsx(ws,{size:12,className:"oui-text-base-contrast-36"}),onClick:()=>{ee.show(xr,{currentLeverage:f})},className:b("oui-bg-base-7 oui-text-primary-light hover:oui-bg-base-6 active:oui-bg-base-6"),children:Pt(f,{fix:2})+"x"})]}),i.jsx("div",{className:"oui-w-full lg:oui-flex-1",children:i.jsx(eo,{type:s.order_type,side:t,canTrade:e.canTrade,onChange:E=>{r("order_type",E)}})})]}),i.jsxs(m,{justify:"between",children:[i.jsx(x,{size:"2xs",children:C("common.available")}),i.jsx(x.numeral,{unit:o.quote,size:"2xs",className:"oui-text-base-contrast-80",unitClassName:"oui-ml-1 oui-text-base-contrast-54",dp:2,padding:!1,children:e.canTrade?n:0})]}),i.jsx(Xr,{type:e.type,symbolInfo:o,values:{quantity:s.order_quantity,price:s.order_price,trigger_price:s.trigger_price,total:s.total,level:s.level,side:s.side,order_type_ext:s.order_type_ext},errors:P?_:null,onChange:(E,G)=>{e.setOrderValue(E,G)},onValuesChange:e.setOrderValues,refs:e.refs,onBlur:e.onBlur,onFocus:e.onFocus,bbo:{bboStatus:h,bboType:p,onBBOChange:g,toggleBBO:y},priceInputContainerWidth:e.priceInputContainerWidth}),i.jsx(Jr,{canTrade:e.canTrade,maxQty:a,currentQtyPercentage:e.currentQtyPercentage,value:s.order_quantity?Number(s.order_quantity):0,tick:o.base_tick,dp:o.base_dp,setMaxQty:e.setMaxQty,onValueChange:E=>{r("order_quantity",E)},side:e.side}),i.jsx(_s,{fullWidth:!0,id:"order-entry-submit-button","data-type":H.BUY,className:b(t===H.BUY?"orderly-order-entry-submit-button-buy oui-bg-success-darken hover:oui-bg-success-darken/80 active:oui-bg-success-darken/80":"orderly-order-entry-submit-button-sell oui-bg-danger-darken hover:oui-bg-danger-darken/80 active:oui-bg-danger-darken/80"),onClick:()=>{$()},loading:e.isMutating,disabled:!e.canTrade,children:R}),i.jsx(to,{canTrade:e.canTrade,quote:o.quote,estLiqPrice:e.estLiqPrice,estLeverage:e.estLeverage,currentLeverage:e.currentLeverage}),i.jsx(te,{className:"oui-w-full"}),i.jsx(Qr,{quote_dp:e.symbolInfo.quote_dp,switchState:e.tpslSwitch,onSwitchChanged:e.setTpslSwitch,orderType:s.order_type,errors:P?_:null,isReduceOnly:s.reduce_only,values:{tp:{trigger_price:s.tp_trigger_price??"",PnL:s.tp_pnl??"",Offset:s.tp_offset??"","Offset%":s.tp_offset_percentage??"",ROI:s.tp_ROI??""},sl:{trigger_price:s.sl_trigger_price??"",PnL:s.sl_pnl??"",Offset:s.sl_offset??"","Offset%":s.sl_offset_percentage??"",ROI:s.sl_ROI??""}},onChange:(E,G)=>{e.setOrderValue(E,G)}}),i.jsxs(m,{justify:"between",itemAlign:"center",className:"!oui-mt-0 xl:!oui-mt-3",children:[i.jsxs(m,{itemAlign:"center",gapX:1,children:[i.jsx(bt,{"data-testid":"oui-testid-orderEntry-reduceOnly-switch",className:"oui-h-[14px]",id:"reduceOnly",checked:e.formattedOrder.reduce_only,onCheckedChange:E=>{e.setOrderValue("reduce_only",E)}}),i.jsx("label",{htmlFor:"reduceOnly",className:"oui-text-xs",children:C("orderEntry.reduceOnly")})]}),!I&&i.jsx(io,{pinned:I,setPinned:z,needConfirm:S,setNeedConfirm:T,onValueChange:r,orderTypeExtra:s.order_type_ext,showExtra:s.order_type===N.LIMIT&&!e.tpslSwitch,hidden:Z,setHidden:K})]}),I&&i.jsxs(M,{p:2,r:"md",intensity:700,position:"relative",children:[i.jsx(Ai,{pinned:I,setPinned:z,needConfirm:S,setNeedConfirm:T,onValueChange:r,orderTypeExtra:s.order_type_ext,showExtra:s.order_type===N.LIMIT&&!e.tpslSwitch,hidden:Z,setHidden:K}),i.jsx(Zr,{onClick:()=>{z(!1)},className:"oui-group oui-absolute oui-right-2 oui-top-2","data-testid":"oui-testid-orderEntry-pinned-button"})]})]})})},ai="M10.007 1.302a.74.74 0 0 0-.486.214c-1.033.989-1.349 1.815-.972 2.948-.88.675-1.437.84-2.536.84-1.503 0-2.484.182-3.152.85v.02a1.583 1.583 0 0 0 0 2.248l1.867 1.882-3.181 3.18c-.26.26-.28.696-.02.956.261.26.699.26.959 0l3.193-3.194 1.87 1.861a1.585 1.585 0 0 0 2.25 0h.02c.668-.667.854-1.523.854-3.144 0-1.03.212-1.758.852-2.523 1.233.361 1.95.015 2.961-.995a.68.68 0 0 0 .188-.48c0-.234-.06-.593-.209-1.04a5.34 5.34 0 0 0-1.312-2.103 5.35 5.35 0 0 0-2.104-1.312c-.448-.15-.808-.208-1.042-.208",Zr=e=>{let[t,s]=u.useState(ai);return i.jsx("button",{...e,children:i.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",onMouseEnter:()=>{s('M10.008 1.302a.74.74 0 0 0-.486.214c-1.033.989-1.349 1.815-.972 2.948-.88.675-1.437.84-2.536.84-1.503 0-2.484.182-3.152.85v.02a1.583 1.583 0 0 0 0 2.248l1.867 1.882-3.181 3.18c-.26.26-.28.696-.02.956.261.26.699.26.959 0l3.193-3.194 1.87 1.861a1.585 1.585 0 0 0 2.25 0h.02c.668-.667.854-1.523.854-3.144 0-1.03.212-1.758.853-2.523 1.232.361 1.95.015 2.96-.995a.68.68 0 0 0 .188-.48c0-.234-.06-.593-.209-1.04a5.34 5.34 0 0 0-1.312-2.103A5.35 5.35 0 0 0 11.05 1.51c-.448-.15-.808-.208-1.042-.208m.258 1.37c.708.131 1.421.6 1.93 1.107.507.508.94 1.13 1.119 1.945-.636.61-1.026.658-1.662.323a.67.67 0 0 0-.779.117c-1.214 1.213-1.533 2.314-1.533 3.8 0 1.292-.076 1.773-.48 2.206-.113.123-.27.104-.374 0L3.799 7.486a.24.24 0 0 1-.017-.34c.239-.29.769-.515 2.226-.514 1.742.001 2.668-.448 3.812-1.52a.67.67 0 0 0 .125-.77c-.343-.686-.29-1.047.321-1.67"')},onMouseLeave:()=>{s(ai)},className:"oui-text-primary-darken ",children:i.jsx("path",{d:t})})})},Xr=e=>{let{type:t,symbolInfo:s,errors:r,values:o,onFocus:a,onBlur:n,bbo:l}=e,{t:d}=w(),{parseErrorMsg:c}=Ei(r),h=l.bboStatus==="on",p=t===N.LIMIT?i.jsxs(m,{direction:"column",itemAlign:"end",className:"oui-text-2xs",children:[s.quote,i.jsx(m,{height:20,px:3,justify:"center",itemAlign:"center",r:"base",className:b("oui-mt-[2px] oui-cursor-pointer oui-select-none oui-border",l.bboStatus==="on"?"oui-border-primary":"oui-border-line-12",l.bboStatus==="disabled"&&"oui-cursor-not-allowed"),onClick:()=>{l.bboStatus==="disabled"?ee.dialog({title:d("common.tips"),size:"xs",content:i.jsx(x,{intensity:54,children:d("orderEntry.bbo.disabled.tips")})}):l.toggleBBO()},children:i.jsx(x,{className:b(l.bboStatus==="on"&&"oui-text-primary",l.bboStatus==="off"&&"oui-text-base-contrast-54",l.bboStatus==="disabled"&&"oui-text-base-contrast-20"),children:d("orderEntry.bbo")})})]}):s.quote;return i.jsxs("div",{className:"oui-space-y-1",children:[t===N.STOP_LIMIT||t===N.STOP_MARKET?i.jsx("div",{className:"oui-group",children:i.jsx(Ge,{label:d("common.trigger"),suffix:s.quote,error:c("trigger_price"),id:"trigger",ref:e.refs.triggerPriceInputRef,value:o.trigger_price,onChange:g=>{e.onChange("trigger_price",g)},formatters:[me.dpFormatter(s.quote_dp)],onFocus:a(1),onBlur:n(1)})}):null,t===N.LIMIT||t===N.STOP_LIMIT?i.jsxs("div",{ref:e.refs.priceInputContainerRef,className:"oui-group oui-relative oui-w-full",children:[i.jsx(Ge,{label:d("common.price"),suffix:p,id:"price",value:o.price,error:c("order_price"),ref:e.refs.priceInputRef,onChange:g=>{e.onChange("order_price",g)},formatters:[me.dpFormatter(s.quote_dp)],onFocus:a(0),onBlur:n(0),readonly:h,classNames:{root:b(h&&"focus-within:oui-outline-transparent "),input:b(h&&"oui-cursor-auto")}}),l.bboStatus==="on"&&i.jsx("div",{className:b("oui-absolute oui-bottom-1 oui-left-0"),children:i.jsx(so,{value:l.bboType,onChange:l.onBBOChange,contentStyle:{width:e.priceInputContainerWidth}})})]}):null,i.jsxs(ye,{cols:2,className:"oui-group oui-space-x-1",children:[i.jsx(Ge,{label:d("common.qty"),suffix:s.base,id:"order_quantity_input",name:"order_quantity_input",className:"!oui-rounded-r",value:o.quantity,error:c("order_quantity"),onChange:g=>{e.onChange("order_quantity",g)},formatters:[me.dpFormatter(s.base_dp)],onFocus:a(2),onBlur:n(2)}),i.jsx(Ge,{label:`${d("common.total")}â‰ˆ`,suffix:s.quote,id:"total",className:"!oui-rounded-l",value:o.total,error:c("total"),onChange:g=>{e.onChange("total",g)},onFocus:a(3),onBlur:n(3),formatters:[me.dpFormatter(s.quote_dp)]})]})]})},Ge=u.forwardRef((e,t)=>{var a,n,l,d;let{errorMsgVisible:s}=u.useContext(Qt),[r,o]=u.useState("0");return i.jsx(Ft.tooltip,{ref:t,tooltip:s?e.error:void 0,autoComplete:"off",autoFocus:e.autoFocus,size:"lg",placeholder:e.readonly?"":r,id:e.id,name:e.name,color:e.error?"danger":void 0,prefix:i.jsx(Gr,{id:e.id,children:e.label}),suffix:e.suffix,value:e.readonly?"":e.value||"",onValueChange:e.onChange,onFocus:c=>{var h;o(""),(h=e.onFocus)==null||h.call(e,c)},onBlur:c=>{var h;o("0"),(h=e.onBlur)==null||h.call(e,c)},formatters:[...e.formatters??[],me.numberFormatter,me.currencyFormatter,me.decimalPointFormatter],classNames:{root:b("orderly-order-entry oui-relative oui-h-[54px] oui-rounded oui-border oui-border-solid oui-border-line oui-px-2 oui-py-1 group-first:oui-rounded-t-xl group-last:oui-rounded-b-xl",e.className,(a=e.classNames)==null?void 0:a.root),input:b("oui-mb-1 oui-mt-5 oui-h-5",(n=e==null?void 0:e.classNames)==null?void 0:n.input),prefix:b("oui-absolute oui-left-2 oui-top-[7px] oui-text-base-contrast-36",(l=e.classNames)==null?void 0:l.prefix),suffix:b("oui-absolute oui-right-0 oui-top-0 oui-justify-start oui-py-2 oui-text-2xs oui-text-base-contrast-36",(d=e.classNames)==null?void 0:d.suffix)},readOnly:e.readonly})});Ge.displayName="CustomInput";var Gr=e=>i.jsx("label",{htmlFor:e.id,className:"oui-absolute oui-left-2 oui-top-[7px] oui-text-2xs oui-text-base-contrast-36",children:e.children}),Jr=e=>{let{canTrade:t}=e,{t:s}=w(),r=u.useMemo(()=>t?e.side===H.BUY?"buy":"sell":void 0,[e.side,t]),o=u.useMemo(()=>e.side===H.BUY?s("orderEntry.maxBuy"):s("orderEntry.maxSell"),[e.side,s]);return i.jsxs("div",{children:[i.jsx(Ss.single,{disabled:e.maxQty===0||!t,value:e.value,color:r,markCount:4,showTip:!0,max:e.maxQty,step:e.tick,onValueChange:e.onValueChange}),i.jsxs(m,{justify:"between",className:"oui-pt-1 xl:oui-pt-2",children:[i.jsx(x.numeral,{rule:"percentages",size:"2xs",color:r,dp:2,padding:!1,children:t?e.currentQtyPercentage:0}),i.jsxs(m,{children:[i.jsx("button",{className:et({size:"2xs",className:"oui-mr-1"}),onClick:()=>e.setMaxQty(),"data-testid":"oui-testid-orderEntry-maxQty-value-button",children:o}),i.jsx(x.numeral,{size:"2xs",color:r,dp:e.dp,padding:!1,"data-testid":"oui-testid-orderEntry-maxQty-value",children:t?e.maxQty:0})]})]})]})},eo=e=>{let{t}=w(),s=[{label:t("orderEntry.orderType.limitOrder"),value:N.LIMIT},{label:t("orderEntry.orderType.marketOrder"),value:N.MARKET},{label:t("orderEntry.orderType.stopLimit"),value:N.STOP_LIMIT},{label:t("orderEntry.orderType.stopMarket"),value:N.STOP_MARKET}];return i.jsx(qt.options,{testid:"oui-testid-orderEntry-orderType-button",currentValue:e.type,value:e.type,options:s,onValueChange:e.onChange,contentProps:{className:"oui-bg-base-8 oui-w-full"},valueFormatter:(r,o)=>{if(!s.find(n=>n.value===r))return i.jsx(x,{size:"xs",children:o.placeholder});let a={[N.LIMIT]:t("orderEntry.orderType.limit"),[N.MARKET]:t("common.marketPrice"),[N.STOP_LIMIT]:t("orderEntry.orderType.stopLimit"),[N.STOP_MARKET]:t("orderEntry.orderType.stopMarket")}[r];return i.jsx(x,{size:"xs",color:e.canTrade?e.side===H.BUY?"buy":"sell":void 0,children:a})},size:"md"})};function to(e){let{canTrade:t}=e,{t:s}=w();return i.jsxs("div",{className:"oui-space-y-[2px] xl:oui-space-y-1",children:[i.jsxs(m,{justify:"between",children:[i.jsx(x,{size:"2xs",children:s("orderEntry.estLiqPrice")}),i.jsx(x.numeral,{unit:e.quote,size:"2xs",className:"oui-text-base-contrast-80",unitClassName:"oui-ml-1 oui-text-base-contrast-36",children:t?e.estLiqPrice??"--":"--"})]}),i.jsxs(m,{justify:"between",children:[i.jsx(x,{size:"2xs",children:s("leverage.accountLeverage")}),i.jsxs(m,{gapX:1,className:et({size:"2xs",intensity:80}),children:[i.jsx(x.numeral,{unit:t?"x":void 0,children:t?e.currentLeverage??"--":"--"}),e.estLeverage&&i.jsxs(i.Fragment,{children:[i.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M2.505 4.997c0-.23.186-.416.416-.416H6.07L4.833 3.332l.586-.585 1.964 1.95a.42.42 0 0 1 .122.3.42.42 0 0 1-.122.3l-1.964 1.95-.586-.585L6.07 5.413H2.921a.416.416 0 0 1-.416-.416",fill:"#fff",fillOpacity:".54"})}),i.jsx("span",{children:`${e.estLeverage}x`})]})]})]})]})}function io(e){let[t,s]=u.useState(!1);return i.jsxs(ks,{open:t,onOpenChange:s,children:[i.jsx(Ps,{asChild:!0,children:i.jsx("button",{"data-testid":"oui-testid-orderEntry-additional-button",onClick:()=>{s(!0)},children:i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"oui-fill-white/[.36] hover:oui-fill-white/80",children:i.jsx("path",{d:"M3.332 2.665a.667.667 0 0 0-.667.667v1.333c0 .368.299.667.667.667h1.333a.667.667 0 0 0 .667-.667V3.332a.667.667 0 0 0-.667-.667zm4 0a.667.667 0 0 0-.667.667v1.333c0 .368.299.667.667.667h1.333a.667.667 0 0 0 .667-.667V3.332a.667.667 0 0 0-.667-.667zm4 0a.667.667 0 0 0-.667.667v1.333c0 .368.299.667.667.667h1.333a.667.667 0 0 0 .667-.667V3.332a.667.667 0 0 0-.667-.667zm-8 4a.667.667 0 0 0-.667.667v1.333c0 .368.299.667.667.667h1.333a.667.667 0 0 0 .667-.667V7.332a.667.667 0 0 0-.667-.667zm4 0a.667.667 0 0 0-.667.667v1.333c0 .368.299.667.667.667h1.333a.667.667 0 0 0 .667-.667V7.332a.667.667 0 0 0-.667-.667zm4 0a.667.667 0 0 0-.667.667v1.333c0 .368.299.667.667.667h1.333a.667.667 0 0 0 .667-.667V7.332a.667.667 0 0 0-.667-.667zm-8 4a.667.667 0 0 0-.667.667v1.333c0 .368.299.667.667.667h1.333a.667.667 0 0 0 .667-.667v-1.333a.667.667 0 0 0-.667-.667zm4 0a.667.667 0 0 0-.667.667v1.333c0 .368.299.667.667.667h1.333a.667.667 0 0 0 .667-.667v-1.333a.667.667 0 0 0-.667-.667zm4 0a.667.667 0 0 0-.667.667v1.333c0 .368.299.667.667.667h1.333a.667.667 0 0 0 .667-.667v-1.333a.667.667 0 0 0-.667-.667z"})})})}),i.jsx(Ts,{side:"top",align:"end",className:"oui-w-[230px]",children:i.jsx(Ai,{...e})})]})}var so=e=>{let{t}=w(),s=[{label:t("orderEntry.bbo.counterparty1"),value:q.COUNTERPARTY1},{label:t("orderEntry.bbo.counterparty5"),value:q.COUNTERPARTY5},{label:t("orderEntry.bbo.queue1"),value:q.QUEUE1},{label:t("orderEntry.bbo.queue5"),value:q.QUEUE5}];return i.jsx(qt.options,{testid:"oui-testid-orderEntry-bbo-orderType-button",currentValue:e.value,value:e.value,options:s,onValueChange:e.onChange,contentProps:{className:"oui-bg-base-8 oui-w-full",style:e.contentStyle},size:"sm",classNames:{trigger:"oui-border-none oui-bg-transparent"},valueFormatter:(r,o)=>{let a=s.find(n=>n.value===r);return i.jsx(M,{children:i.jsx(x,{size:"sm",children:a==null?void 0:a.label})})}})},ro=e=>{let[t,s]=B("orderly-order-entry-order-type",N.LIMIT),[r,o]=B("orderly-order-entry-order-side",H.BUY),[a,n]=B("orderly_order_bbo_type",void 0),l=u.useRef(a),{formattedOrder:d,setValue:c,setValues:h,symbolInfo:p,...g}=Cs(e.symbol,{initialOrder:{symbol:e.symbol,order_type:t,side:r}}),[y,f]=B("orderly-order-entry-tp_sl-switch",!1),{state:C}=ue(),{wrongNetwork:j,disabledConnect:_}=lt(),P=u.useMemo(()=>!j&&!_&&(C.status===F.EnableTrading||C.status===F.EnableTradingWithoutConnected),[C.status,j,_]),{currentLeverage:k}=gt(),v=xt(),S=u.useRef(4),T=u.useRef(null),I=u.useRef(null),z=u.useRef(null),[Z,K]=u.useState(0),R=u.useMemo(()=>Number(d.order_quantity)>=Number(g.maxQty)?1:js(Number(d.order_quantity??0),0,g.maxQty)/100,[d.order_quantity,g.maxQty]),$=()=>{if(p.base_tick<1)return;let O=Os.formatNumber(d==null?void 0:d.order_quantity,new L((p==null?void 0:p.base_tick)||"0").toNumber());c("order_quantity",O,{shouldUpdateLastChangedField:!1})},U=O=>V=>{S.current=O},E=O=>V=>{setTimeout(()=>{S.current===O&&(S.current=4)},300),O===2&&$()},G=()=>{h({tp_trigger_price:"",sl_trigger_price:""})},ae=()=>{h({order_type_ext:void 0})},Ue=()=>{c("order_quantity",g.maxQty)},We=(O,V,oe)=>{if(O==="order_type"&&s(V),O==="side"&&o(V),O==="reduce_only"&&V||O==="order_type"&&(V===N.STOP_LIMIT||V===N.STOP_MARKET)){let Y={tp_trigger_price:"",sl_trigger_price:"",[O]:V};O==="order_type"&&(Y.order_type_ext=""),h(Y);return}if(O==="order_type"&&V!==N.LIMIT){let Y={level:void 0,order_type_ext:void 0,[O]:V};h(Y);return}c(O,V,oe)},ne=O=>{f(O),O?ae():G()},de=u.useMemo(()=>y||[N.POST_ONLY,N.IOC,N.FOK].includes(d.order_type_ext)?"disabled":a&&d.order_type===N.LIMIT?"on":"off",[a,y,d.order_type,d.order_type_ext]),we=()=>{a?(n(void 0),h({order_type_ext:void 0,level:void 0})):n(l.current||q.COUNTERPARTY1)},Qe=O=>{n(O),l.current=O};return u.useEffect(()=>{if(de==="disabled"){let{order_type_ext:O}=d;h({order_type_ext:It({order_type_ext:O})?void 0:O,level:void 0})}},[de,d.order_type_ext]),u.useEffect(()=>{if(de==="on"){let O=Ar(a,d.side),V=zr(a);h({order_type_ext:O,level:V})}},[a,de,d.side]),u.useEffect(()=>{let O=V=>{c("order_price",V)};return v.on("update:orderPrice",O),()=>{v.off("update:orderPrice",O)}},[]),u.useEffect(()=>{let O=oe=>{setTimeout(()=>{oe==null||oe.focus()},0)},V=oe=>{let Y=Tt(oe[0]),{order_type:ie,order_type_ext:Le}=d;if(S.current===1&&(ie===N.STOP_LIMIT||ie===N.STOP_MARKET)){c("trigger_price",Y),O(T.current);return}if(It({order_type:ie,order_type_ext:Le})){n(void 0),h({order_type_ext:void 0,level:void 0}),setTimeout(()=>{v.emit("update:orderPrice",Y)},0),O(I.current);return}if(ie===N.STOP_LIMIT||ie===N.LIMIT){c("order_price",Y),O(I.current);return}if(ie===N.STOP_MARKET){c("trigger_price",Y),O(T.current);return}if(ie===N.MARKET){n(void 0),h({order_type:N.LIMIT,order_price:Y}),O(I.current);return}c("order_price",Y),O(I.current)};return v.on("orderbook:item:click",V),()=>{v.off("orderbook:item:click",V)}},[d,p]),u.useEffect(()=>{let O=z.current;if(!O)return;let V=new ResizeObserver(oe=>{for(let Y of oe){let ie=Y.contentRect.width;ie&&K(ie)}});return V.observe(O),()=>{V.unobserve(O)}},[z,d.order_type_ext]),u.useEffect(()=>{g.reset(),g.resetMetaState()},[e.symbol]),{...g,currentQtyPercentage:R,side:d.side,type:d.order_type,level:d.level,setOrderValue:We,setOrderValues:h,currentLeverage:k,formattedOrder:d,tpslSwitch:y,setTpslSwitch:ne,setMaxQty:Ue,symbolInfo:p,onFocus:U,onBlur:E,refs:{triggerPriceInputRef:T,priceInputRef:I,priceInputContainerRef:z},canTrade:P,bboStatus:de,bboType:a,onBBOChange:Qe,toggleBBO:we,priceInputContainerWidth:Z}},qi=e=>{let t=ro(e);return i.jsx(Yr,{...t,containerRef:e.containerRef})};function oo(e){return i.jsx("div",{className:"top-toolbar oui-flex oui-h-[44px] oui-justify-between md:oui-justify-start oui-items-center oui-p-2 md:oui-px-3 md:oui-pt-3 md:oui-pb-[14px]",children:e.children})}var Kt=e=>i.jsx("svg",{viewBox:"0 0 12 12",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Caret-down",children:i.jsx("path",{id:"Vector",d:"M3.00349 3.9978C2.59149 3.9978 2.36564 4.4653 2.61289 4.7948C2.98789 5.2948 5.23784 8.29479 5.61289 8.79479C5.81289 9.06128 6.20974 9.06128 6.40974 8.79479L9.40974 4.7948C9.65694 4.4653 9.41554 3.9978 9.00349 3.9978H3.00349Z"})})}),Fi=e=>i.jsx("svg",{viewBox:"0 0 18 18",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Display settings",children:i.jsx("path",{id:"Union",fillRule:"evenodd",clipRule:"evenodd",d:"M15.0571 10.9856L11.6295 5.06523L8.71377 10.8968C8.38933 11.5456 7.54464 11.7223 6.98733 11.2579L5.75311 10.2294L2.83709 14.7654L1.57532 13.9543L4.49134 9.41824C4.97892 8.65978 6.0207 8.49981 6.71338 9.07705L7.58387 9.80246L10.5991 3.77192C10.9997 2.97082 12.1302 2.93624 12.579 3.71137L14.6517 7.29147C14.7714 7.03643 15.0305 6.85983 15.3309 6.85983C15.7451 6.85983 16.0809 7.19562 16.0809 7.60983C16.0809 8.02405 15.7451 8.35983 15.3309 8.35983C15.31 8.35983 15.2892 8.35897 15.2687 8.35729L16.3553 10.2341L15.0571 10.9856ZM2.58093 6.85983C2.16672 6.85983 1.83093 7.19562 1.83093 7.60983C1.83093 8.02405 2.16672 8.35983 2.58093 8.35983C2.99515 8.35983 3.33093 8.02405 3.33093 7.60983C3.33093 7.19562 2.99515 6.85983 2.58093 6.85983ZM4.83093 6.85983C4.41672 6.85983 4.08093 7.19562 4.08093 7.60983C4.08093 8.02405 4.41672 8.35983 4.83093 8.35983C5.24515 8.35983 5.58093 8.02405 5.58093 7.60983C5.58093 7.19562 5.24515 6.85983 4.83093 6.85983ZM6.33093 7.60983C6.33093 7.19562 6.66672 6.85983 7.08093 6.85983C7.49515 6.85983 7.83093 7.19562 7.83093 7.60983C7.83093 8.02405 7.49515 8.35983 7.08093 8.35983C6.66672 8.35983 6.33093 8.02405 6.33093 7.60983ZM11.5809 6.85983C11.1667 6.85983 10.8309 7.19562 10.8309 7.60983C10.8309 8.02405 11.1667 8.35983 11.5809 8.35983C11.9951 8.35983 12.3309 8.02405 12.3309 7.60983C12.3309 7.19562 11.9951 6.85983 11.5809 6.85983Z"})})}),ao=e=>i.jsx("svg",{viewBox:"0 0 18 18",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Indicators",children:i.jsx("path",{id:"Union",fillRule:"evenodd",clipRule:"evenodd",d:"M9.74483 2.25C8.96145 2.25 8.26885 2.76459 8.04549 3.51818L7.46202 5.48254H5.06262V7.08339H6.98652L5.00539 13.7532L4.31554 13.1112L3.22498 14.2831L4.4777 15.4489C5.08739 16.015 6.08317 15.7469 6.32134 14.945L8.65649 7.08339H11.6032V5.48254H9.13198L9.58033 3.97311C9.60167 3.90112 9.66833 3.85084 9.74483 3.85084H11.69V2.25H9.74483ZM10.6234 11.2354L10.2638 11.5172C10.0153 11.712 9.65591 11.6684 9.46115 11.4199C9.26639 11.1713 9.30998 10.812 9.55852 10.6172L10.1451 10.1575C10.5693 9.82514 11.1868 9.94011 11.4642 10.4005L11.4682 10.407L12.1304 11.5752L13.4594 10.3111C13.6882 10.0935 14.05 10.1025 14.2677 10.3313C14.4853 10.5601 14.4763 10.922 14.2475 11.1396L12.7116 12.6006L13.3897 13.797L13.6482 13.4503C13.8369 13.1972 14.1951 13.145 14.4483 13.3337C14.7014 13.5225 14.7536 13.8807 14.5649 14.1338L13.9917 14.9025L13.94 14.9457C13.5178 15.2981 12.8837 15.1886 12.6003 14.7226L12.5958 14.7151L11.8576 13.4129L10.3563 14.841C10.1275 15.0586 9.76561 15.0495 9.54798 14.8208C9.33036 14.592 9.3394 14.2301 9.56819 14.0125L11.2764 12.3875L10.6234 11.2354Z"})})}),no=e=>i.jsx("svg",{viewBox:"0 0 18 18",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Setting",children:i.jsx("path",{id:"Vector",d:"M6.72589 1.84154C5.66239 2.17904 4.74515 2.72954 3.93665 3.48254C3.6869 3.71504 3.6104 4.09604 3.7724 4.39604C4.37315 5.50679 3.74464 6.69554 2.38939 6.76379C2.05789 6.78029 1.76465 7.0263 1.68665 7.34955C1.5524 7.9083 1.49915 8.37629 1.49915 8.98979C1.49915 9.50504 1.55464 10.0885 1.66339 10.6075C1.73089 10.9315 2.0129 11.1648 2.3429 11.1933C3.7064 11.311 4.3814 12.3513 3.7724 13.6773C3.6374 13.972 3.6989 14.3245 3.93665 14.545C4.73315 15.2815 5.64814 15.8013 6.72589 16.1388C7.03339 16.2348 7.38064 16.1185 7.56964 15.8575C8.40364 14.7033 9.6134 14.6995 10.4054 15.8575C10.5921 16.1298 10.9341 16.261 11.2491 16.162C12.2894 15.8343 13.2584 15.277 14.0616 14.545C14.3091 14.3193 14.3744 13.954 14.2259 13.654C13.6019 12.3948 14.3197 11.239 15.6082 11.2165C15.9502 11.2105 16.2547 10.9863 16.3349 10.654C16.4647 10.1163 16.4991 9.64829 16.4991 8.98979C16.4991 8.42429 16.4324 7.86704 16.3116 7.32629C16.2351 6.98354 15.9359 6.74054 15.5849 6.73979C14.3167 6.73754 13.6056 5.49104 14.2259 4.39604C14.3984 4.09154 14.3444 3.71804 14.0849 3.48254C13.2674 2.74004 12.2706 2.15954 11.2259 1.84154C10.9049 1.74404 10.5636 1.86404 10.3821 2.14604C9.65764 3.27179 8.30465 3.29129 7.5929 2.17004C7.41065 1.88204 7.04989 1.73879 6.72589 1.84154ZM11.2844 3.43455C11.7966 3.64905 12.2009 3.8733 12.6651 4.22505C12.1206 5.9478 13.0439 7.73729 14.9564 8.17304C15.0036 8.48279 14.9991 8.67029 14.9991 8.98979C14.9991 9.37154 15.0044 9.50579 14.9609 9.78179C13.0566 10.1763 12.1146 11.9155 12.6449 13.7538C12.1889 14.0845 11.8626 14.314 11.2904 14.5353C9.94639 13.1673 8.0804 13.1073 6.7079 14.5443C6.1724 14.3088 5.76066 14.0995 5.34441 13.7478C5.86041 11.881 4.98815 10.2693 3.05165 9.7803C2.9654 9.4383 2.9999 8.4723 3.0494 8.17905C5.0519 7.69905 5.8409 5.92679 5.34365 4.21979C5.78315 3.88904 6.1784 3.6483 6.69215 3.4398C7.9859 4.75605 9.92839 4.8873 11.2844 3.43455ZM8.99915 5.98979C7.3424 5.98979 5.99915 7.33304 5.99915 8.98979C5.99915 10.6473 7.3424 11.9898 8.99915 11.9898C10.6559 11.9898 11.9991 10.6473 11.9991 8.98979C11.9991 7.33304 10.6559 5.98979 8.99915 5.98979ZM8.99915 7.48979C9.8279 7.48979 10.4991 8.16179 10.4991 8.98979C10.4991 9.81855 9.8279 10.4898 8.99915 10.4898C8.1704 10.4898 7.49915 9.81855 7.49915 8.98979C7.49915 8.16179 8.1704 7.48979 8.99915 7.48979Z"})})}),lo=e=>i.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Bars",children:i.jsx("path",{id:"Union",fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 15.5C12.5 15.7761 12.7239 16 13 16H14C14.2761 16 14.5 15.7761 14.5 15.5V14H16C16.2761 14 16.5 13.7761 16.5 13.5V12.5C16.5 12.2239 16.2761 12 16 12H14.5V2.5C14.5 2.22386 14.2761 2 14 2H13C12.7239 2 12.5 2.22386 12.5 2.5V4H11C10.7239 4 10.5 4.22386 10.5 4.5V5.5C10.5 5.77614 10.7239 6 11 6H12.5V15.5ZM5.5 17.5C5.5 17.7761 5.72386 18 6 18H7C7.27614 18 7.5 17.7761 7.5 17.5V10H9C9.27614 10 9.5 9.77614 9.5 9.5V8.5C9.5 8.22386 9.27614 8 9 8H7.5V4.5C7.5 4.22386 7.27614 4 7 4H6C5.72386 4 5.5 4.22386 5.5 4.5V14H4C3.72386 14 3.5 14.2239 3.5 14.5V15.5C3.5 15.7761 3.72386 16 4 16H5.5V17.5Z"})})}),uo=e=>i.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Candles",children:i.jsx("path",{id:"Union",fillRule:"evenodd",clipRule:"evenodd",d:"M7.25 2.5V4H8.5C8.77614 4 9 4.22386 9 4.5V15.5C9 15.7761 8.77614 16 8.5 16H7.25V17.5C7.25 17.7761 7.02614 18 6.75 18H6.25C5.97386 18 5.75 17.7761 5.75 17.5V16H4.5C4.22386 16 4 15.7761 4 15.5V4.5C4 4.22386 4.22386 4 4.5 4H5.75V2.5C5.75 2.22386 5.97386 2 6.25 2H6.75C7.02614 2 7.25 2.22386 7.25 2.5ZM5.5 5.5V14.5H7.5V5.5H5.5ZM14.25 4.5V7H15.5C15.7761 7 16 7.22386 16 7.5V15.5C16 15.7761 15.7761 16 15.5 16H14.25V17.5C14.25 17.7761 14.0261 18 13.75 18H13.25C12.9739 18 12.75 17.7761 12.75 17.5V16H11.5C11.2239 16 11 15.7761 11 15.5V7.5C11 7.22386 11.2239 7 11.5 7H12.75V4.5C12.75 4.22386 12.9739 4 13.25 4H13.75C14.0261 4 14.25 4.22386 14.25 4.5ZM12.5 8.5V14.5H14.5V8.5H12.5Z"})})}),co=e=>i.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsxs("g",{id:"Hollow Candles",children:[i.jsx("path",{id:"Subtract",fillRule:"evenodd",clipRule:"evenodd",d:"M5.5 14.5V5.5H7.5V14.5H5.5Z",fill:"white",fillOpacity:"0.12"}),i.jsx("path",{id:"Union",fillRule:"evenodd",clipRule:"evenodd",d:"M7.25 2.5V4H8.5C8.77614 4 9 4.22386 9 4.5V15.5C9 15.7761 8.77614 16 8.5 16H7.25V17.5C7.25 17.7761 7.02614 18 6.75 18H6.25C5.97386 18 5.75 17.7761 5.75 17.5V16H4.5C4.22386 16 4 15.7761 4 15.5V4.5C4 4.22386 4.22386 4 4.5 4H5.75V2.5C5.75 2.22386 5.97386 2 6.25 2H6.75C7.02614 2 7.25 2.22386 7.25 2.5ZM5.5 5.5V14.5H7.5V5.5H5.5ZM14.25 4.5V7H15.5C15.7761 7 16 7.22386 16 7.5V15.5C16 15.7761 15.7761 16 15.5 16H14.25V17.5C14.25 17.7761 14.0261 18 13.75 18H13.25C12.9739 18 12.75 17.7761 12.75 17.5V16H11.5C11.2239 16 11 15.7761 11 15.5V7.5C11 7.22386 11.2239 7 11.5 7H12.75V4.5C12.75 4.22386 12.9739 4 13.25 4H13.75C14.0261 4 14.25 4.22386 14.25 4.5ZM12.5 8.5V14.5H14.5V8.5H12.5Z"})]})}),ho=e=>i.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Line",children:i.jsx("path",{id:"Vector 16 (Stroke)",fillRule:"evenodd",clipRule:"evenodd",d:"M18.3 2.72288C18.542 2.85596 18.6303 3.15999 18.4972 3.40195L13.495 12.4968C13.0776 13.2557 12.1061 13.5044 11.3754 13.0394L7.19878 10.3816L2.97738 17.558C2.83737 17.796 2.53092 17.8754 2.2929 17.7354L1.43097 17.2284C1.19295 17.0884 1.1135 16.7819 1.25351 16.5439L5.73746 8.92122C6.16792 8.18943 7.1194 7.96045 7.83567 8.41626L11.9995 11.0659L16.7448 2.43811C16.8778 2.19615 17.1819 2.10788 17.4238 2.24096L18.3 2.72288Z"})})}),mo=e=>i.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsxs("g",{id:"Area",children:[i.jsx("path",{id:"Vector 16 (Stroke)",fillRule:"evenodd",clipRule:"evenodd",d:"M18.3 2.72288C18.542 2.85596 18.6303 3.15999 18.4972 3.40195L13.495 12.4968C13.0776 13.2557 12.1061 13.5044 11.3754 13.0394L7.19878 10.3816L2.97738 17.558C2.83737 17.796 2.53092 17.8754 2.2929 17.7354L1.43097 17.2284C1.19295 17.0884 1.1135 16.7819 1.25351 16.5439L5.73746 8.92122C6.16792 8.18943 7.1194 7.96045 7.83567 8.41626L11.9995 11.0659L16.7448 2.43811C16.8778 2.19615 17.1819 2.10788 17.4238 2.24096L18.3 2.72288Z"}),i.jsx("path",{id:"Subtract",fillRule:"evenodd",clipRule:"evenodd",d:"M2.7608 17.7562C2.84602 17.899 3.00106 18 3.19016 18H16.362C17.4665 18 18.362 17.1046 18.362 16V3.94663C18.362 3.86618 18.3453 3.79397 18.3162 3.73108L13.495 12.4968C13.0776 13.2557 12.1061 13.5044 11.3754 13.0394L7.19881 10.3816L2.9774 17.558C2.92465 17.6477 2.84826 17.7148 2.7608 17.7562Z",fill:"white",fillOpacity:"0.12"})]})}),po=e=>i.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Baseline",children:i.jsx("path",{id:"Union",fillRule:"evenodd",clipRule:"evenodd",d:"M6.05938 2.93544C6.55642 1.71198 8.27766 1.68139 8.81785 2.88642L11.4361 8.72723H9.24438L7.4717 4.77279L5.86521 8.72723H3.70647L6.05938 2.93544ZM13.9282 14.2865L13.0051 12.2272H10.8133L12.5586 16.1204C13.088 17.3014 14.7641 17.3026 15.2952 16.1224L17.048 12.2272H14.8549L13.9282 14.2865ZM2.28459 12.2272H4.44333L1.85293 18.6036L0 17.8509L2.28459 12.2272ZM16.4299 8.72723H18.623L19.3384 7.13759L17.5145 6.31686L16.4299 8.72723ZM1.42645 10.2272C1.42645 9.95109 1.65031 9.72723 1.92645 9.72723H2.92645C3.20259 9.72723 3.42645 9.95109 3.42645 10.2272V10.7272C3.42645 11.0034 3.20259 11.2272 2.92645 11.2272H1.92645C1.65031 11.2272 1.42645 11.0034 1.42645 10.7272V10.2272ZM4.42645 10.2272C4.42645 9.95109 4.65031 9.72723 4.92645 9.72723H5.92645C6.20259 9.72723 6.42645 9.95109 6.42645 10.2272V10.7272C6.42645 11.0034 6.20259 11.2272 5.92645 11.2272H4.92645C4.65031 11.2272 4.42645 11.0034 4.42645 10.7272V10.2272ZM7.92645 9.72723C7.65031 9.72723 7.42645 9.95109 7.42645 10.2272V10.7272C7.42645 11.0034 7.65031 11.2272 7.92645 11.2272H8.92645C9.20259 11.2272 9.42645 11.0034 9.42645 10.7272V10.2272C9.42645 9.95109 9.20259 9.72723 8.92645 9.72723H7.92645ZM10.4265 10.2272C10.4265 9.95109 10.6503 9.72723 10.9265 9.72723H11.9265C12.2026 9.72723 12.4265 9.95109 12.4265 10.2272V10.7272C12.4265 11.0034 12.2026 11.2272 11.9265 11.2272H10.9265C10.6503 11.2272 10.4265 11.0034 10.4265 10.7272V10.2272ZM13.9265 9.72723C13.6503 9.72723 13.4265 9.95109 13.4265 10.2272V10.7272C13.4265 11.0034 13.6503 11.2272 13.9265 11.2272H14.9265C15.2026 11.2272 15.4265 11.0034 15.4265 10.7272V10.2272C15.4265 9.95109 15.2026 9.72723 14.9265 9.72723H13.9265ZM16.4265 10.2272C16.4265 9.95109 16.6503 9.72723 16.9265 9.72723H17.9265C18.2026 9.72723 18.4265 9.95109 18.4265 10.2272V10.7272C18.4265 11.0034 18.2026 11.2272 17.9265 11.2272H16.9265C16.6503 11.2272 16.4265 11.0034 16.4265 10.7272V10.2272Z"})})}),go=e=>i.jsx("svg",{viewBox:"0 0 12 12",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Unselected",children:i.jsx("path",{id:"Vector",d:"M6.00684 0.999023C3.24544 0.999023 1.00684 3.23752 1.00684 5.99902C1.00684 8.76051 3.24544 10.999 6.00684 10.999C8.76834 10.999 11.0068 8.76051 11.0068 5.99902C11.0068 3.23752 8.76834 0.999023 6.00684 0.999023ZM6.00684 1.99902C8.21584 1.99902 10.0068 3.79002 10.0068 5.99902C10.0068 8.20801 8.21584 9.99901 6.00684 9.99901C3.79769 9.99901 2.00684 8.20801 2.00684 5.99902C2.00684 3.79002 3.79769 1.99902 6.00684 1.99902Z",fill:"white",fillOpacity:"0.2"})})}),xo=e=>i.jsx("svg",{viewBox:"0 0 12 12",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Selected-Multiple Choices-fill",children:i.jsx("path",{id:"Subtract",fillRule:"evenodd",clipRule:"evenodd",d:"M1.00684 5.99902C1.00684 3.23752 3.24544 0.999023 6.00684 0.999023C8.76834 0.999023 11.0068 3.23752 11.0068 5.99902C11.0068 8.76051 8.76834 10.999 6.00684 10.999C3.24544 10.999 1.00684 8.76051 1.00684 5.99902ZM8.49243 3.65563C8.60602 3.54726 8.76156 3.49957 8.91068 3.49957C9.05981 3.49957 9.21534 3.54726 9.32893 3.65563C9.5567 3.87231 9.5567 4.23649 9.32893 4.45317L5.25362 8.33706C5.02644 8.55374 4.6443 8.55374 4.41712 8.33706L2.67014 6.67253C2.44296 6.45585 2.44296 6.09161 2.67014 5.87499C2.89791 5.65831 3.28004 5.65831 3.50722 5.87499L4.83537 7.1407L8.49243 3.65563Z",fill:"#608CFF"})})}),Ui=()=>{let{t:e}=w();return{mobileTimeIntervalMoreMap:u.useMemo(()=>[[{value:"3",label:e("tradingView.timeInterval.3m")},{value:"5",label:e("tradingView.timeInterval.5m")},{value:"30",label:e("tradingView.timeInterval.30m")},{value:"120",label:e("tradingView.timeInterval.2h")}],[{value:"360",label:e("tradingView.timeInterval.6h")},{value:"720",label:e("tradingView.timeInterval.12h")},{value:"3d",label:e("tradingView.timeInterval.3d")},{value:"1M",label:e("tradingView.timeInterval.1M")}]],[e])}};function ni(e){return Pe(yt)?i.jsx(fo,{...e}):i.jsx(bo,{...e})}function bo(e){let{t}=w(),s=u.useMemo(()=>[{value:"1",label:t("tradingView.timeInterval.1m")},{value:"3",label:t("tradingView.timeInterval.3m")},{value:"5",label:t("tradingView.timeInterval.5m")},{value:"15",label:t("tradingView.timeInterval.15m")},{value:"30",label:t("tradingView.timeInterval.30m")},{value:"60",label:t("tradingView.timeInterval.1h")},{value:"240",label:t("tradingView.timeInterval.4h")},{value:"720",label:t("tradingView.timeInterval.12h")},{value:"1D",label:t("tradingView.timeInterval.1d")},{value:"1W",label:t("tradingView.timeInterval.1w")},{value:"1M",label:t("tradingView.timeInterval.1M")}],[t]);return i.jsx("div",{className:b("oui-text-2xs oui-text-base-contrast-36 oui-flex oui-gap-[2px] oui-items-center oui-mr-3 oui-font-semibold","oui-overflow-hidden"),children:s.map(r=>i.jsx("div",{className:b("oui-cursor-pointer oui-px-2","hover:oui-text-base-contrast-80","oui-break-normal oui-whitespace-nowrap",e.interval===r.value&&"oui-text-base-contrast-80 oui-bg-white/[.06] oui-rounded"),id:r.value,onClick:()=>e.changeInterval(r.value),children:r.label},r.value))})}function fo(e){let{t}=w(),s=u.useMemo(()=>[{value:"1",label:t("tradingView.timeInterval.1m")},{value:"15",label:t("tradingView.timeInterval.15m")},{value:"60",label:t("tradingView.timeInterval.1h")},{value:"240",label:t("tradingView.timeInterval.4h")},{value:"1D",label:t("tradingView.timeInterval.1d")},{value:"1W",label:t("tradingView.timeInterval.1w")}],[t]),{mobileTimeIntervalMoreMap:r}=Ui(),o=u.useMemo(()=>{for(let a of r)for(let n of a)if(n.value===e.interval)return n.label;return null},[e.interval,r]);return i.jsxs(m,{justify:"start",itemAlign:"center",gap:3,className:b("oui-text-2xs oui-text-base-contrast-36","oui-overflow-hidden"),children:[i.jsx("div",{className:" oui-flex oui-gap-1 oui-items-center oui-mr-3 oui-font-semibold",children:s.map(a=>i.jsx("div",{className:b("oui-px-2","oui-break-normal oui-whitespace-nowrap",e.interval===a.value&&"oui-text-base-contrast-80 oui-bg-white/[.06] oui-rounded"),onClick:()=>e.changeInterval(a.value),children:a.label},a.value))}),i.jsx(yo,{...e,children:o?i.jsx("div",{className:"oui-text-base-contrast-80",children:o}):i.jsx(x,{className:"oui-break-normal oui-whitespace-nowrap",children:t("tradingView.timeInterval.more")})})]})}function yo(e){let[t,s]=he.useState(!1),{mobileTimeIntervalMoreMap:r}=Ui();return i.jsxs(Ve,{open:t,onOpenChange:s,children:[i.jsx(qe,{asChild:!0,children:i.jsxs("div",{className:"oui-flex oui-justify-start oui-items-center oui-gap-0.5",children:[e.children,i.jsx(Kt,{className:b("oui-w-3 oui-h-3",t&&"oui-text-base-contrast-80 oui-rotate-180")})]})}),i.jsx(ot,{children:i.jsx(Fe,{onCloseAutoFocus:o=>o.preventDefault(),onClick:o=>o.stopPropagation(),align:"start",alignOffset:0,sideOffset:0,className:b("oui-markets-dropdown-menu-content oui-bg-base-9 oui-w-screen oui-flex oui-flex-col oui-gap-2 oui-p-3"),children:r.map((o,a)=>i.jsx("div",{className:"oui-flex oui-gap-2",children:o.map(n=>i.jsx("div",{className:b("oui-w-full  oui-text-2xs oui-flex oui-items-center oui-justify-center oui-h-6  oui-rounded",n.value===e.interval?"oui-text-base-contrast oui-bg-primary-darken":"oui-text-base-contrast-36 oui-bg-base-5"),onClick:()=>{e.changeInterval(n.value)},children:i.jsx("div",{children:n.label})},n.value))},a))})})]})}function vo({displayControlState:e,changeDisplayControlState:t}){let[s,r]=u.useState(!1),{t:o}=w(),a=u.useMemo(()=>[{label:o("common.position"),id:"position"},{label:o("tradingView.displayControl.buySell"),id:"buySell"},{label:o("tradingView.displayControl.limitOrders"),id:"limitOrders"},{label:o("tradingView.displayControl.stopOrders"),id:"stopOrders"},{label:o("common.tpsl"),id:"tpsl"},{label:o("tpsl.positionTpsl"),id:"positionTpsl"}],[o]);return i.jsx(i.Fragment,{children:i.jsxs(Ve,{open:s,onOpenChange:r,children:[i.jsx(qe,{asChild:!0,children:i.jsxs(m,{justify:"start",itemAlign:"center",className:"oui-gap-[2px] oui-cursor-pointer oui-text-base-contrast-36  hover:oui-text-base-contrast-80",children:[i.jsx(Fi,{className:b("oui-w-[18px] oui-h-[18px] ",s&&"oui-text-base-contrast-80")}),i.jsx(Kt,{className:b("oui-w-3 oui-h-3",s&&"oui-text-base-contrast-80 oui-rotate-180")})]})}),i.jsx(ot,{children:i.jsx(Fe,{onCloseAutoFocus:n=>n.preventDefault(),onClick:n=>n.stopPropagation(),align:"start",className:"oui-bg-base-8",children:i.jsx(m,{direction:"column",gap:4,px:5,py:5,width:240,justify:"start",itemAlign:"start",children:a.map(n=>i.jsxs(m,{justify:"between",itemAlign:"center",className:"oui-w-full",children:[i.jsx(x,{className:b("oui-text-sm oui-text-base-contrast-80",!e[n.id]&&"oui-text-base-contrast-36"),children:n.label}),i.jsx(bt,{className:"oui-h-4 oui-w-8",checked:e[n.id],onCheckedChange:l=>{t({...e,[n.id]:l})}})]},n.id))})})})]})})}function Co(e){let[t,s]=u.useState(!1),{t:r}=w(),o=u.useMemo(()=>[[{label:r("common.position"),id:"position"},{label:r("tradingView.displayControl.limitOrders"),id:"limitOrders"}],[{label:r("tradingView.displayControl.stopOrders"),id:"stopOrders"},{label:r("common.tpsl"),id:"tpsl"}],[{label:r("tpsl.positionTpsl"),id:"positionTpsl"},{label:r("tradingView.displayControl.buySell"),id:"buySell"}]],[r]);return i.jsxs(Ve,{open:t,onOpenChange:s,children:[i.jsx(qe,{asChild:!0,children:i.jsxs("div",{className:b("oui-flex oui-gap-0.5 oui-justify-center oui-text-base-contrast-36 oui-items-center",t&&"oui-text-base-contrast-8"),children:[i.jsx(Fi,{className:b("oui-w-[18px] oui-h-[18px] ",t&&"oui-text-base-contrast-80")}),i.jsx(Kt,{className:b("oui-w-3 oui-h-3",t&&"oui-text-base-contrast-80 oui-rotate-180")})]})}),i.jsx(ot,{children:i.jsx(Fe,{onCloseAutoFocus:a=>a.preventDefault(),onClick:a=>a.stopPropagation(),align:"start",alignOffset:0,sideOffset:0,className:b("oui-tradingview-display-control-dropdown-menu-content oui-bg-base-9 oui-w-screen oui-flex oui-flex-col oui-gap-2 oui-p-3"),children:o.map((a,n)=>i.jsx("div",{className:"oui-flex oui-gap-2",children:a.map(l=>i.jsxs("div",{className:b("oui-w-full oui-bg-base-5  oui-text-2xs oui-flex oui-items-center oui-justify-between oui-h-6  oui-rounded oui-px-2",e.displayControlState[l.id]?"oui-text-base-contrast":"oui-text-base-contrast-36 "),onClick:()=>{e.changeDisplayControlState({...e.displayControlState,[l.id]:!e.displayControlState[l.id]})},children:[i.jsx("div",{children:l.label}),e.displayControlState[l.id]?i.jsx(xo,{className:"oui-h-3 oui-w-3"}):i.jsx(go,{className:"oui-h-3 oui-w-3"})]},l.id))},n))})})]})}var li=({url:e,children:t})=>i.jsx("span",{onClick:()=>{window.open(e)},className:"oui-text-primary-light oui-underline oui-cursor-pointer",children:t});function jo(){let{t:e}=w();return i.jsx("div",{className:"oui-z-0 oui-text-base-contrast-80 oui-absolute oui-top-0 oui-left-0 oui-right-0 oui-bottom-0 oui-flex oui-flex-col oui-justify-start md:oui-justify-center oui-items-center oui-p-2 md:oui-p-10",children:i.jsxs("div",{children:[i.jsx("p",{className:"oui-mb-6 oui-text-xs",children:e("tradingView.noScriptSrc")}),i.jsx("p",{className:"oui-mb-3 oui-text-2xs md:oui-text-xs oui-text-base-contrast-54 md:oui-text-base-contrast-80 md:oui-text-base oui-pl-0 md:oui-pl-2",children:i.jsx(Mt,{i18nKey:"tradingView.noScriptSrc.1",components:[i.jsx(li,{url:"https://www.tradingview.com/advanced-charts"})]})}),i.jsx("p",{className:"oui-text-2xs md:oui-text-xs oui-text-base-contrast-54 md:oui-text-base-contrast-80 md:oui-text-base oui-pl-0 md:oui-pl-2",children:i.jsx(Mt,{i18nKey:"tradingView.noScriptSrc.2",components:[i.jsx(li,{url:"https://orderly.network/docs/sdks/react/components/trading#tradingviewconfig"})]})})]})})}function wo(e){let[t,s]=u.useState(!1),{t:r}=w(),o=u.useMemo(()=>[{icon:i.jsx(lo,{fill:"currentColor",className:"oui-w-5 oui-h-5"}),label:r("tradingView.lineType.bars"),value:"0"},{icon:i.jsx(uo,{fill:"currentColor",className:"oui-w-5 oui-h-5"}),label:r("tradingView.lineType.candles"),value:"1"},{icon:i.jsx(co,{fill:"currentColor",className:"oui-w-5 oui-h-5"}),label:r("tradingView.lineType.hollowCandles"),value:"9"},{icon:i.jsx(ho,{fill:"currentColor",className:"oui-w-5 oui-h-5"}),label:r("tradingView.lineType.line"),value:"2"},{icon:i.jsx(mo,{fill:"currentColor",className:"oui-w-5 oui-h-5"}),label:r("tradingView.lineType.area"),value:"3"},{icon:i.jsx(po,{fill:"currentColor",className:"oui-w-5 oui-h-5"}),label:r("tradingView.lineType.baseline"),value:"10"}],[r]),a=u.useMemo(()=>{let n=o.find(l=>l.value===e.lineType);return n?n.icon:o[1].icon},[e.lineType]);return i.jsxs(Ve,{open:t,onOpenChange:s,children:[i.jsx(qe,{asChild:!0,children:i.jsx(M,{className:b("oui-w-[18px] oui-h-[18px] oui-cursor-pointer oui-text-base-contrast-36 hover:oui-text-base-contrast-80",t&&"oui-text-base-contrast-80"),children:a})}),i.jsx(ot,{children:i.jsx(Fe,{onCloseAutoFocus:n=>n.preventDefault(),onClick:n=>n.stopPropagation(),align:"start",sideOffset:20,className:"oui-bg-base-8",children:i.jsx(m,{direction:"column",gap:4,px:5,py:5,width:240,justify:"start",itemAlign:"start",children:o.map(n=>i.jsxs(m,{justify:"start",itemAlign:"center",gap:2,className:b("oui-text-base-contrast-36 oui-cursor-pointer oui-w-full hover:oui-text-base-contrast",e.lineType===n.value&&"oui-text-base-contrast"),onClick:()=>e.changeLineType(n.value),children:[n.icon,i.jsx(x,{className:"oui-text-sm",children:n.label})]},n.value))})})})]})}var ui=({children:e,onClick:t})=>i.jsx(M,{onClick:t,className:"oui-cursor-pointer oui-w-[18px] oui-h-[18px] oui-text-base-contrast-36  hover:oui-text-base-contrast-80",children:e});function _o(e){let{chartRef:t,interval:s,changeDisplaySetting:r,displayControlState:o,tradingViewScriptSrc:a,changeInterval:n,lineType:l,changeLineType:d,openChartSetting:c,openChartIndicators:h}=e,p=Pe(yt);return i.jsx("div",{className:"oui-h-full oui-w-full  oui-relative",children:a?i.jsxs("div",{className:"oui-z-[1] oui-absolute oui-top-0 oui-bottom-0 oui-right-0 oui-left-0 oui-h-full oui-w-full oui-flex oui-flex-col",children:[i.jsx(oo,{children:p?i.jsxs(m,{gapX:2,width:"100%",justify:"between",className:"oui-overflow-x-scroll oui-hide-scrollbar",children:[i.jsx(ni,{interval:s??"1",changeInterval:n}),i.jsx(Co,{displayControlState:o,changeDisplayControlState:r})]}):i.jsxs(i.Fragment,{children:[i.jsx(ni,{interval:s??"1",changeInterval:n}),i.jsx(te,{direction:"vertical",className:"oui-h-4",mx:2,intensity:8}),i.jsxs(m,{justify:"start",itemAlign:"center",gap:2,children:[i.jsx(vo,{displayControlState:o,changeDisplayControlState:r}),i.jsx(ui,{onClick:h,children:i.jsx(ao,{})}),i.jsx(wo,{lineType:l,changeLineType:d}),i.jsx(ui,{onClick:c,children:i.jsx(no,{})})]})]})}),i.jsx("div",{className:"oui-h-full oui-w-full",ref:t})]}):i.jsx(jo,{})})}var So="#008676",No="#D92D6B",Wi="#131519",ko="#00B49E",Po="#FF447C",To="#333948",Oo="#FFFFFF",Lo="#F4F7F9",Mo="regular 11px Manrope",Io={upColor:So,downColor:No,chartBG:Wi,pnlUpColor:ko,pnlDownColor:Po,pnlZoreColor:To,textColor:Oo,qtyTextColor:Lo,font:Mo,volumeUpColor:"#0C3E3A",volumeDownColor:"#5A1E36",closeIcon:"rgba(255, 255, 255, 0.8)"},Eo=(e,t)=>{let s={"paneProperties.background":e.chartBG,"paneProperties.backgroundType":"solid","mainSeriesProperties.candleStyle.upColor":e.upColor,"mainSeriesProperties.candleStyle.downColor":e.downColor,"mainSeriesProperties.candleStyle.borderColor":e.upColor,"mainSeriesProperties.candleStyle.borderUpColor":e.upColor,"mainSeriesProperties.candleStyle.borderDownColor":e.downColor,"mainSeriesProperties.candleStyle.wickUpColor":e.upColor,"mainSeriesProperties.candleStyle.wickDownColor":e.downColor,"paneProperties.separatorColor":"#2B2833","paneProperties.vertGridProperties.color":"#26232F","paneProperties.horzGridProperties.color":"#26232F","scalesProperties.fontSize":t?8:12,"scalesProperties.textColor":"#97969B","paneProperties.legendProperties.showSeriesTitle":!1},r={"volume.volume.color.0":e.volumeDownColor,"volume.volume.color.1":e.volumeUpColor};return{overrides:s,studiesOverrides:r}},Et="Orderly",be=e=>e.includes(":")?e.split(":")[1]:e,Qi=e=>e.startsWith(`${Et}:`)?e:`${Et}:${e}`,Do=2,Ro="--",Ki=["BRACKET","STOP_BRACKET"],Yi=["POSITIONAL_TP_SL","TP_SL"],Zi=e=>e.root_algo_order_id!==e.algo_order_id&&(e.algo_type==="TAKE_PROFIT"||e.algo_type==="STOP_LOSS"),Ao=e=>!!e&&Ki.includes(e),Xi=e=>e.type==="CLOSE_POSITION",zo=e=>Xi(e)&&e.is_activated,$o=e=>Zi(e)&&e.is_activated,Gi=e=>e.root_algo_order_algo_type==="TP_SL"||Ao(e.root_algo_order_algo_type)&&e.is_activated,Bo=(e,t)=>{let s=e.algo_type;return{TAKE_PROFIT:pe.t("tpsl.takeProfit"),STOP_LOSS:pe.t("tpsl.stopLoss")}[s]||null},Ho=e=>{let t=new Map,s=1;return[...e].reverse().filter(Gi).forEach(r=>{r.root_algo_order_id&&!t.has(r.root_algo_order_id)&&t.set(r.root_algo_order_id,s++)}),t},Vo=(e,t)=>{let s=Math.abs(e.type==="CLOSE_POSITION"?t.balance:e.quantity),r=e.side==="SELL"?1:-1,o=t.open.toString();return{estPnl:new L(e.trigger_price).minus(o??0).times(s).times(r).toString(),quantity:s,openPrice:o}},qo=e=>e!==void 0&&e!==""?new L(e).todp(Do,L.ROUND_FLOOR):Ro;function Fo(){let[e,{cancelOrder:t,cancelAlgoOrder:s,cancelTPSLChildOrder:r}]=Ce({status:se.INCOMPLETE});return u.useCallback(o=>{if(o.algo_order_id){if(Yi.includes(o.root_algo_order_algo_type)){let a=e==null?void 0:e.find(n=>n.algo_order_id===o.root_algo_order_id);return a.child_orders.every(n=>!!n.trigger_price)?r(o.algo_order_id,o.root_algo_order_id):s(a.algo_order_id,o.symbol).then()}return s(o.algo_order_id,o.symbol).then()}return t(o.order_id,o.symbol).then()},[t,e])}function Uo(e){xt();let[,{updateOrder:t,cancelAlgoOrder:s,updateAlgoOrder:r,updateTPSLOrder:o}]=Ce({status:se.INCOMPLETE});return u.useCallback((a,n)=>{var d;if(a.algo_order_id)if(Yi.includes(a.root_algo_order_algo_type)){let c=[{order_id:a.algo_order_id,trigger_price:new L(n.value).toString()}];return o(a.root_algo_order_id,c).then(h=>{}).catch(h=>{e&&e.error(h.message)})}else{if(Ki.includes(a.algo_type))return r(a.algo_order_id,{order_price:new L(n.value).toString()}).then(c=>{}).catch(c=>{e&&e.error(c.message)});{let c={quantity:a.quantity,trigger_price:a.trigger_price,symbol:a.symbol,price:a.price,algo_order_id:a.algo_order_id};return a.order_tag&&(c.order_tag=a.order_tag),n.type==="price"&&(c.price=new L(n.value).toString()),n.type==="trigger_price"&&(c.trigger_price=new L(n.value).toString()),r(a.algo_order_id,c).then(h=>{}).catch(h=>{e&&e.error(h.message)})}}let l={order_price:(d=a.price)==null?void 0:d.toString(),order_quantity:a.quantity.toString(),symbol:a.symbol,order_type:a.type,side:a.side,visible_quantity:0,reduce_only:a.reduce_only};return new L(a.visible_quantity??a.visible??0).eq(a.quantity)&&delete l.visible_quantity,Object.keys(a).includes("reduce_only")||delete l.reduce_only,a.order_tag&&(l.order_tag=a.order_tag),n.type==="price"&&(l.order_price=new L(n.value).toString()),t(a.order_id,l).then(c=>{}).catch(c=>{e.error(c.message)})},[t])}function Wo(e){let{onSubmit:t}=_i({symbol:e,side:H.BUY,order_type:N.MARKET},{watchOrderbook:!0});return{sendLimitOrder:()=>{},sendMarketOrder:s=>(s.reduce_only=!1,t(s).catch(r=>{W.error(r)}))}}var Qo=e=>t=>e(t),Ko=({closeConfirm:e,colorConfig:t,onToast:s,mode:r,symbol:o})=>{let a=Fo(),n=Uo(s),l=He(),d=u.useCallback(y=>e&&e(y),[e]),{sendMarketOrder:c,sendLimitOrder:h}=Wo(o),p=u.useCallback(y=>{if(l)return{baseMin:l[y]("base_min"),baseMax:l[y]("base_max"),baseTick:l[y]("base_tick"),quoteTick:l[y]("quote_tick")}},[l]),g=u.useRef({cancelOrder:a,closePosition:d,editOrder:n,colorConfig:t,sendLimitOrder:h,getSymbolInfo:p,sendMarketOrder:Qo(c),mode:r});return u.useEffect(()=>{g.current.getSymbolInfo=p},[l]),u.useEffect(()=>{g.current.sendLimitOrder=h,g.current.sendMarketOrder=c},[h,c]),u.useEffect(()=>{g.current.closePosition=d},[e]),u.useEffect(()=>{g.current.cancelOrder=a},[a]),g.current},Yo=Ko,Zo=class Dt{constructor(t,s){this.instance=t,this.currentSymbol="",this.broker=s,this.positionLines={},this.lastPositions=null}renderPositions(t){var s;if(t===null||t.length===0){this.removePositions();return}((s=this.lastPositions)==null?void 0:s.length)!==t.length&&this.removePositions(),t[0].symbol!==this.currentSymbol&&(this.removePositions(),this.currentSymbol=t[0].symbol),t.forEach((r,o)=>this.drawPositionLine(r,o)),this.lastPositions=t}getBasePositionLine(){return this.instance.activeChart().createPositionLine().setTooltip(pe.t("positions.closePosition")).setQuantityBackgroundColor(this.broker.colorConfig.chartBG).setCloseButtonBackgroundColor(this.broker.colorConfig.chartBG).setBodyTextColor(this.broker.colorConfig.textColor).setQuantityTextColor(this.broker.colorConfig.qtyTextColor).setBodyFont(this.broker.colorConfig.font).setQuantityFont(this.broker.colorConfig.font).setLineLength(100).setLineStyle(1)}static getPositionQuantity(t){return $e(new L(t).todp(4,L.ROUND_DOWN).toString())}static getPositionPnL(t,s){let r=pe.t("tpsl.pnl"),o=new L(t).toFixed(s,L.ROUND_DOWN);return new L(t).eq(0)?`${r} 0`:new L(t).greaterThan(0)?`${r} +${$e(o)}`:`${r} ${$e(o)}`}removePositions(){Object.keys(this.positionLines).forEach(t=>{this.positionLines[Number(t)].remove(),delete this.positionLines[Number(t)]})}drawPositionLine(t,s){let r=this.broker.colorConfig,o=t.unrealPnl>=0,a=t.balance>=0,n=r.pnlZoreColor,l=new L(t.unrealPnl);l.greaterThan(0)?n=r.upColor:l.lessThan(0)&&(n=r.downColor),o?r.pnlUpColor:r.pnlDownColor;let d=a?r.upColor:r.downColor,c=new L(t.open).toNumber();this.positionLines[s]=this.positionLines[s]??this.getBasePositionLine(),this.positionLines[s].setQuantity(Dt.getPositionQuantity(t.balance)).setPrice(c).setCloseButtonIconColor(r.closeIcon).setCloseButtonBorderColor(d).setBodyBackgroundColor(n).setQuantityTextColor(d).setBodyBorderColor(n).setLineColor(d).setQuantityBorderColor(d).setText(Dt.getPositionPnL(t.unrealPnl,t.unrealPnlDecimal)),this.broker.mode!==3&&this.positionLines[s].onClose(null,()=>{this.broker.closePosition(t)})}},Rt=e=>{if(e!=null)return e.algo_order_id||e.order_id},Xo=class{constructor(){this.quantityTpslNoMap=new Map,this.tpslPnlMap=new Map,this.positions=null}getQuantityTpslNoMap(){return this.quantityTpslNoMap}getTpslPnlMap(){return this.tpslPnlMap}getFormattedEstPnl(e){if(this.positions===null)return"";let t=this.positions[0];if(!t)return"";let{estPnl:s}=Vo(e,t);return qo(s)}prepareTpslPnlMap(e){let t=[];return e.forEach(s=>{let r=Rt(s);if(r&&$o(s)){let o=this.tpslPnlMap.get(r),a=this.getFormattedEstPnl(s);o!==a&&(t.push(r),this.tpslPnlMap.set(r,a))}}),t}prepareQuantityTpslNoMap(e){this.quantityTpslNoMap=Ho(e)}recalculatePnl(e,t){return this.positions=e,this.prepareTpslPnlMap(t)}clear(){this.positions=null,this.quantityTpslNoMap.clear(),this.tpslPnlMap.clear()}},Ji=class Se{constructor(t,s){this.instance=t,this.pendingOrderLineMap=new Map,this.pendingOrders=[],this.broker=s,this.tpslCalService=new Xo}renderPendingOrders(t){t&&(this.pendingOrders=t),this.cleanOldPendingOrders(this.pendingOrders),this.tpslCalService.prepareTpslPnlMap(this.pendingOrders),this.tpslCalService.prepareQuantityTpslNoMap(this.pendingOrders),this.pendingOrders.forEach(s=>this.renderPendingOrder(s))}updatePositions(t){let s=this.tpslCalService.recalculatePnl(t,this.pendingOrders);this.pendingOrders.filter(r=>s.includes(Rt(r))).forEach(r=>this.renderPendingOrder(r))}renderPendingOrder(t){let s=Se.getOrderId(t);if(!s)return;let r=this.drawOrderLine(s,t);r&&this.pendingOrderLineMap.set(s,r)}cleanOldPendingOrders(t){let s=new Set(t.map(r=>Se.getOrderId(r)));this.pendingOrderLineMap.forEach((r,o)=>!s.has(o)&&this.removePendingOrder(o))}removePendingOrder(t){if(t===void 0)return;let s=this.pendingOrderLineMap.get(t);s&&(this.pendingOrderLineMap.delete(t),s.remove())}getBaseOrderLine(){let t=this.broker.colorConfig;return this.instance.activeChart().createOrderLine().setCancelTooltip(pe.t("orders.cancelOrder")).setQuantityTextColor(t.qtyTextColor).setQuantityBackgroundColor(t.chartBG).setBodyBackgroundColor(t.chartBG).setCancelButtonBackgroundColor(t.chartBG).setLineStyle(1).setBodyFont(t.font).setQuantityFont(t.font)}static getCombinationType(t){let{algo_type:s,type:r}=t;if((s==="STOP_LOSS"||s==="TAKE_PROFIT"||s==="STOP")&&r==="LIMIT")return"STOP_LIMIT";if((s==="STOP_LOSS"||s==="TAKE_PROFIT"||s==="STOP")&&r==="MARKET")return"STOP_MARKET";if(s==="BRACKET"){if(r==="LIMIT")return"BRACKET_LIMIT";if(r==="MARKET")return"BRACKET_MARKET"}return"LIMIT"}static getText(t){let s=Se.getCombinationType(t);return s==="STOP_LIMIT"||s==="STOP_MARKET"||s==="STOP_BRACKET_LIMIT"||s==="STOP_BRACKET_MARKET"?t.type==="LIMIT"?`${pe.t("orderEntry.orderType.stopLimit")} ${$e(t.price)}`:pe.t("orderEntry.orderType.stopMarket"):pe.t("orderEntry.orderType.limit")}static getOrderPrice(t){return t.trigger_price||t.price}getTPSLTextWithTpsl(t,s){return Rt(s),t}getTPSLText(t){let s=Bo(t,this.tpslCalService.getQuantityTpslNoMap());return s?this.getTPSLTextWithTpsl(s,t):null}getOrderQuantity(t){if(t.algo_order_id){if(zo(t)||Xi(t))return"100%";if(Gi(t)){let s=new L(t.quantity).minus(t.executed??0).div(new L(t.position_qty)).mul(100).todp(2).toNumber();return`${Math.min(Math.abs(s),100).toString()}%`}}return $e(new L(t.quantity).toString())}drawOrderLine(t,s){let r=Zi(s)?this.getTPSLText(s):Se.getText(s);if(r===null)return null;let o=this.broker.colorConfig,a=this.pendingOrderLineMap.get(t)??this.getBaseOrderLine(),n=s.side==="BUY"?o.upColor:o.downColor;s.side==="BUY"?o.pnlUpColor:o.pnlDownColor;let l=Se.getOrderPrice(s),d=100,c=this.getOrderQuantity(s),h=o.textColor;return a.setText(r).setCancelButtonIconColor(o.closeIcon).setCancelButtonBorderColor(n).setBodyTextColor(h).setBodyBorderColor(n).setQuantityBorderColor(n).setQuantityTextColor(n).setLineColor(n).setLineLength(d).setQuantity(c??"").setPrice(l),this.broker.mode!==3?(a.onCancel(null,()=>this.broker.cancelOrder(s)),this.applyEditOnMove(a,s)):a.setEditable(!1).setCancellable(!1),a}static getOrderEditKey(t){let s=this.getCombinationType(t);if(["LIMIT","BRACKET_LIMIT"].includes(s))return"price";if(s==="STOP_LIMIT"||s==="STOP_MARKET"||t.rootAlgoOrderAlgoType==="POSITIONAL_TP_SL"||t.rootAlgoOrderAlgoType==="TP_SL"||t.rootAlgoOrderAlgoType==="BRACKET"||t.rootAlgoOrderAlgoType==="STOP_BRACKET")return"trigger_price"}applyEditOnMove(t,s){let r=Se.getOrderEditKey(s);t.onMove(()=>{this.broker.editOrder(s,{type:r,value:`${t.getPrice()}`}).then(o=>{o.success||this.renderPendingOrder(s)}).catch(()=>this.renderPendingOrder(s))})}removeAll(){this.pendingOrderLineMap.forEach(t=>t.remove()),this.pendingOrderLineMap.clear(),this.pendingOrders=[],this.tpslCalService.clear()}};Ji.getOrderId=e=>{if(e!=null)return e.algo_order_id||e.order_id};var Go=Ji,es={1:{startOf:"minute",period:0},3:{startOf:"hour",period:3*60*1e3},5:{startOf:"hour",period:5*60*1e3},15:{startOf:"hour",period:15*60*1e3},30:{startOf:"hour",period:30*60*1e3},60:{startOf:"hour",period:0},120:{startOf:"day",period:2*60*60*1e3},240:{startOf:"day",period:4*60*60*1e3},480:{startOf:"day",period:8*60*60*1e3},720:{startOf:"day",period:12*60*60*1e3},D:{startOf:"day",period:0},"1D":{startOf:"day",period:0},"3D":{startOf:"year",period:3*24*60*60*1e3},"5D":{startOf:"year",period:5*24*60*60*1e3},"1W":{startOf:"week",period:0},"1M":{startOf:"month",period:0}};function di(e,t,s,r){let{startOf:o,period:a}=es[s],n=new Date(e.updated_time).getTime(),l=Mr(n).getTime();o==="minute"?l=Or(n).getTime():o==="hour"?l=Lr(n).getTime():o==="day"?l=Ds(n).getTime():o==="month"?l=ei(n).getTime():o==="year"?l=Rs(n).getTime():o==="week"?l=As(n).getTime():o==="month"&&(l=ei(n).getTime());let d=a===0?l:Math.floor((n-l)/a)*a+l;t[d]||(t[d]={BUY:[],SELL:[]}),t[d][e.side].length<5&&(t[d][e.side].push(e),r.push(e))}var Jo=(e,t)=>{let s=[],r={};return es[t]?(e.forEach(o=>{if(o.child_orders)for(let a of o.child_orders)a.is_activated&&a.algo_status===se.FILLED&&di(a,r,t,s);else di(o,r,t,s)}),s):[]},ea=class ts{constructor(t,s){this.interval="1D",this.changeInterval=r=>{let o=()=>{this.renderExecutions(this.filledOrders,this.basePriceDecimal),this.instance.activeChart().onDataLoaded().unsubscribe(null,o)};this.interval=r,this.instance.activeChart().onDataLoaded().subscribe(null,o)},this.instance=t,this.executions=[],this.filledOrders=[],this.basePriceDecimal=0,this.broker=s,this.subscribeIntervalChange()}async subscribeIntervalChange(){this.interval=this.instance.symbolInterval().interval;let t=this.changeInterval;this.instance.activeChart().onIntervalChanged().subscribe(null,t)}renderExecutions(t,s){this.filledOrders=t,this.basePriceDecimal=s,this.interval&&(this.removeAll(),Jo(t,this.interval).forEach(r=>{this.executions.push(this.drawExecution(r,s))}))}removeAll(){this.executions.forEach(t=>t.remove()),this.executions=[]}static getExecutionInfo(t,s){var n,l;let r=t.side,o=t.average_executed_price||((l=(n=t.child_orders)==null?void 0:n.find(d=>!!d.average_executed_price))==null?void 0:l.average_executed_price)||0,a=new L(o).todp(s,L.ROUND_FLOOR).toString();return`${r==="BUY"?pe.t("common.buy"):pe.t("common.sell")} ${t.total_executed_quantity} @${$e(a)}`}drawExecution(t,s){var l,d;let r=t.side,o=t.average_executed_price||((d=(l=t.child_orders)==null?void 0:l.find(c=>!!c.average_executed_price))==null?void 0:d.average_executed_price)||0,a=new Date(t.updated_time).getTime()/1e3,n=this.broker.colorConfig;return this.instance.activeChart().createExecutionShape().setArrowHeight(9).setTooltip(ts.getExecutionInfo(t,s)).setTime(a).setPrice(o).setArrowColor(r==="BUY"?n.upColor:n.downColor).setDirection(r==="BUY"?"buy":"sell")}unsubscribeIntervalChange(){let t=this.changeInterval;try{this.instance.activeChart().onIntervalChanged().unsubscribe(null,t)}catch(s){s instanceof Error&&s.message}}destroy(){this.removeAll(),this.unsubscribeIntervalChange()}},ta=class{constructor(e,t,s){this.instance=e,this.positionLineService=new Zo(e,s),this.orderLineService=new Go(e,s),this.executionService=new ea(e,s)}async renderPositions(e){await this.chartReady(),await this.onDataLoaded(),this.positionLineService.renderPositions(e),this.orderLineService.updatePositions(e)}async renderPendingOrders(e){await this.chartReady(),this.orderLineService.renderPendingOrders(e)}async renderFilledOrders(e,t){await this.chartReady(),await this.onDataLoaded(),this.executionService.renderExecutions(e,t)}remove(){this.orderLineService.removeAll(),this.positionLineService.removePositions(),this.executionService.destroy()}onDataLoaded(){return this.instance.activeChart().symbolExt()?Promise.resolve():new Promise(e=>this.instance.activeChart().onDataLoaded().subscribe(null,()=>{e()},!0))}chartReady(){return new Promise(e=>this.instance.onChartReady(()=>{try{this.instance.activeChart().dataReady(()=>e())}catch(t){t.toString().includes("tradingViewApi")}}))}};function ia(e,t){var C;let[s,r]=u.useState(),o=u.useRef(),{state:a}=ue(),[n]=B("unPnlPriceBasis","markPrice"),[{rows:l},d]=rt(e,{calcMode:n}),[c]=Ce({status:se.INCOMPLETE,symbol:e}),h=(C=He())==null?void 0:C[e],p=h("quote_dp"),[g]=Ce({symbol:e,status:se.FILLED,size:500}),y=u.useRef((j,_,P)=>{o.current&&o.current.remove(),o.current=new ta(j,_,P),r(o.current)}),f=u.useRef(()=>{var j;(j=o.current)==null||j.remove(),o.current=void 0});return u.useEffect(()=>{if(a.status<F.EnableTrading&&a.status!==F.EnableTradingWithoutConnected){s==null||s.renderPositions([]);return}if(!t||!t.position){s==null||s.renderPositions([]);return}let j=(l??[]).filter(_=>_.symbol===e).map(_=>({symbol:_.symbol,open:_.average_open_price,balance:_.position_qty,closablePosition:9999,unrealPnl:_.unrealized_pnl??0,interest:0,unrealPnlDecimal:2,basePriceDecimal:4}));s==null||s.renderPositions(j)},[s,l,e,t,a]),u.useEffect(()=>{if(!t||!t.buySell){s==null||s.renderFilledOrders([],6);return}let j=g==null?void 0:g.filter(_=>_.symbol===e);s==null||s.renderFilledOrders(j??[],p??6)},[s,g,e,p,t]),u.useEffect(()=>{let j=[],_=[],P=[],k=[],v=[];if(a.status<F.EnableTrading&&a.status!==F.EnableTradingWithoutConnected){s==null||s.renderPendingOrders([]);return}let S=(l??[]).find(T=>T.symbol===e);c==null||c.forEach(T=>{if(e===T.symbol){if(!T.algo_order_id)P.push(T);else if(T.algo_order_id)if(T.algo_type==="POSITIONAL_TP_SL")for(let I of T.child_orders)I.root_algo_order_algo_type=T.algo_type,I.trigger_price&&I.status!==se.FILLED&&_.push(I);else if(T.algo_type==="TP_SL"){if(S)for(let I of T.child_orders)I.root_algo_order_algo_type=T.algo_type,I.position_qty=S.position_qty,I.trigger_price&&I.status!==se.FILLED&&j.push(I)}else T.algo_type==="STOP_LOSS"||T.algo_type==="TAKE_PROFIT"?k.push(T):T.algo_type==="BRACKET"&&v.push(T)}}),t&&(t.positionTpsl||(_=[]),t.tpsl||(j=[]),t.limitOrders||(P=[],v=[]),t.stopOrders||(k=[])),s==null||s.renderPendingOrders(j.concat(_).concat(P).concat(k).concat(v))},[s,c,e,t,l,a.status]),[y.current,f.current]}function pt(e){return e===void 0?"":typeof e=="string"?e:e.message}var sa=class{constructor(e,t,s){this._datafeedUrl=e,this._requester=t,this._limitedServerResponse=s}getBars(e,t,s){let r={symbol:e.ticker||"",resolution:t,from:s.from,to:s.to};return s.countBack!==void 0&&(r.countback=s.countBack),e.currency_code!==void 0&&(r.currencyCode=e.currency_code),e.unit_id!==void 0&&(r.unitId=e.unit_id),new Promise(async(o,a)=>{try{let n=await this._requester.sendRequest(this._datafeedUrl,"history",r),l=this._processHistoryResponse(n);this._limitedServerResponse&&await this._processTruncatedResponse(l,r),o(l)}catch(n){if(n instanceof Error||typeof n=="string"){let l=pt(n);a(l)}}})}async _processTruncatedResponse(e,t){let s=e.bars.length;try{for(;this._limitedServerResponse&&this._limitedServerResponse.maxResponseLength>0&&this._limitedServerResponse.maxResponseLength===s&&t.from<t.to;){t.countback&&(t.countback=t.countback-s),this._limitedServerResponse.expectedOrder==="earliestFirst"?t.from=Math.round(e.bars[e.bars.length-1].time/1e3):t.to=Math.round(e.bars[0].time/1e3);let r=await this._requester.sendRequest(this._datafeedUrl,"history",t),o=this._processHistoryResponse(r);s=o.bars.length,this._limitedServerResponse.expectedOrder==="earliestFirst"?(o.bars[0].time===e.bars[e.bars.length-1].time&&o.bars.shift(),e.bars.push(...o.bars)):(o.bars[o.bars.length-1].time===e.bars[0].time&&o.bars.pop(),e.bars.unshift(...o.bars))}}catch(r){(r instanceof Error||typeof r=="string")&&pt(r)}}_processHistoryResponse(e){if(e.s!=="ok"&&e.s!=="no_data")throw new Error(e.errmsg);let t=[],s={noData:!1};if(e.s==="no_data")s.noData=!0,s.nextTime=e.nextTime;else{let r=e.v!==void 0,o=e.o!==void 0;for(let a=0;a<e.t.length;++a){let n={time:e.t[a]*1e3,close:parseFloat(e.c[a]),open:parseFloat(e.c[a]),high:parseFloat(e.c[a]),low:parseFloat(e.c[a])};o&&(n.open=parseFloat(e.o[a]),n.high=parseFloat(e.h[a]),n.low=parseFloat(e.l[a])),r&&(n.volume=parseFloat(e.v[a])),t.push(n)}}return{bars:t,meta:s}}},ra=class{constructor(e){e&&(this._headers=e)}sendRequest(e,t,s){if(s!==void 0){let o=Object.keys(s);o.length!==0&&(t+="?"),t+=o.map(a=>`${encodeURIComponent(a)}=${encodeURIComponent(s[a].toString())}`).join("&")}""+t;let r={credentials:"same-origin"};return this._headers!==void 0&&(r.headers=this._headers),fetch(`${e}/${t}`,r).then(o=>o.text()).then(o=>JSON.parse(o))}};function A(e,t,s,r){let o=e[t];return Array.isArray(o)&&(!r||Array.isArray(o[0]))?o[s]:o}function ct(e,t,s){return e+(t!==void 0?"_%|#|%_"+t:"")+(s!==void 0?"_%|#|%_"+s:"")}var oa=class{constructor(e,t,s){this._exchangesList=["Orderly"],this._symbolsInfo={},this._symbolsList=[],this._datafeedUrl=e,this._datafeedSupportedResolutions=t,this._requester=s,this._readyPromise=this._init(),this._readyPromise.catch(r=>{})}resolveSymbol(e,t,s){return this._readyPromise.then(()=>{let r=this._symbolsInfo[ct(e,t,s)];return r===void 0?Promise.reject("invalid symbol"):Promise.resolve(r)})}searchSymbols(e,t,s,r){return this._readyPromise.then(()=>{let o=[],a=e.length===0;e=e.toUpperCase();for(let l of this._symbolsList){let d=this._symbolsInfo[l];if(d===void 0||s.length>0&&d.type!==s||t&&t.length>0&&d.exchange!==t)continue;let c=d.name.toUpperCase().indexOf(e),h=d.description.toUpperCase().indexOf(e);if((a||c>=0||h>=0)&&!o.some(p=>p.symbolInfo===d)){let p=c>=0?c:8e3+h;o.push({symbolInfo:d,weight:p})}}let n=o.sort((l,d)=>l.weight-d.weight).slice(0,r).map(l=>{let d=l.symbolInfo;return{symbol:d.name,full_name:`${d.exchange}:${d.name}`,description:d.description,exchange:d.exchange,params:[],type:d.type,ticker:d.name}});return Promise.resolve(n)})}_init(){let e=[],t={};for(let s of this._exchangesList)t[s]||(t[s]=!0,e.push(this._requestExchangeData(s)));return Promise.all(e).then(()=>{this._symbolsList.sort()})}_requestExchangeData(e){return new Promise((t,s)=>{this._requester.sendRequest(this._datafeedUrl,"symbol_info",{group:e}).then(r=>{try{this._onExchangeDataReceived(e,r)}catch(o){s(o instanceof Error?o:new Error(`SymbolsStorage: Unexpected exception ${o}`));return}t()}).catch(r=>{`${e}${pt(r)}`,t()})})}_onExchangeDataReceived(e,t){let s=0;try{let r=t.symbol.length,o=t.ticker!==void 0;for(;s<r;++s){let a=t.symbol[s],n=A(t,"exchange-listed",s),l=A(t,"exchange-traded",s),d=l+":"+a,c=A(t,"currency-code",s),h=A(t,"unit-id",s),p=o?A(t,"ticker",s):a,g={ticker:p,name:a,base_name:[n+":"+a],listed_exchange:n,exchange:l,currency_code:c,original_currency_code:A(t,"original-currency-code",s),unit_id:h,original_unit_id:A(t,"original-unit-id",s),unit_conversion_types:A(t,"unit-conversion-types",s,!0),description:A(t,"description",s),has_intraday:Ie(A(t,"has-intraday",s),!1),visible_plots_set:Ie(A(t,"visible-plots-set",s),"ohlcv"),minmov:A(t,"minmovement",s)||A(t,"minmov",s)||0,minmove2:A(t,"minmove2",s)||A(t,"minmov2",s),fractional:A(t,"fractional",s),pricescale:A(t,"pricescale",s),type:A(t,"type",s),session:A(t,"session-regular",s),session_holidays:A(t,"session-holidays",s),corrections:A(t,"corrections",s),timezone:A(t,"timezone",s),supported_resolutions:Ie(A(t,"supported-resolutions",s,!0),this._datafeedSupportedResolutions),has_daily:Ie(A(t,"has-daily",s),!0),intraday_multipliers:Ie(A(t,"intraday-multipliers",s,!0),["1","5","15","30","60"]),has_weekly_and_monthly:A(t,"has-weekly-and-monthly",s),has_empty_bars:A(t,"has-empty-bars",s),volume_precision:Ie(A(t,"volume-precision",s),0),format:"price"};this._symbolsInfo[p]=g,this._symbolsInfo[a]=g,this._symbolsInfo[d]=g,(c!==void 0||h!==void 0)&&(this._symbolsInfo[ct(p,c,h)]=g,this._symbolsInfo[ct(a,c,h)]=g,this._symbolsInfo[ct(d,c,h)]=g),this._symbolsList.push(a)}}catch(r){throw new Error(`SymbolsStorage: API error when processing exchange ${e} symbol #${s} (${t.symbol[s]}): ${Object(r).message}`)}}};function Ie(e,t){return e!==void 0?e:t}var aa=class{constructor(e){this._configuration=ci(),this._symbolsStorage=null,this._datafeedURL=e,this._requester=new ra,this._historyProvider=new sa(e,this._requester),this._configurationReadyPromise=this._requestConfiguration().then(t=>{t===null&&(t=ci()),this._setupWithConfiguration(t)})}getBars(e,t,s,r,o){this._historyProvider.getBars(e,t,s).then(a=>{r(a.bars,a.meta)}).catch(o)}onReady(e){this._configurationReadyPromise.then(()=>{e(this._configuration)})}searchSymbols(e,t,s,r){if(this._symbolsStorage===null)throw new Error("Datafeed: inconsistent configuration (symbols storage)");this._symbolsStorage.searchSymbols(e,t,s,30).then(r).catch(r.bind(null,[]))}resolveSymbol(e,t,s,r){let o=r&&r.currencyCode,a=r&&r.unitId;function n(l){t(l)}if(this._symbolsStorage===null)throw new Error("Datafeed: inconsistent configuration (symbols storage)");this._symbolsStorage.resolveSymbol(e,o,a).then(n).catch(s)}getMarks(){}getTimescaleMarks(){}getServerTime(){}_requestConfiguration(){return this._send("config").catch(e=>(`${pt(e)}`,null))}_send(e,t){return this._requester.sendRequest(this._datafeedURL,e,t)}_setupWithConfiguration(e){if(this._configuration=e,e.exchanges===void 0&&(e.exchanges=[]),!e.supports_search&&!e.supports_group_request)throw new Error("Unsupported datafeed configuration. Must either support search, or support group request");(e.supports_group_request||!e.supports_search)&&(this._symbolsStorage=new oa(this._datafeedURL,e.supported_resolutions||[],this._requester)),`${JSON.stringify(e)}`}};function ci(){return{supports_search:!1,supports_group_request:!0,supported_resolutions:["1","3","5","15","30","60","120","240","480","720","1D","3D","1W","1M"],supports_marks:!1,supports_timescale_marks:!1}}var na=class{constructor(){this.subscribers=new Map}subscribe(e,t){return this.subscribers.has(e)||this.subscribers.set(e,[]),this.subscribers.get(e).push(t),()=>{this.unsubscribe(e,t)}}unsubscribe(e,t){if(this.subscribers.has(e)){let s=this.subscribers.get(e);this.subscribers.set(e,s.filter(r=>r!==t)),this.subscribers.get(e).length===0&&this.subscribers.delete(e)}}publish(e,t){this.subscribers.has(e)&&this.subscribers.get(e).forEach(s=>{s(t)})}},hi=e=>{let t="1d";switch(e){case"1":t="1m";break;case"3":t="3m";break;case"5":t="5m";break;case"15":t="15m";break;case"30":t="30m";break;case"60":t="1h";break;case"120":t="2h";break;case"240":t="4h";break;case"480":t="8h";break;case"720":t="12h";break;case"D":case"1D":t="1d";break;case"3D":t="3d";break;case"1W":t="1w";break;case"1M":t="1M ";break}return t},Ee={interval:"TradingviewSDK.lastUsedTimeBasedResolution",lineType:"TradingviewSDK.lastUsedStyle",displayControlSetting:"TradingviewSDK.displaySetting"},wt=(e,t)=>`${e}kline_${t}`,la=e=>["trade"].map(t=>`${e}@${t}`),At=class Je{constructor(t){return this.klineSubscribeIdMap=new Map,this.klineOnTickCallback=new Map,this.subscribeCachedTopics=new Map,this.wsInstance=null,this.klineData=new Map,Je._created||(this.wsInstance=t,Je._instance=this,Je._created=!0),Je._instance}subscribeKline(t,s,r,o){var l;let a=hi(r);this.klineSubscribeIdMap.set(t,{symbol:s,resolution:r});let n=wt(s,a);if(this.klineOnTickCallback.has(n)){let d=this.klineOnTickCallback.get(n);d[t]=o}else{this.klineOnTickCallback.set(n,{[t]:o});let d=(l=this.wsInstance)==null?void 0:l.subscribe({event:"subscribe",topic:`${s}@kline_${a}`,id:`${s}@kline_${a}`,ts:new Date().getTime()},{onMessage:c=>{let{open:h,close:p,high:g,low:y,volume:f,startTime:C}=c,j=wt(c.symbol,c.type);this.updateKline(j,{time:C,close:p,open:h,high:g,low:y,volume:f})}});this.subscribeCachedTopics.set(`${s}@kline_${a}`,d)}}unsubscribeKline(t){if(!this.klineSubscribeIdMap.has(t))return;let{symbol:s,resolution:r}=this.klineSubscribeIdMap.get(t),o=hi(r),a=wt(s,o);if(this.klineOnTickCallback.has(a)){let n=this.klineOnTickCallback.get(a);delete n[t],Object.keys(n).length===0&&(this.klineOnTickCallback.delete(a),this.subscribeCachedTopics.get(`${s}@kline_${o}`)())}delete this.klineSubscribeIdMap[t]}subscribeSymbol(t){la(t).forEach(s=>{var r;if(!this.subscribeCachedTopics.has(s)){let o=(r=this.wsInstance)==null?void 0:r.subscribe({event:"subscribe",topic:s,id:s,ts:new Date().getTime()},{onMessage:a=>{this.updateKlineByLastPrice(a.symbol,a.price)}});this.subscribeCachedTopics.set(s,o)}})}updateKlineByLastPrice(t,s){this.klineOnTickCallback.forEach((r,o)=>{if(o.startsWith(t)){let a=this.klineData.get(o);a&&this.updateKline(o,{...a,close:s})}})}updateKline(t,s){let r=this.klineOnTickCallback.get(t);r&&s&&(this.klineData.set(t,s),Object.keys(r).forEach(o=>{let a=r[o];a&&typeof a=="function"&&a(s)}))}};At._created=!1,At._instance=null;var is=At,ua=(()=>{let e=0;return()=>e++})(),da=class extends aa{constructor(e,t){let s=`${e}/tv`;super(s),this.bbosMap=new Map,this.tickersMap=new Map,this.eventBus=new na,this._subscribeQuoteMap=new Map,this._prefixId=ua(),this._publicWs=new is(t),this.bbosMap=new Map,t.on("tickers",r=>{for(let o of r.data)o.change=o.close-o.open,o.perChange=o.open?+(100*o.change/o.open).toFixed(2):0,this.tickersMap.set(o.symbol,o);this.eventBus.publish("tickerUpdate",{message:"ticker"})}),t.subscribe({event:"subscribe",topic:"bbos"},{formatter:r=>r,onMessage:r=>{for(let o of r.data)this.bbosMap.set(o.symbol,{ask:o.ask,bid:o.bid,askSize:o.askSize,bidSize:o.bidSize});this.eventBus.publish("tickerUpdate",{message:"bbos"})}})}remove(){Array.from(this._subscribeQuoteMap.values()).forEach(e=>e==null?void 0:e())}getSubscriptionId(e){return`${this._prefixId}${e}`}subscribeBars(e,t,s,r){this._publicWs.subscribeKline(`${this._prefixId}${r}`,e.ticker,t,s)}unsubscribeBars(e){this._publicWs.unsubscribeKline(`${this._prefixId}${e}`)}getQuotes(e,t){let s=this.getSubscriptionId("getQuotes");this.unsubscribeQuotes("getQuotes");let r=this.eventBus.subscribe("tickerUpdate",o=>{let a=new Map;e.forEach(n=>{let l=this.bbosMap.get(be(n)),d=this.tickersMap.get(be(n));if(!l||!d)return;let c={...d,ask:l.ask,bid:l.bid};a.set(be(n),c)}),a.size&&t(Array.from(a.values()).map(n=>this._toUDFTicker(n)))});this._subscribeQuoteMap.set(s,r)}subscribeQuotes(e,t,s,r){let o=`${this._prefixId}${r}`;if(e.length>0){this.unsubscribeQuotes(o);let a=this.eventBus.subscribe("tickerUpdate",n=>{let l=new Map;e.forEach(d=>{let c=this.bbosMap.get(be(d)),h=this.tickersMap.get(be(d));if(!c||!h)return;let p={...h,ask:c.ask,bid:c.bid};l.set(be(d),p)}),l.size&&s(Array.from(l.values()).map(d=>this._toUDFTicker(d)))});this._subscribeQuoteMap.set(o,a)}}unsubscribeQuotes(e){let t=this.getSubscriptionId(e),s=this._subscribeQuoteMap.get(t);s&&(s(),this._subscribeQuoteMap.delete(t))}_toUDFTicker(e){return{n:Qi(e.symbol),s:"ok",v:{ask:e.ask,bid:e.bid,ch:e.change,chp:e.perChange/100,description:"",exchange:Et,hight_price:e.high,low_price:e.low,lp:e.close,open_price:e.open,prev_close_price:0,volume:e.volume}}}},ca=(e,t)=>new Promise(s=>{let r=e.querySelector(t);r&&s(r);let o=new MutationObserver(()=>{let a=e.querySelector(t);a&&(s(a),o.disconnect())});o.observe(e,{childList:!0,subtree:!0})}),ha=class{constructor({iframeDocument:e}){this.iframeDocument=e}defaultHack(){this.showFavoriteStarByDefault()}showFavoriteStarByDefault(){ca(this.iframeDocument,".dropdown-2R6OKuTS").then(()=>{this.iframeDocument.querySelectorAll(".toolbox-2IihgTnv.showOnHover-2IihgTnv").forEach(e=>{e.style.opacity="1"})})}},ma=e=>{let t=["header_symbol_search","volume_force_overlay","trading_account_manager","drawing_templates","open_account_manager","right_toolbar","support_multicharts","header_layouttoggle","order_panel","order_info","trading_notifications","display_market_status","broker_button","add_to_watchlist","chart_crosshair_menu","header_fullscreen_button","header_widget"];return e===3&&(t=[...t,"left_toolbar","timeframes_toolbar","go_to_date","timezone_menu","create_volume_indicator_by_default","buy_sell_buttons"]),e===0?t=[...t,"header_widget","left_toolbar","timeframes_toolbar","buy_sell_buttons"]:e===1&&(t=[...t,"left_toolbar","timeframes_toolbar","buy_sell_buttons"]),t};function pa(e,t){return{...e,disabled_features:ma(t),enabled_features:["hide_left_toolbar_by_default","order_panel_close_button","iframe_loading_compatibility_mode"],auto_save_delay:.1,broker_config:{configFlags:{supportStopLimitOrders:!0,supportReversePosition:!1}}}}var Yt=e=>`${e}_adapter`,zt={"trading.chart.proterty":JSON.stringify({showSellBuyButtons:0,noConfirmEnabled:1,qweqrq:0,showPricesWithZeroVolume:1,showSpread:1,orderExecutedSoundParams:'{"enabled":0,"name":"alert/alarm_clock"}'}),"hint.startFocusedZoom":"true"},ve=new Map,ga=(e,t,s)=>{let r=Yt(e);try{let o=t,a=o?JSON.parse(o):void 0,n=s?JSON.parse(s):zt;return o&&ve.set(e,o),s&&ve.set(r,s),{savedData:a,adapterSetting:n}}catch{}return{savedData:void 0,adapterSetting:zt}},xa=async(e,t)=>{let s=Yt(e),r=localStorage.getItem(e)||"",o=localStorage.getItem(s)||"";try{if(ve.has(e)&&ve.has(s))return{savedData:JSON.parse(ve.get(e)),adapterSetting:JSON.parse(ve.get(s))}}catch{}return ga(e,r,o)},ba=async(e,t,s)=>{t&&(localStorage.setItem(e,t),ve.set(e,t))},fa=async(e,t,s)=>{let r=Yt(e);t&&(localStorage.setItem(r,t),ve.set(r,t))},mi=(e,t)=>{let s=null,r=(...o)=>{s&&window.clearTimeout(s),s=setTimeout(()=>{e(...o)},t)};return r.cancel=()=>{s&&window.clearTimeout(s),s=null},r},ya="chartProp_default",pi=300,va=class{constructor(t){this._instance=null,this._onClick=null,this._datafeed=null,this._chartKey=ya,this._adapterSetting=zt,this._savedData=null,this._isLoggedIn=!1,this.debounceSaveChart=mi(()=>{var s;try{(s=this._instance)==null||s.save(r=>{Object.is(this._savedData,r)||(this._savedData=r,ba(this._chartKey,JSON.stringify(r),this._isLoggedIn))})}catch{}},pi*2),this.debounceSaveChartAdapterSetting=mi(()=>{fa(this._chartKey,JSON.stringify(this._adapterSetting),this._isLoggedIn)},pi),this._create(t)}remove(){var t,s,r;this.unsubscribeClick(),(t=this._datafeed)==null||t.remove(),(s=this._broker)==null||s.remove(),(r=this._instance)==null||r.remove(),this.debounceSaveChart.cancel(),this.debounceSaveChartAdapterSetting.cancel()}updateOverrides(t){this.instance&&this.instance.applyOverrides(t)}setSymbol(t,s,r){var o;try{(o=this._instance)==null||o.onChartReady(()=>{var n,l,d;let a=s??((l=(n=this._instance)==null?void 0:n.symbolInterval())==null?void 0:l.interval);a||(a=1),(d=this._instance)==null||d.setSymbol(t,a,r)})}catch{}}executeActionById(t){var s;try{(s=this._instance)==null||s.onChartReady(()=>{var r;(r=this._instance)==null||r.activeChart().executeActionById(t)})}catch{}}changeLineType(t){var s;try{(s=this._instance)==null||s.onChartReady(()=>{var r;(r=this._instance)==null||r.activeChart().setChartType(t)})}catch{}}subscribeClick(t){var s;this._onClick=t,(s=this._instance)==null||s.onChartReady(()=>{var r,o;(o=(r=this._instance)==null?void 0:r._iFrame.contentDocument)==null||o.addEventListener("click",this._onClick)})}unsubscribeClick(){var t,s;(s=(t=this._instance)==null?void 0:t._iFrame.contentDocument)==null||s.removeEventListener("click",this._onClick)}get instance(){return this._instance}chartHack(){var t;(t=this._instance)==null||t.onChartReady(()=>{let s=this._instance._iFrame.contentWindow.document;new ha({iframeDocument:s}).defaultHack()})}subscribeAutoSave(){var t;(t=this._instance)==null||t.onChartReady(()=>{var s,r;(s=this._instance)==null||s.subscribe("onAutoSaveNeeded",()=>{this.debounceSaveChart()}),(r=this._instance)==null||r.activeChart().onVisibleRangeChanged().subscribe(null,()=>{this.debounceSaveChart()})})}async _create({options:t,chartKey:s,mode:r,onClick:o}){let a=t.getBroker,n={fullscreen:t.fullscreen??!0,autosize:t.autosize??!1,timezone:t.timezone,symbol:t.symbol,library_path:t.libraryPath,interval:t.interval??"1",custom_css_url:t.customCssUrl,custom_font_family:t.customFontFamily,datafeed:t.datafeed,studies_overrides:t.studiesOverrides,locale:t.locale,theme:t.theme,loading_screen:t.loadingScreen,overrides:t.overrides,container:t.container,favorites:{intervals:["1","3","5","15","30","60","240","1D","1W","1M"],chartTypes:["Area","Line"]},broker_factory:a?c=>(this._broker&&this._broker.remove(),this._broker=a(this._instance,c),this._broker):void 0};this._datafeed=t.datafeed,s&&(this._chartKey=s);let{savedData:l,adapterSetting:d}=await xa(this._chartKey,this._isLoggedIn);this._adapterSetting=d,this._savedData=l,this._instance=new TradingView.widget({...pa(n,r),interval:d["chart.lastUsedTimeBasedResolution"]??n.interval,saved_data:l,settings_adapter:{initialSettings:d,setValue:(c,h)=>{this._adapterSetting={...this._adapterSetting,[c]:h},this.debounceSaveChartAdapterSetting()},removeValue:()=>{}}}),this._instance.onChartReady(()=>{var c;t.symbol&&((c=this._instance)==null?void 0:c.activeChart().symbol())!==be(t.symbol)&&this.setSymbol(t.symbol)}),this.subscribeAutoSave(),this.subscribeClick(o),this.chartHack()}};function Ca(e){e.setBrokerConnectionAdapter=function(t){let s={subscribe:()=>{},unsubscribe:()=>{},unsubscribeAll:()=>{}};Object.defineProperty(t,"_ordersCache",{get:function(){return{start:()=>{},stop:()=>{},update:()=>{},partialUpdate:()=>{},fullUpdate:()=>{},getObjects:async()=>[],updateDelegate:s,partialUpdateDelegate:s}},set:()=>{}}),t._waitForOrderModification=async()=>!0,this._adapter=t}}function ja(e,t){e.onChartReady(()=>{t.silentOrdersPlacement().subscribe(s=>{var r;s||(t.silentOrdersPlacement().setValue(!0),e&&(e._iFrame.contentDocument.querySelector(".wrapper-3X2QgaDd").className="wrapper-3X2QgaDd highButtons-3X2QgaDd"),(r=t.sellBuyButtonsVisibility())==null||r.setValue(!1))})})}function wa(e,t){Ca(t),ja(e,t)}var _a=(e,t)=>{let s,r=o=>[null,"limit","MARKET","STOP_MARKET","STOP_LIMIT"][o];return{symbolInfo:async o=>(s=t.getSymbolInfo(be(o)),{qty:{min:(s==null?void 0:s.baseMin)??0,max:(s==null?void 0:s.baseMax)??0,step:(s==null?void 0:s.baseTick)??0},pipValue:0,pipSize:(s==null?void 0:s.quoteTick)??0,minTick:(s==null?void 0:s.quoteTick)??0,description:""}),placeOrder:async o=>{let a=["SELL","BUY"][+(o.side>0)],n=o.qty.toString();(o.limitPrice??0).toString(),(o.stopPrice??0).toString();let l=be(o.symbol);r(o.type)==="MARKET"&&t.sendMarketOrder({side:a,order_quantity:n,symbol:l,order_type:N.MARKET})},orders:()=>[],positions:()=>[],executions:()=>[],connectionStatus:()=>1,chartContextMenuActions:o=>e.defaultContextMenuActions(o),isTradable:async()=>!0,accountManagerInfo:()=>({}),currentAccount:()=>"1",accountsMetainfo:async()=>[{id:"1"}],remove:()=>e==null?void 0:e.silentOrdersPlacement().unsubscribe()}},Sa=_a,Na="SDK_Tradingview",ka="SDK_Moblie_Tradingview",Pa=e=>e?ka:Na,Ta=e=>e==="id"?"id_ID":e;function Oa(e){let{scriptSRC:t,libraryPath:s,customCssUrl:r,overrides:o,studiesOverrides:a,fullscreen:n,symbol:l,theme:d,loadingScreen:c,mode:h,colorConfig:p,locale:g=Ta}=e,y=Is(),f=u.useRef(),C=ft("apiBaseUrl"),{state:j}=ue(),[_,P]=u.useState(H.SELL),k=He(),{onSubmit:v,submitting:S}=_i({symbol:l??"",side:_,order_type:N.MARKET},{watchOrderbook:!0}),[T,I]=u.useState(()=>{let D=localStorage.getItem(Ee.displayControlSetting);return D?JSON.parse(D):{position:!0,buySell:!0,limitOrders:!0,stopOrders:!0,tpsl:!0,positionTpsl:!0}}),[z,Z]=u.useState(()=>localStorage.getItem(Ee.interval)||"1"),[K,R]=u.useState(()=>localStorage.getItem(Ee.lineType)||"1"),$=Pe(yt),U=u.useMemo(()=>Object.assign({},Io,p??{}),[p]),E=u.useMemo(()=>typeof c=="object"?c:{backgroundColor:Wi},[c]),G=Es(),[ae,Ue]=u.useState(!1),We=D=>{let ge=k[l];if(!ge)return;let Me=new L(D.balance).greaterThan(0)?H.SELL:H.BUY,X={order_quantity:new L(D.balance).abs().toNumber(),symbol:l,order_type:N.MARKET,side:Me,reduce_only:!0};P(Me),ee.show("MarketCloseConfirmID",{base:ge("base"),quantity:D.balance,onConfirm:async()=>v(X).catch(_e=>{typeof _e=="string"?W.error(_e):W.error(_e.message)}),submitting:S})},ne=u.useRef(null),de=u.useMemo(()=>!(j.status<F.EnableTrading&&j.status!==F.EnableTradingWithoutConnected),[j]),we=Yo({closeConfirm:We,colorConfig:U,onToast:W,symbol:l??"",mode:h}),[Qe,O]=ia(l,T),V=D=>{f.current&&(localStorage.setItem(Ee.interval,D),Z(D),f.current.setSymbol(l,D))},oe=D=>{f.current&&(localStorage.setItem(Ee.lineType,D),R(D),f.current.changeLineType(Number(D)))},Y=D=>{localStorage.setItem(Ee.displayControlSetting,JSON.stringify(D)),I(D)},ie=()=>{f.current&&f.current.executeActionById("chartProperties")},Le=()=>{f.current&&f.current.executeActionById("insertIndicator")};return u.useEffect(()=>{if(t&&ne.current&&!ae){let D=document.createElement("script");D.setAttribute("data-nscript","afterInteractive"),D.src=t,D.async=!0,D.type="text/javascript",D.onload=()=>{Ue(!0)},D.onerror=()=>{},ne.current.appendChild(D)}},[ne,ae,t]),u.useEffect(()=>{if(!l||!ae||!t)return;let D=Eo(U,$),ge=o?Object.assign({},D.overrides,o):D.overrides,Me=a?Object.assign({},D.studiesOverrides,a):D.studiesOverrides;if(ne.current){let X={options:{fullscreen:n??!1,autosize:!0,symbol:Qi(l),locale:typeof g=="function"?g(y):g,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,container:ne.current,libraryPath:s,customCssUrl:r,interval:z??"1",theme:d??"dark",loadingScreen:E??{},overrides:ge,studiesOverrides:Me,datafeed:new da(C,G),contextMenu:{items_processor:async _e=>_e},getBroker:(_e,Jt)=>(wa(_e,Jt),Sa(Jt,we))},chartKey:Pa($),mode:h,onClick:()=>{}};f.current=new va(X)}return()=>{var X;(X=f.current)==null||X.remove()}},[ae,$,h,f,ne,ae,t,U,g,y]),u.useEffect(()=>(f.current&&f.current.instance&&f.current.instance.onChartReady(()=>{de&&f.current.instance&&Qe(f.current.instance,void 0,we)}),()=>{O()}),[f.current,de]),u.useEffect(()=>{var ge;if(!l||!f.current)return;(ge=f.current)==null||ge.setSymbol(l);let D=new is(G);return D.subscribeSymbol(l),()=>{D.unsubscribeKline(l)}},[l]),{tradingViewScriptSrc:t,chartRef:ne,changeDisplaySetting:Y,displayControlState:T,interval:z,changeInterval:V,lineType:K,changeLineType:oe,openChartSetting:ie,openChartIndicators:Le,symbol:l}}function ss(e){let t=Oa(e);return i.jsx(_o,{...t})}var La=e=>{let{isMobile:t}=st();return t?i.jsx(Ma,{...e}):i.jsx(Ia,{...e})},Ma=e=>{let{t}=w();return i.jsxs(m,{direction:"column",gap:2,width:"100%",itemAlign:"start",p:2,className:"oui-bg-base-9 oui-rounded-b-xl",children:[i.jsxs(m,{width:"100%",justify:"between",children:[i.jsx(rs,{classNames:{label:"oui-text-2xs oui-text-base-contrast-54",root:"oui-text-sm"},...e}),i.jsx(os,{classNames:{label:"oui-text-2xs oui-text-base-contrast-54",root:"oui-text-sm"},...e})]}),i.jsx(te,{className:"oui-w-full"}),i.jsxs(m,{className:"oui-gap-[2px] oui-cursor-pointer",children:[i.jsx(fe,{id:"oui-checkbox-hideOtherSymbols",color:"white",checked:!e.showAllSymbol,onCheckedChange:s=>{e.setShowAllSymbol(!s)}}),i.jsx("label",{className:"oui-text-2xs oui-text-base-contrast-54 oui-cursor-pointer",htmlFor:"oui-checkbox-hideOtherSymbols",children:t("trading.hideOtherSymbols")})]})]})},Ia=e=>i.jsxs(m,{py:2,px:3,gap:6,width:"100%",justify:"start",children:[i.jsx(rs,{...e,classNames:{label:"oui-text-base-contrast-54"}}),i.jsx(os,{...e,classNames:{label:"oui-text-base-contrast-54"}})]}),rs=e=>{let{t}=w(),s=typeof e.unrealPnL=="number"?e.unrealPnL>=0?"oui-text-trade-profit":"oui-text-trade-loss":"oui-text-base-contrast-80",r=typeof e.unrealPnL=="number"&&e.unrealPnlROI?e.unrealPnlROI>=0?"oui-text-success-darken":"oui-text-danger-darken":"oui-text-base-contrast-80";return i.jsx(Be,{label:t("common.unrealizedPnl"),classNames:e.classNames,children:i.jsxs(m,{gap:1,children:[i.jsx(x.numeral,{dp:e.pnlNotionalDecimalPrecision,rm:L.ROUND_DOWN,intensity:80,className:s,children:e.unrealPnL??"--"}),typeof e.unrealPnlROI<"u"&&i.jsx(x.numeral,{prefix:"(",suffix:")",rule:"percentages",size:"2xs",dp:e.pnlNotionalDecimalPrecision,rm:L.ROUND_DOWN,className:r,children:e.unrealPnlROI})]})})},os=e=>{let{t}=w();return i.jsx(Be,{label:t("common.notional"),classNames:e.classNames,children:i.jsx(x.numeral,{dp:e.pnlNotionalDecimalPrecision,rm:L.ROUND_DOWN,intensity:80,children:e.notional??"--"})})},Te=e=>{let[t,s]=B("unPnlPriceBasis","markPrice"),[r,o]=B("pnlNotionalDecimalPrecision",(e==null?void 0:e.pnlNotionalDecimalPrecision)??2),[a,n]=B("showAllSymbol",!0),[l,d]=B("hideAssets",!1);return{unPnlPriceBasis:t,setUnPnlPriceBasic:s,pnlNotionalDecimalPrecision:r,setPnlNotionalDecimalPrecision:o,showAllSymbol:a,setShowAllSymbol:n,hideAssets:l,setHideAssets:d}},Ea=e=>{let{pnlNotionalDecimalPrecision:t,unPnlPriceBasis:s,symbol:r}=e,o=s,[a]=rt(r,{calcMode:o}),n=le(a.aggregated),l=n==null?void 0:n.total_unreal_pnl,d=n==null?void 0:n.unrealPnlROI,c=n==null?void 0:n.notional,{showAllSymbol:h,setShowAllSymbol:p}=Te();return{pnlNotionalDecimalPrecision:t,unrealPnL:l,unrealPnlROI:d,notional:c,showAllSymbol:h,setShowAllSymbol:p}},as=e=>{let t=Ea(e);return i.jsx(La,{...t})},ns=e=>{var o;let{showAllSymbol:t}=Te(),[s]=rt(t?void 0:e),r=u.useMemo(()=>{var a;return(a=s.rows)==null?void 0:a.length},[(o=s.rows)==null?void 0:o.length]);return{positionCount:le(r)??0}},ls=e=>{let{showAllSymbol:t}=Te();`${re.pending}`,`${re.tp_sl}`;let[s,{total:r}]=Ce({symbol:t?void 0:e,status:se.INCOMPLETE,excludes:[ut.POSITIONAL_TP_SL,ut.TP_SL],size:500},{keeplive:!0}),[o,{total:a}]=Ce({symbol:t?void 0:e,status:se.INCOMPLETE,includes:[ut.POSITIONAL_TP_SL,ut.TP_SL],size:500},{keeplive:!0}),n=le(r)??0,l=le(a)??0;return{pendingOrderCount:n,tpSlOrderCount:l}},$t=e=>({base_dp:e("base_dp"),quote_dp:e("quote_dp"),base_tick:e("base_tick"),base:e("base"),quote:e("quote")}),us=u.createContext({}),je=()=>u.useContext(us),Da=e=>{let t=He()[e.symbol];return i.jsx(us.Provider,{value:{...e,symbolInfo:{...$t(t),symbol:e.symbol}},children:e.children})},Ra=e=>{let{current:t,pnlNotionalDecimalPrecision:s,sharePnLConfig:r,symbol:o,includedPendingOrder:a}=e,n=Te({pnlNotionalDecimalPrecision:s}),{onSymbolChange:l}=je(),{positionCount:d}=ns(e.symbol),{pendingOrderCount:c,tpSlOrderCount:h}=ls(e.symbol);return{current:t,sharePnLConfig:r,symbol:o,calcMode:n.unPnlPriceBasis,includedPendingOrder:a,...n,positionCount:d,pendingOrderCount:c,tpSlOrderCount:h,onSymbolChange:l}},Aa=e=>{let[t,s]=u.useState(!1),{t:r}=w();return i.jsxs(m,{gap:0,children:[i.jsxs(m,{gap:1,children:[i.jsx(fe,{id:"oui-checkbox-hideOtherSymbols",color:"white",checked:e.hideOtherSymbols,onCheckedChange:o=>{e.setHideOtherSymbols(o)}}),i.jsx("label",{className:"oui-text-xs oui-text-base-contrast-54 oui-cursor-pointer",htmlFor:"oui-checkbox-hideOtherSymbols",children:r("trading.hideOtherSymbols")})]}),i.jsxs(Ve,{open:t,onOpenChange:s,children:[i.jsx(qe,{asChild:!0,children:i.jsx(J,{size:"xs",type:"button",variant:"contained",className:"oui-bg-transparent hover:oui-bg-transparent",children:i.jsx(Zs,{size:16,color:"white",opacity:1,className:"oui-text-white/[.36] hover:oui-text-white/80"})})}),i.jsx(Fe,{className:"oui-px-5 oui-py-3 oui-w-[360px]",alignOffset:2,align:"end",children:i.jsxs("div",{className:"oui-flex oui-flex-col oui-text-sm",children:[i.jsx(x,{className:"oui-text-base oui-pb-3",children:r("trading.portfolioSettings")}),i.jsx(te,{}),i.jsx(x,{className:"oui-pb-3 oui-text-base-contrast-54 oui-mt-2",children:r("trading.portfolioSettings.decimalPrecision")}),i.jsx($a,{value:e.pnlNotionalDecimalPrecision,onValueChange:o=>{e.setPnlNotionalDecimalPrecision(o),s(!1)}}),i.jsx(te,{className:"oui-my-3"}),i.jsx(x,{className:"oui-pb-3 oui-text-base-contrast-54 oui-mt-2",children:r("trading.portfolioSettings.unrealPnlPriceBasis")}),i.jsx(za,{value:e.unPnlPriceBasis,onValueChange:o=>{e.setUnPnlPriceBasic(o),s(!1)}})]})})]})]})},za=e=>{let{value:t,onValueChange:s}=e,{t:r}=w();return i.jsxs(m,{gap:2,children:[i.jsx(it,{sel:t==="markPrice",label:r("common.markPrice"),value:"markPrice",onCheckChange:s}),i.jsx(it,{sel:t==="lastPrice",label:r("common.lastPrice"),value:"lastPrice",onCheckChange:s})]})},$a=e=>{let{value:t,onValueChange:s}=e;return i.jsxs(m,{gap:2,children:[i.jsx(it,{sel:t===0,label:1,value:0,onCheckChange:s}),i.jsx(it,{sel:t===1,label:.1,value:1,onCheckChange:s}),i.jsx(it,{sel:t===2,label:.01,value:2,onCheckChange:s})]})},it=e=>{let{sel:t,label:s,value:r,onCheckChange:o}=e;return i.jsxs(m,{onClick:a=>{o(r),a.stopPropagation()},gap:1,className:"oui-cursor-pointer",children:[t?i.jsx(Ba,{}):i.jsx(Ha,{}),i.jsx(x,{size:"2xs",intensity:t?98:54,children:s})]})},Ba=()=>i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"oui-fill-white",children:[i.jsx("path",{d:"M8.01 1.333a6.667 6.667 0 1 0 0 13.333 6.667 6.667 0 0 0 0-13.333m0 1.333a5.334 5.334 0 1 1-.001 10.667 5.334 5.334 0 0 1 0-10.667",fill:"#fff",fillOpacity:".36"}),i.jsx("circle",{cx:"8",cy:"8",r:"3.333"})]}),Ha=()=>i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M8.01 1.333a6.667 6.667 0 1 0 0 13.333 6.667 6.667 0 0 0 0-13.333m0 1.333a5.334 5.334 0 1 1-.001 10.667 5.334 5.334 0 0 1 0-10.667",fill:"#fff",fillOpacity:".54"})}),Va=e=>({...e}),qa=e=>{let t=Va(e);return i.jsx(Aa,{...t})},Fa=e=>{let{t}=w();return i.jsxs(nt,{defaultValue:e.current||"Positions",variant:"contained",trailing:i.jsx(qa,{pnlNotionalDecimalPrecision:e.pnlNotionalDecimalPrecision,setPnlNotionalDecimalPrecision:e.setPnlNotionalDecimalPrecision,unPnlPriceBasis:e.unPnlPriceBasis,setUnPnlPriceBasic:e.setUnPnlPriceBasic,hideOtherSymbols:!e.showAllSymbol,setHideOtherSymbols:s=>e.setShowAllSymbol(!s)}),size:"lg",className:"oui-h-full",classNames:{tabsContent:"oui-h-[calc(100%_-_32px)]"},children:[i.jsx(Q,{testid:"oui-testid-dataList-position-tab",value:"Positions",title:`${t("common.positions")} ${(e.positionCount??0)>0?`(${e.positionCount})`:""}`,children:i.jsx(Ua,{...e})}),i.jsx(Q,{testid:"oui-testid-dataList-pending-tab",value:"Pending",title:`${t("orders.status.pending")} ${(e.pendingOrderCount??0)>0?`(${e.pendingOrderCount})`:""}`,children:i.jsx(dt,{type:re.pending,ordersStatus:se.INCOMPLETE,symbol:e.showAllSymbol?void 0:e.symbol,onSymbolChange:e.onSymbolChange,testIds:{tableBody:"oui-testid-dataList-pending-table-body"}})}),i.jsx(Q,{testid:"oui-testid-dataList-tpsl-tab",value:"TP/SL",title:`${t("common.tpsl")} ${(e.tpSlOrderCount??0)>0?`(${e.tpSlOrderCount})`:""}`,children:i.jsx(dt,{type:re.tp_sl,ordersStatus:se.INCOMPLETE,symbol:e.showAllSymbol?void 0:e.symbol,onSymbolChange:e.onSymbolChange,testIds:{tableBody:"oui-testid-dataList-tpsl-table-body"}})}),i.jsx(Q,{testid:"oui-testid-dataList-filled-tab",value:"Filled",title:t("orders.status.filled"),children:i.jsx(dt,{type:re.filled,symbol:e.showAllSymbol?void 0:e.symbol,pnlNotionalDecimalPrecision:e.pnlNotionalDecimalPrecision,ordersStatus:se.FILLED,onSymbolChange:e.onSymbolChange,testIds:{tableBody:"oui-testid-dataList-filled-table-body"},sharePnLConfig:e.sharePnLConfig})}),i.jsx(Q,{testid:"oui-testid-dataList-positionHistory-tab",value:"Position history",title:t("positions.positionHistory"),children:i.jsx(fr,{pnlNotionalDecimalPrecision:e.pnlNotionalDecimalPrecision,symbol:e.showAllSymbol?void 0:e.symbol,onSymbolChange:e.onSymbolChange,sharePnLConfig:e.sharePnLConfig})}),i.jsx(Q,{testid:"oui-testid-dataList-orderHistory-tab",value:"Order history",title:t("orders.orderHistory"),children:i.jsx(dt,{type:re.orderHistory,pnlNotionalDecimalPrecision:e.pnlNotionalDecimalPrecision,symbol:e.showAllSymbol?void 0:e.symbol,onSymbolChange:e.onSymbolChange,testIds:{tableBody:"oui-testid-dataList-orderHistory-table-body"},sharePnLConfig:e.sharePnLConfig})}),i.jsx(Q,{testid:"oui-testid-dataList-liquidation-tab",value:"Liquidation",title:t("positions.liquidation"),children:i.jsx(yr,{symbol:e.showAllSymbol?void 0:e.symbol})})]})},Ua=e=>i.jsxs(m,{direction:"column",width:"100%",height:"100%",children:[i.jsx(as,{pnlNotionalDecimalPrecision:e.pnlNotionalDecimalPrecision,symbol:e.showAllSymbol?void 0:e.symbol,unPnlPriceBasis:e.unPnlPriceBasis}),i.jsx(te,{className:"oui-w-full"}),i.jsx(M,{className:"oui-h-[calc(100%_-_60px)]",width:"100%",children:i.jsx(Sr,{symbol:e.showAllSymbol?void 0:e.symbol,pnlNotionalDecimalPrecision:e.pnlNotionalDecimalPrecision,sharePnLConfig:e.sharePnLConfig,calcMode:e.calcMode,includedPendingOrder:e.includedPendingOrder,onSymbolChange:e.onSymbolChange})})]}),Wa=e=>{let t=Ra({...e});return i.jsx(Fa,{...t})},Qa=e=>{var t,s,r,o;return i.jsxs(M,{className:b("oui-grid oui-grid-rows=[auto,1fr] oui-h-full oui-w-full",(t=e.classNames)==null?void 0:t.root),style:e.style,children:[i.jsx(M,{className:"oui-pr-1",children:i.jsx(Ka,{base:e.base,quote:e.quote,className:(s=e.classNames)==null?void 0:s.listHeader})}),i.jsx(Ya,{data:e.data,isLoading:e.isLoading,baseDp:e.baseDp,quoteDp:e.quoteDp,classNames:(r=e.classNames)==null?void 0:r.listItem,className:(o=e.classNames)==null?void 0:o.list})]})},ds=e=>{let{left:t,mid:s,right:r,classNames:o}=e;return i.jsxs(ye,{cols:3,gapX:2,width:"100%",className:b("oui-text-xs oui-tabular-nums",o==null?void 0:o.root),children:[i.jsx("div",{className:b("oui-flex-1",o==null?void 0:o.left),children:t}),i.jsx("div",{className:b("oui-flex-1",o==null?void 0:o.mid),children:s}),i.jsx("div",{className:b("oui-flex-1 oui-text-right",o==null?void 0:o.right),children:r})]})},Ka=e=>{let{t}=w();return i.jsx(ds,{left:t("common.time"),mid:`${t("common.price")}(${e.quote})`,right:`${t("common.qty")}(${e.base})`,classNames:{root:b("oui-text-base-contrast-54 oui-h-[32px] oui-sticky",e.className)}})},Ya=e=>i.jsx(Gs,{dataSource:e.data,className:b("oui-last-trades-list","oui-w-full oui-h-full",e.className,"oui-overflow-auto"),contentClassName:"!oui-space-y-0 oui-pr-[-4px]",renderItem:(t,s)=>{var r,o,a;return i.jsx(ds,{left:i.jsx(x.formatted,{rule:"date",formatString:"HH:mm:ss",children:t==null?void 0:t.ts}),mid:Pt(t==null?void 0:t.price,{fix:e.quoteDp}),right:Pt(t==null?void 0:t.size,{fix:e.baseDp}),classNames:{left:b("oui-text-base-contrast-80",(r=e.classNames)==null?void 0:r.left),right:b(t.side===H.BUY?"oui-text-trade-profit":"oui-text-trade-loss",(o=e.classNames)==null?void 0:o.mid),mid:b(t.side===H.BUY?"oui-text-trade-profit":"oui-text-trade-loss",(a=e.classNames)==null?void 0:a.right)}},s)}}),Za=e=>{var d;let{data:t,isLoading:s}=Xs(e),r=(d=He())==null?void 0:d[e],o=r==null?void 0:r("base"),a=r==null?void 0:r("quote"),n=r==null?void 0:r("base_dp"),l=r==null?void 0:r("quote_dp");return{base:o,quote:a,data:t,isLoading:s,baseDp:n,quoteDp:l}},Zt=e=>{let t=Za(e.symbol);return i.jsx(Qa,{...t,classNames:e.classNames,style:e.style})};function Xa(e){let{t}=w();return e.showFaucet?i.jsx(J,{variant:"outlined",fullWidth:!0,size:"md",onClick:e.getFaucet,loading:e.loading,className:"oui-text-primary-light oui-border-primary-light oui-rounded","data-testid":"oui-testid-assetView-getFaucet-button",children:t("trading.faucet.getTestUSDC")}):null}function Ga(){let{t:e}=w(),{connectedChain:t,namespace:s}=ki(),{state:r,account:o}=ue(),a=ft(),n=a.get("operatorUrl"),[l,{isMutating:d}]=Pi(`${n}/v1/faucet/usdc`),[c,h]=u.useState(!1),p=u.useMemo(()=>!t||!t.id?!1:(r.status===F.EnableTrading||r.status===F.EnableTradingWithoutConnected)&&Ti(parseInt(t.id)),[r,t]);return{getFaucet:()=>{var y;if(c)return;h(!0);let g=e("trading.faucet.getTestUSDC.success",{quantity:s===Oi.solana?"100":"1,000"});return l({chain_id:(y=o.walletAdapter)==null?void 0:y.chainId.toString(),user_address:r.address,broker_id:a.get("brokerId")}).then(f=>{if(h(!1),f.success)return ee.alert({title:e("trading.faucet.getTestUSDC"),message:g,onOk:()=>new Promise(C=>C(!0))});f.message&&W.error(f.message)},f=>{W.error(f.message)})},showFaucet:p,loading:c}}function gi(){let e=Ga();return i.jsx(Xa,{...e})}var Ja=()=>{let{state:e}=ue(),{wrongNetwork:t,disabledConnect:s}=lt(),{t:r}=w();return u.useMemo(()=>{let o={wrongNetwork:{title:r("connector.wrongNetwork"),description:r("connector.wrongNetwork.tooltip"),titleColor:"warning"},connectWallet:{title:r("connector.connectWallet"),description:r("connector.trade.connectWallet.tooltip"),titleClsName:"oui-text-transparent oui-bg-clip-text oui-gradient-brand"},notSignedIn:{title:r("connector.signIn"),description:r("connector.trade.signIn.tooltip"),titleColor:"primary"},disabledTrading:{title:r("connector.enableTrading"),description:r("connector.trade.enableTrading.tooltip"),titleColor:"primary"},default:{title:"",description:""}};if(s)return o.connectWallet;if(t)return o.wrongNetwork;switch(e.status){case F.NotConnected:return o.connectWallet;case F.NotSignedIn:return o.notSignedIn;case F.DisabledTrading:return o.disabledTrading;default:return o.default}},[e.status,t,r])},cs=({description:e,formula:t})=>i.jsxs("div",{className:"oui-leading-[1.5] oui-text-2xs oui-text-base-contrast-80 oui-min-w-[204px] oui-max-w-[240px]",children:[i.jsx("span",{children:e}),i.jsx(te,{className:"oui-border-white/10",my:2}),i.jsx("span",{children:t})]}),en=({totalValue:e,visible:t=!0,onToggleVisibility:s})=>{let{t:r}=w();return i.jsxs(m,{direction:"column",gap:1,className:"oui-text-2xs",itemAlign:"center",children:[i.jsx(x.numeral,{visible:t,weight:"bold",size:"2xl",className:Si({color:"brand"}),as:"div",padding:!1,dp:2,children:e??"--"}),i.jsxs(m,{gap:1,itemAlign:"center",children:[i.jsx(x,{size:"2xs",color:"neutral",weight:"semibold",children:`${r("trading.asset.myAssets")} (USDC)`}),i.jsx("button",{onClick:s,children:t?i.jsx(Ut,{size:18,className:"oui-text-base-contrast-54"}):i.jsx(Wt,{size:18,className:"oui-text-base-contrast-54"})})]})]})},_t=({label:e,description:t,formula:s,visible:r,value:o,unit:a,rule:n,isConnected:l,showPercentage:d=!1,placeholder:c})=>i.jsxs(m,{justify:"between",children:[i.jsx(at,{content:i.jsx(cs,{description:t,formula:s}),children:i.jsx(x,{size:"2xs",color:"neutral",weight:"semibold",className:"oui-cursor-pointer oui-border-b oui-border-dashed oui-border-line-12",children:e})}),i.jsx(x.numeral,{visible:r,size:"2xs",unit:a,unitClassName:"oui-text-base-contrast-36 oui-ml-0.5",as:"div",rule:n,padding:!1,dp:2,placeholder:c,children:o||"--"})]}),tn=({visible:e=!0,freeCollateral:t,marginRatioVal:s,renderMMR:r,isConnected:o})=>{let[a,n]=B("orderly_entry_asset_list_open",!1),[l,d]=u.useState(a),{t:c}=w(),h=u.useCallback(()=>{d(p=>!p),setTimeout(()=>{n(!l)},0)},[]);return i.jsxs(M,{className:"oui-group",children:[i.jsxs(m,{justify:"center",gap:1,itemAlign:"center",className:"oui-cursor-pointer",onClick:h,children:[i.jsx(te,{className:"oui-flex-1"}),i.jsx(Qs,{size:12,color:"white",className:b("oui-transition-transform",l&&"oui-rotate-180")}),i.jsx(te,{className:"oui-flex-1"})]}),i.jsxs(M,{style:{transform:"translateZ(0)"},className:b("oui-space-y-1.5 oui-select-none oui-overflow-hidden","oui-transition-[max-height] oui-duration-150","group-hover:oui-will-change-[max-height]",l?"oui-max-h-[69px]":"oui-max-h-0"),children:[i.jsx(_t,{label:c("trading.asset.freeCollateral"),description:c("trading.asset.freeCollateral.tooltip"),formula:c("trading.asset.freeCollateral.formula"),visible:e,value:t===0?"0":t,unit:"USDC"}),i.jsx(_t,{label:c("trading.asset.marginRatio"),description:c("trading.asset.marginRatio.tooltip"),formula:c("trading.asset.marginRatio.formula"),visible:e,value:s,isConnected:o,rule:"percentages",showPercentage:!0,placeholder:"--%"}),i.jsx(_t,{label:c("trading.asset.maintenanceMarginRatio"),description:c("trading.asset.maintenanceMarginRatio.tooltip"),formula:c("trading.asset.maintenanceMarginRatio.formula"),visible:e,value:r,rule:"percentages",showPercentage:!0,placeholder:"--%"})]})]})},sn=({networkId:e,isFirstTimeDeposit:t,totalValue:s,onDeposit:r,onWithdraw:o,toggleVisible:a,visible:n,freeCollateral:l,marginRatioVal:d,renderMMR:c,isConnected:h})=>{let{title:p,description:g,titleColor:y,titleClsName:f}=Ja(),{t:C}=w();return i.jsxs(M,{className:"oui-relative",children:[p&&g&&i.jsxs(m,{direction:"column",gap:1,className:"oui-mb-[32px]",children:[i.jsx(x,{size:"lg",weight:"bold",color:y||"inherit",className:f,children:p}),i.jsx(x,{size:"2xs",color:"neutral",weight:"semibold",className:"oui-text-center",children:g})]}),i.jsx(Di,{networkId:e,buttonProps:{size:"md",fullWidth:!0},children:t?i.jsxs(i.Fragment,{children:[i.jsx(M,{children:i.jsxs(m,{direction:"column",gap:1,className:"oui-mb-[32px]",children:[i.jsx(x.gradient,{size:"lg",weight:"bold",color:"brand",children:C("trading.asset.startTrading")}),i.jsx(x,{size:"2xs",color:"neutral",weight:"semibold",children:C("trading.asset.startTrading.description")})]})}),i.jsxs(J,{"data-testid":"oui-testid-assetView-deposit-button",fullWidth:!0,size:"md",onClick:r,children:[i.jsx(tt,{color:"white",opacity:1}),i.jsx(x,{children:C("common.deposit")})]}),i.jsx(M,{className:"oui-mt-3",children:i.jsx(gi,{})})]}):i.jsxs(M,{className:"oui-space-y-4",children:[i.jsx(en,{totalValue:s,visible:n,onToggleVisibility:a}),i.jsx(tn,{visible:n,freeCollateral:l,marginRatioVal:d,renderMMR:c,isConnected:h}),i.jsxs(m,{gap:3,itemAlign:"center",children:[i.jsxs(J,{fullWidth:!0,color:"secondary",size:"md",onClick:o,"data-testid":"oui-testid-assetView-withdraw-button",children:[i.jsx(tt,{color:"white",opacity:1,className:"oui-rotate-180"}),i.jsx(x,{children:C("common.withdraw")})]}),i.jsxs(J,{"data-testid":"oui-testid-assetView-deposit-button",fullWidth:!0,size:"md",onClick:r,children:[i.jsx(tt,{color:"white",opacity:1}),i.jsx(x,{children:C("common.deposit")})]})]}),i.jsx(gi,{})]})}),i.jsx("div",{className:"oui-pointer-events-none oui-rotate-180 oui-rounded-2xl oui-blur-[200px] oui-top-0 oui-bottom-0 oui-left-0 oui-right-0 oui-absolute",style:{background:"conic-gradient(from -40.91deg at 40.63% 50.41%, rgba(159, 115, 241, 0) -48.92deg, rgba(242, 98, 181, 0) 125.18deg, #5FC5FF 193.41deg, #FFAC89 216.02deg, #8155FF 236.07deg, #789DFF 259.95deg, rgba(159, 115, 241, 0) 311.08deg, rgba(242, 98, 181, 0) 485.18deg)"}})]})},hs=()=>{var l;let{state:e}=ue(),{wrongNetwork:t,disabledConnect:s}=lt(),{totalValue:r}=vt({dp:2}),o=t||s||e.status<F.EnableTrading&&e.status!==F.EnableTradingWithoutConnected,a=u.useMemo(()=>{let d=new Date,c=new Date;c.setDate(d.getDate()-90);let h=c.getTime(),p=d.getTime(),g=new URLSearchParams;return g.set("page","1"),g.set("size","5"),g.set("side","DEPOSIT"),g.set("status","COMPLETED"),g.set("startTime",h.toString()),g.set("endTime",p.toString()),`/v1/asset/history?${g.toString()}`},[]),{data:n}=zs(a,{formatter:d=>d});return{isFirstTimeDeposit:!o&&r===0&&((l=n==null?void 0:n.meta)==null?void 0:l.total)===0,totalValue:r}},rn=()=>{let{t:e}=w(),t=Hs(),s=Pe(yt),{isFirstTimeDeposit:r,totalValue:o}=hs(),a=ft("networkId"),{state:n}=ue(),{freeCollateral:l}=vt({dp:2}),{marginRatio:d,mmr:c}=gt(),h=n.status>=F.Connected,[{aggregated:p,totalUnrealizedROI:g},y]=rt(),f=u.useMemo(()=>Math.min(10,p.notional===0?y.margin_ratio(10):d),[d,p]);u.useMemo(()=>c?new L(c).mul(100).todp(2,0).toFixed(2):"",[c]);let C=u.useCallback(async R=>{let $;return s?$=await ee.show(Lt,{activeTab:R}):$=await ee.show(vr,{activeTab:R}),$},[s]),j=u.useCallback(async()=>C("deposit"),[s]),_=xt(),P=u.useCallback(async()=>C("withdraw"),[s]),k=u.useCallback(async()=>t.settle().catch(R=>{if(R.code===-1104)return W.error(e("settle.settlement.error")),Promise.reject(R);R.message.indexOf("Signing off chain messages with Ledger is not yet supported")!==-1&&_.emit("wallet:sign-message-with-ledger-error",{message:R.message,userAddress:t.address})}).then(R=>(W.success(e("settle.settlement.requested")),Promise.resolve(R))),[t,e]),[v,S]=B("orderly_assets_visible",!0),T=u.useCallback(()=>{S(R=>!R)},[v]);Vs({onMessage:R=>{let{side:$,transStatus:U}=R;if(U==="COMPLETED"){let E={DEPOSIT:e("transfer.deposit.completed"),WITHDRAW:e("transfer.withdraw.completed")},G=`${ti($)} completed`;W.success(E[$]||G)}else if(U==="FAILED"){let E={DEPOSIT:e("transfer.deposit.failed"),WITHDRAW:e("transfer.withdraw.failed")},G=`${ti($)} failed`;W.error(E[$]||G)}_.emit("wallet:changed",R)}}),qs({onMessage:R=>{let{status:$}=R;switch($){case"COMPLETED":W.success(e("settle.settlement.completed"));break;case"FAILED":W.error(e("settle.settlement.failed"));break}}});let I=le(l)??void 0,z=le(f)??void 0,Z=le(c)??void 0,K=le(o)??void 0;return{onDeposit:j,onWithdraw:P,onSettle:k,visible:v,toggleVisible:T,networkId:a,isFirstTimeDeposit:r,totalValue:K,status:n.status,freeCollateral:I,marginRatioVal:z,renderMMR:Z,isConnected:h}},on=()=>{let e=rn();return i.jsx(sn,{...e})},Xt=u.createContext({cellHeight:22}),Oe=()=>u.useContext(Xt),Ct="orderbook_coin_type",ms=e=>{let[t,s]=u.useState("quantity"),[r,o]=u.useState("quantity"),a=he.useMemo(()=>({cellHeight:e.cellHeight,onItemClick:e.onItemClick,mode:t,totalMode:r||"quantity",depth:e.depth,onModeChange:s,onTotalModeChange:o,showTotal:e.showTotal||!1,pendingOrders:e.pendingOrders,symbolInfo:e.symbolInfo}),[t,e.cellHeight,e.depth,e.onItemClick,e.pendingOrders,e.showTotal,e.symbolInfo,r]);return i.jsx(Xt.Provider,{value:a,children:e.children})},ps=e=>{let{direction:t=1}=e,s=u.useMemo(()=>{let r=Math.max(e.width,0);return t===0?{transform:`translateX(${r}%)`}:{transform:`translateX(-${r}%)`}},[e.width]);return i.jsx("div",{className:b("oui-absolute oui-right-[-100%] oui-top-0 oui-h-full oui-w-full oui-transition-transform oui-pointer-events-none",t===0&&"oui-left-[-100%]",e.className),style:s})},an=e=>{let{cellHeight:t,showTotal:s,onItemClick:r,depth:o,pendingOrders:a}=Oe(),{symbolInfo:n,currentHover:l,accumulated:d,accumulatedAmount:c,count:h,price:p,quantity:g,base:y,quote:f}=e,{base_dp:C,quote_dp:j}=n,[_]=B(Ct,y),P=Number.isNaN(p)?0:d/h*100,k=u.useMemo(()=>Mi(o||`${j}`),[o,j]),v=Number.isNaN(d)?"-":c==null?void 0:c.toString(),S=u.useMemo(()=>{let T=ii(p,{dp:k,padding:!0});return a.some(I=>T===ii(I,{dp:k,padding:!0}))},[a,p,k]);return i.jsxs("div",{className:"oui-relative oui-flex oui-cursor-pointer oui-flex-row oui-justify-between oui-pl-3 oui-text-xs oui-tabular-nums oui-text-base-contrast-80",style:{height:`${t}px`},onClick:()=>{Number.isNaN(p)||Number.isNaN(g)||(r==null||r([p,g]))},onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,children:[i.jsxs("div",{className:b("oui-mr-2 oui-flex oui-basis-7/12 oui-flex-row oui-items-center",s&&"oui-basis-5/12"),children:[i.jsx("div",{className:b("oui-flex-1 oui-text-left",e.type==="ask"?"oui-text-trade-loss":"oui-text-trade-profit"),children:i.jsx(x.numeral,{dp:k,children:p})}),i.jsx("div",{className:"oui-flex-1 oui-text-right oui-text-base-contrast-80",children:i.jsx(x.numeral,{dp:C,children:g})})]}),i.jsxs("div",{className:b("oui-fex-row oui-relative oui-flex oui-basis-5/12 oui-items-center oui-justify-end oui-overflow-hidden",s&&"oui-basis-7/12"),children:[s?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:b("oui-flex-1 oui-pr-3 oui-text-right"),children:i.jsx(x.numeral,{dp:C,className:"oui-z-10",children:d})}),i.jsx("div",{className:b("oui-flex-1 oui-pr-3 oui-text-right"),children:i.jsx(x.numeral,{dp:k,className:"oui-z-10",children:v})})]}):i.jsxs("div",{className:b("oui-flex-1 oui-pr-3 oui-text-right"),children:[_===y&&i.jsx(x.numeral,{dp:C,className:"oui-z-10",children:d}),_===f&&i.jsx(x.numeral,{dp:k,className:"oui-z-10",children:v})]}),i.jsx(ps,{width:P,direction:0,className:e.type==="ask"?"oui-bg-trade-loss/10":"oui-bg-trade-profit/10"})]}),S&&i.jsx("div",{className:b("oui-pointer-events-none oui-absolute oui-left-[4px] oui-size-[4px] oui-rounded-full",e.type==="ask"&&"oui-bg-trade-loss",e.type==="bid"&&"oui-bg-trade-profit"),style:{top:`${t/2-2}px`}}),e.isHover&&i.jsx("div",{className:"oui-absolute oui-inset-0 oui-bg-white oui-opacity-[.12]"}),l&&i.jsx("div",{className:b("oui-absolute oui-inset-x-0",e.type==="ask"&&"oui-top-0",e.type==="bid"&&"oui-bottom-0"),children:i.jsx(te,{lineStyle:"dashed",className:b("oui-w-full",e.type==="bid"&&"oui-border-trade-profit",e.type==="ask"&&"oui-border-trade-loss")})})]})},gs=e=>{let{data:t,type:s,countQty:r}=e,{symbolInfo:o,depth:a}=Oe(),n=u.useCallback(()=>{if(((t==null?void 0:t.length)||0)===0)return null;if(s==="ask"){let p=t.findIndex(g=>!Number.isNaN(g[0]));return p!=-1?t[p]:null}else{for(let p=t.length-1;p>=0;p--){let g=t[p];if(!Number.isNaN(g[0]))return g}return null}},[t,s]),l=u.useMemo(()=>a!=null&&a.toString().includes(".")?a.toString().split(".")[1].length:0,[a]),d=u.useMemo(()=>t.reduce((p,g)=>Math.max(p,g[1]),0),[t]),[c,h]=u.useState(-1);return i.jsx("div",{className:"oui-order-book-list oui-flex oui-flex-col oui-gap-px",children:t.map((p,g)=>i.jsx(nn,{index:g,item:p,countQty:r,setHoverIndex:h,hoverIndex:c,type:s,maxQty:d,priceDp:l,symbolInfo:o,findMaxItem:n},g))})},nn=e=>{let{index:t,item:s,setHoverIndex:r,type:o,maxQty:a,hoverIndex:n,priceDp:l,countQty:d,symbolInfo:c}=e,{base:h,quote:p,base_dp:g,quote_dp:y}=c,{t:f}=w(),C=n!==-1?o==="ask"?t>=n:t<=n:!1,[j,_]=u.useState(!1),P=v=>{if(v===null)return{sumQty:0,sumQtyAmount:0,avgPrice:0};let S={sumQty:0,sumQtyAmount:0};return Number.isNaN(v[2])||(S={sumQty:v[2],sumQtyAmount:v[3]}),{...S,avgPrice:S.sumQtyAmount==0?0:S.sumQtyAmount/S.sumQty}},k=u.useMemo(()=>{let v=P(s);return v.avgPrice===0?P(e.findMaxItem()):v},[s,e]);return i.jsxs(rr,{open:j,onOpenChange:_,children:[i.jsx(or,{children:i.jsx(an,{background:"",price:s[0],quantity:s[1],accumulated:s[2],count:d,type:o,accumulatedAmount:s[3],maxQty:a,isHover:C,currentHover:n===t,symbolInfo:c,base:h,quote:p,onMouseEnter:()=>{r(t),_(!0)},onMouseLeave:()=>{r(-1),_(!1)}})}),i.jsxs(ar,{className:b("oui-rounded-base oui-flex oui-w-full oui-max-w-[400px] oui-flex-col oui-gap-2 oui-bg-base-6 oui-p-3 oui-text-2xs oui-shadow-md"),align:o==="ask"?"end":"start",alignOffset:-25.4,side:"left",sideOffset:2,onPointerEnter:v=>v.preventDefault(),children:[i.jsx(St,{title:`${f("common.avgPrice")}â‰ˆ`,content:k.avgPrice,contentDp:l}),i.jsx(St,{title:`${f("trading.orderBook.sum")} (${h})`,content:k.sumQty,contentDp:g}),i.jsx(St,{title:`${f("trading.orderBook.sum")} (${p})`,content:k.sumQtyAmount,contentDp:y}),i.jsx(nr,{className:"oui-fill-base-6",style:{transform:o==="ask"?"translateX(80%)":"translateX(-80%)"}})]})]})},St=e=>{let{title:t,content:s,contentDp:r}=e;return i.jsxs("div",{className:"oui-flex oui-flex-row oui-justify-between oui-gap-4",children:[i.jsx("div",{className:"oui-text-base-contrast-36",children:t}),i.jsx("div",{className:"oui-text-right",children:i.jsx(x.numeral,{dp:r,children:s})})]})},ln=e=>{let{data:t}=e,s=u.useMemo(()=>{let r=Number.NaN,o=t.length,a=0;for(;Number.isNaN(r)&&a<o;)r=t[a][2],a++;return r},[t]);return i.jsx(gs,{type:"ask",data:t,countQty:s})},un=e=>{let{data:t}=e,s=u.useMemo(()=>{let r=Number.NaN,o=t.length-1;for(;Number.isNaN(r)&&o>0;)r=t[o][2],o--;return r},[t]);return i.jsx(gs,{type:"bid",data:t,countQty:s})},dn=e=>{let t=u.useMemo(()=>e.depths.map(s=>({value:s,label:`${s}`})),[e.depths]);return i.jsx(M,{pl:3,width:97,className:"oui-py-[10px]",children:i.jsx(qt.options,{options:t,size:"xs",value:e.value,onValueChange:s=>{var r;(r=e.onChange)==null||r.call(e,s)}})})},cn=e=>{let{item:t,base:s,onClick:r}=e,{t:o}=w(),[a,n]=B(Ct,s);return i.jsxs(m,{justify:"between",itemAlign:"center",className:b("oui-w-full oui-px-2 oui-py-[3px]","oui-cursor-pointer","oui-text-xs","oui-text-base-contrast-54","hover:oui-bg-base-6","oui-rounded-[3px]","oui-transition-all",a===t&&"oui-bg-base-5"),onClick:l=>{n(t),r(l)},children:[o("common.total"),"(",t,")",i.jsx("div",{className:b("oui-transition-all","oui-w-1","oui-h-1","oui-rounded-full","oui-bg-gradient-to-r",a===t&&"oui-from-[rgb(var(--oui-gradient-brand-start))] oui-to-[rgb(var(--oui-gradient-brand-end))]")})]})},hn=e=>{let{base:t,quote:s}=e,{showTotal:r}=Oe(),{t:o}=w(),[a,n]=he.useState(!1),[l]=B(Ct,t),d=a?ir:wi;return i.jsxs(m,{pl:3,justify:"between",className:"oui-py-[6px]",children:[i.jsxs(m,{gap:1,className:b("oui-basis-7/12",r&&"oui-basis-1/2"),children:[i.jsx(M,{width:"100%",children:i.jsx(Ke,{id:"oui-order-book-header-price",className:"oui-text-base-contrast-36",children:`${o("common.price")}(${s})`})}),i.jsx(M,{width:"100%",children:i.jsx(Ke,{justifyEnd:!0,id:"oui-order-book-header-qty",className:"oui-text-base-contrast-36",children:`${o("common.qty")}(${t})`})})]}),i.jsx(m,{gap:1,pr:3,className:b("oui-basis-5/12",r&&"oui-basis-1/2"),children:r?i.jsxs(i.Fragment,{children:[i.jsx(M,{className:"oui-text-base-contrast-36",width:"100%",children:i.jsx(Ke,{id:"oui-order-book-header-total-quote",justifyEnd:!0,children:`${o("common.total")}(${t})`})}),i.jsx(M,{className:"oui-text-base-contrast-36",width:"100%",children:i.jsx(Ke,{justifyEnd:!0,id:"oui-order-book-header-total-base",children:`${o("common.total")}(${s})`})})]}):i.jsx(M,{width:"100%",children:i.jsx(tr,{open:a,onOpenChange:n,contentProps:{className:b("oui-w-28 oui-p-1")},content:i.jsx(m,{direction:"column",itemAlign:"start",className:b("oui-w-full oui-gap-0.5"),children:[t,s].map(c=>i.jsx(cn,{item:c,base:t,onClick:()=>n(!1)},`type-${c}`))}),children:i.jsxs(m,{justify:"end",itemAlign:"center",className:"oui-cursor-pointer oui-select-none oui-text-base-contrast-36 oui-transition-all hover:oui-text-base-contrast",children:[i.jsx(Ke,{justifyEnd:!0,id:"oui-order-book-header-total-base",children:`${o("common.total")}(${l})`}),i.jsx(d,{color:"inherit",className:"oui-size-4 oui-text-3xs"})]})})})})]})},Ke=e=>{let{children:t,className:s,justifyEnd:r=!1}=e;return i.jsx(m,{id:e.id,className:b(s,"oui-items-end oui-text-xs",r&&"oui-justify-end"),children:t})},xs=e=>{let{markPrice:t=0,lastPrice:s,quote_dp:r,className:o,iconSize:a=18}=e,[n,l]=s,d=l<n,c=l>n;return i.jsxs(m,{gap:1,className:b(c?"oui-text-trade-profit":d?"oui-text-trade-loss":"",o),children:[i.jsx(x.numeral,{dp:r,intensity:98,children:l}),i.jsxs(M,{width:19,children:[d&&i.jsx(tt,{size:a,color:"danger",opacity:1}),c&&i.jsx(Ni,{size:a,color:"success",opacity:1})]})]})},bs=e=>{let{isMobile:t}=st();return t?i.jsx(pn,{...e}):i.jsx(mn,{...e})},mn=e=>{let{quote_dp:t,className:s,iconSize:r=18}=e,{t:o}=w();return i.jsx(at,{content:o("trading.orderBook.markPrice.tooltip"),className:"oui-max-w-[270px]",children:i.jsxs(m,{gap:1,className:b("oui-cursor-pointer oui-text-2xs",s),children:[i.jsx(fs,{size:r}),i.jsx(x.numeral,{dp:t,color:"warning",className:"oui-underline oui-text-base oui-decoration-dashed oui-decoration-1 oui-underline-offset-4 oui-decoration-warning-darken",children:e.markPrice})]})})},pn=e=>{let{quote_dp:t,className:s,iconSize:r=18}=e,[o,a]=u.useState(!1),{t:n}=w();return i.jsxs(i.Fragment,{children:[i.jsxs(m,{gap:1,className:b("oui-cursor-pointer oui-text-2xs",s),onClick:()=>{a(!0)},children:[i.jsx(fs,{size:r}),i.jsx(x.numeral,{dp:t,color:"warning",className:"oui-underline oui-decoration-dashed oui-decoration-1 oui-underline-offset-4 oui-decoration-warning-darken",children:e.markPrice})]}),i.jsx(sr,{size:"xs",open:o,onOpenChange:a,title:n("common.tips"),actions:{primary:{label:n("common.ok"),onClick:()=>a(!1)}},children:i.jsx(x,{children:n("trading.orderBook.markPrice.tooltip")})})]})},fs=e=>i.jsx("svg",{width:e.size,height:e.size,viewBox:"0 0 18 18",fill:"currenColor",xmlns:"http://www.w3.org/2000/svg",className:"oui-fill-warning-darken",children:i.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.75 1.5a.75.75 0 0 1 .75.75h6a.75.75 0 0 1 .75.75v1.5h3a.75.75 0 0 1 .75.75V12a.75.75 0 0 1-.75.75H7.5a.75.75 0 0 1-.75-.75v-1.5H4.5v5.25a.75.75 0 0 1-1.5 0V2.25a.75.75 0 0 1 .75-.75M4.5 9h5.25V3.75H4.5zm6.75-3v3.75a.75.75 0 0 1-.75.75H8.25v.75h5.25V6z"})}),gn=e=>{let{markPrice:t=0,lastPrice:s,asks:r,bids:o,symbolInfo:a}=e,{showTotal:n}=Oe();return i.jsxs("div",{className:"oui-flex oui-flex-row oui-pl-3 oui-tabular-nums oui-justify-between oui-text-base-contrast-80 oui-text-xs oui-relative oui-cursor-pointer oui-py-[6px]",children:[i.jsxs("div",{className:b("oui-basis-7/12 oui-flex oui-flex-row oui-items-center oui-mr-2 oui-justify-between",n&&"oui-basis-5/12"),children:[i.jsx(xs,{markPrice:t,lastPrice:s,quote_dp:a.quote_dp,className:"oui-text-base"}),i.jsx(bs,{markPrice:t,quote_dp:a.quote_dp})]}),i.jsx("div",{className:b("oui-basis-5/12 oui-flex oui-items-center oui-fex-row oui-overflow-hidden oui-relative oui-justify-end",n&&"oui-basis-7/12","oui-pr-3"),children:i.jsx(xn,{asks:r,bids:o})})]})},xn=e=>{let{asks:t,bids:s}=e,{t:r}=w(),o=u.useMemo(()=>{if(s.length===0&&t.length===0)return 0;let a=Number.isNaN(s[0][0])?0:s[0][0],n=t.reverse().findIndex(c=>!Number.isNaN(c[0])),l=0;n!==-1&&(l=Number.isNaN(t[n][0])?0:t[n][0]);let d=new L(l).sub(a).div(new L(l).add(a).div(2));return Math.ceil(d.toNumber()*1e6+.1)/1e4},[t,s]);return i.jsx("div",{children:i.jsx(at,{content:r("trading.orderBook.spreadRatio.tooltip"),className:"oui-max-w-[240px]",children:i.jsx(x,{size:"2xs",intensity:36,className:"oui-cursor-pointer oui-underline oui-decoration-dashed oui-decoration-1 oui-underline-offset-4 oui-decoration-base-contrast-36",children:`${o}%`})})})},bn=e=>{let{lastPrice:t,markPrice:s,quote:r,base:o,isLoading:a,onDepthChange:n}=e,l=u.useRef(null),[d,c]=u.useState(!1),[h,p]=B(Ct,o);return u.useEffect(()=>{h!==r&&o&&p(o)},[o,r]),u.useEffect(()=>{let g=new ResizeObserver(f=>{for(let C of f){let{inlineSize:j}=C.borderBoxSize[0];c(j>=360)}}),y=l.current;return y&&g.observe(y),()=>{y&&g.unobserve(y)}},[]),i.jsx(ms,{cellHeight:e.cellHeight??20,onItemClick:e.onItemClick,depth:e.activeDepth,showTotal:d,pendingOrders:e.pendingOrders||[],symbolInfo:e.symbolInfo,children:i.jsxs(ye,{cols:1,rows:5,id:"oui-orderbook-desktop",ref:l,className:"oui-relative oui-size-full oui-grid-rows-[auto,auto,1fr,auto,1fr]",children:[i.jsx(dn,{depths:e.depths,value:e.activeDepth,onChange:n}),i.jsx(hn,{quote:r,base:o}),i.jsx(ln,{data:[...e.asks]}),i.jsx(gn,{lastPrice:t,markPrice:s,asks:[...e.asks],bids:[...e.bids],symbolInfo:e.symbolInfo}),i.jsx(un,{data:[...e.bids]}),a&&i.jsx("div",{className:"oui-bg-bg-8/70 oui-absolute oui-inset-0 oui-z-10 oui-flex oui-items-center oui-justify-center",children:i.jsx(Li,{})})]})})},fn=e=>{let{t}=w(),{mode:s,onModeChange:r}=Oe(),o=u.useMemo(()=>s==="amount"?e.quote:e.base,[s,e.quote,e.base]),a=u.useMemo(()=>t(s==="amount"?"trading.orderBook.column.value":"common.qty"),[s,t]);return i.jsxs(m,{justify:"between",width:"100%",className:"oui-text-base-contrast-36 oui-text-2xs oui-py-[5px]",children:[i.jsxs(m,{direction:"column",itemAlign:"start",id:"oui-order-book-header-price",children:[i.jsx(x,{children:t("common.price")}),i.jsx(x,{children:`(${e.quote})`})]}),i.jsxs(m,{direction:"column",itemAlign:"end",className:"oui-cursor-pointer",onClick:()=>r==null?void 0:r(s==="amount"?"quantity":"amount"),children:[i.jsx(x,{children:a}),i.jsx(x,{children:`(${o})`})]})]})},yn=e=>{let t=e.accumulated/e.count*100,{cellHeight:s,onItemClick:r,depth:o,showTotal:a,symbolInfo:n}=u.useContext(Xt),{base_dp:l,quote_dp:d}=n,c=Number.isNaN(e.quantity)?"-":e.mode==="amount"?new L(e.quantity).mul(e.price).toString():e.quantity;a&&(c=e.quantity);let h=u.useMemo(()=>Mi(o||`${d}`),[o,d]);return i.jsxs(M,{className:b("oui-overflow-hidden oui-relative oui-cursor-pointer oui-tabular-nums oui-text-2xs oui-w-full",a&&"oui-flex-1"),style:{height:`${s}px`},onClick:p=>{Number.isNaN(e.price)||Number.isNaN(e.quantity)||(r==null||r([e.price,e.quantity]))},children:[i.jsxs(m,{justify:"between",children:[i.jsx(x.numeral,{color:e.type==="bid"?"buy":"sell",dp:h,children:e.price}),i.jsx(x.numeral,{dp:e.mode==="amount"?2:l,className:"oui-text-base-contrast-80",children:c})]}),Number.isNaN(t)||a?null:i.jsx(ps,{width:t,className:e.type==="ask"?"oui-bg-trade-loss/20":"oui-bg-trade-profit/20"})]})},ys=e=>{let{data:t}=e,{mode:s}=Oe();return i.jsx(M,{className:"oui-order-book-list oui-flex oui-flex-col oui-gap-[1px] oui-w-full",children:t.map((r,o)=>i.jsx(yn,{background:"",price:r[0],quantity:r[1],accumulated:r[2],count:e.countQty,type:e.type,mode:s},o))})},vn=e=>{let{data:t}=e,s=u.useMemo(()=>{let r=Number.NaN,o=t.length-1;for(;Number.isNaN(r)&&o>0;)r=t[o][2],o--;return r},[t]);return i.jsx(ys,{type:"bid",data:t,countQty:s})},Cn=e=>{let{data:t}=e,s=u.useMemo(()=>{let r=Number.NaN,o=t.length,a=0;for(;Number.isNaN(r)&&a<o;)r=t[a][2],a++;return r},[t]);return i.jsx(ys,{type:"ask",data:t,countQty:s})},jn=e=>{let{symbolInfo:t}=Oe(),{quote_dp:s}=t;return i.jsxs(m,{id:"oui-order-book-mark-price",className:"oui-py-[6px]",width:"100%",justify:"between",children:[i.jsx(xs,{markPrice:e.markPrice,lastPrice:e.lastPrice,quote_dp:s,className:"oui-text-sm",iconSize:14}),i.jsx(bs,{markPrice:e.markPrice,quote_dp:s,className:"oui-text-2xs",iconSize:12})]})},wn=e=>{let t=u.useMemo(()=>e.depth.map(s=>({value:s,label:`${s}`})),[e.depth]);return i.jsx(M,{id:"oui-order-book-depth",className:"oui-pt-2  oui-w-full",children:i.jsx(er,{options:t,fullWidth:!0,size:"sm",value:e.value,className:"oui-text-2xs oui-text-base-contrast-54",onValueChange:s=>{var r;(r=e.onChange)==null||r.call(e,s)}})})},_n=e=>{let t=e.data.est_funding_rate,s=e.data.countDown,{t:r}=w();return i.jsxs(m,{direction:"column",itemAlign:"start",pb:2,children:[i.jsx(x,{intensity:36,size:"2xs",children:r("trading.fundingRate.predFundingRate")}),t===null?"--":i.jsxs("div",{className:"orderly-flex orderly-gap-1 oui-text-2xs oui-text-base-contrast-36",children:[i.jsx(x.numeral,{coloring:!0,suffix:"%",dp:4,children:t??"--"}),i.jsx("span",{children:" in"}),i.jsx("span",{children:" "+s})]})]})},Sn=e=>({data:Js(e)}),Nn=e=>{let t=Sn(e.symbol);return i.jsx(_n,{...t})},kn=e=>{let{lastPrice:t,markPrice:s,quote:r,base:o,isLoading:a,onDepthChange:n}=e,l=`PERP_${e.symbolInfo.base}_${e.symbolInfo.quote}`;return i.jsx(ms,{cellHeight:e.cellHeight??20,onItemClick:e.onItemClick,depth:e.activeDepth,pendingOrders:[],showTotal:!1,symbolInfo:e.symbolInfo,children:i.jsxs(m,{direction:"column",p:2,id:"oui-orderbook-mobile",className:b("oui-h-full oui-wfull oui-relative",e.className),justify:"start",itemAlign:"start",children:[i.jsx(Nn,{symbol:l}),i.jsx(fn,{quote:r,base:o}),i.jsx(Cn,{data:e.asks}),i.jsx(jn,{lastPrice:t,markPrice:s}),i.jsx(vn,{data:e.bids}),i.jsx(wn,{depth:e.depths||[],value:e.activeDepth,onChange:n}),a&&i.jsx("div",{className:"oui-absolute oui-left-0 oui-top-0 oui-right-0 oui-bottom-0 oui-z-10 oui-flex oui-items-center oui-justify-center oui-bg-base-800/70 oui-h-full oui-min-h-[420px]",children:i.jsx(Li,{})})]})})},Pn=e=>i.jsx(M,{className:"oui-font-semibold",width:"100%",height:"100%",children:e.isMobile?i.jsx(kn,{level:e.level,asks:e.asks,bids:e.bids,markPrice:e.markPrice,lastPrice:e.lastPrice,depths:e.depths,activeDepth:e.selDepth,base:e.base,quote:e.quote,isLoading:e.isLoading,onItemClick:e.onItemClick,cellHeight:e.cellHeight,onDepthChange:e.onDepthChange,className:e.className,symbolInfo:e.symbolInfo}):i.jsx(bn,{level:e.level,asks:e.asks,bids:e.bids,markPrice:e.markPrice,lastPrice:e.lastPrice,depths:e.depths,activeDepth:e.selDepth,base:e.base,quote:e.quote,isLoading:e.isLoading,onItemClick:e.onItemClick,cellHeight:e.cellHeight,onDepthChange:e.onDepthChange,className:e.className,pendingOrders:e.pendingOrders,symbolInfo:e.symbolInfo})}),Ye=20,xi=104,Tn=e=>{let{symbol:t,height:s}=e,r=He()[e.symbol],[o,a]=u.useState(Ye),[n,l]=u.useState(10),{base:d,quote:c,quote_dp:h}=$t(r),[p,{onDepthChange:g,isLoading:y,onItemClick:f,depth:C,allDepths:j}]=Ys(t,void 0,{level:n}),_=On(t);u.useEffect(()=>{if(s){let S=Math.floor((s-xi)/((Ye+1)*2)),T=(Ye+1)*2*S,I=s-xi-T;I>10?a(Ye+I/S/2):a(Ye),l(S)}},[s]);let P=u.useMemo(()=>typeof C>"u"||typeof h>"u"?void 0:Tt(C),[C,h]),k=u.useMemo(()=>(j==null?void 0:j.map(S=>Tt(S)))||[],[j,h]),{isMobile:v}=st();return{level:n,asks:p==null?void 0:p.asks,bids:p==null?void 0:p.bids,markPrice:p==null?void 0:p.markPrice,lastPrice:p==null?void 0:p.middlePrice,depths:k,selDepth:P,base:d,quote:c,isLoading:y,onItemClick:f,cellHeight:o,onDepthChange:g,pendingOrders:_,symbolInfo:$t(r),isMobile:v}},On=e=>{let[t]=Ce({status:se.INCOMPLETE,symbol:e});return u.useMemo(()=>t==null?void 0:t.filter(s=>s.symbol===e).reduce((s,r)=>{let o=r.price||r.trigger_price||0;return[...s,o]},[]),[t,e])},Gt=e=>{let t=Tn({symbol:e.symbol,height:e.height});return i.jsx(Pn,{...t,className:e.className})},Ln=e=>{let{riskRate:t,riskRateColor:s,isConnected:r,currentLeverage:o,maxLeverage:a}=e,{isHigh:n,isMedium:l,isLow:d,isDefault:c}=s,{wrongNetwork:h}=lt(),{t:p}=w(),g=h?"":n?"oui-text-danger":l?"oui-text-warning-darken":d?Si({color:"brand"}):"";return i.jsxs(M,{"data-risk":"",className:"oui-space-y-2",children:[i.jsx(m,{itemAlign:"center",justify:"start",className:"oui-w-full oui-bg-base-6 oui-rounded-full oui-h-2 oui-px-[1px]",children:i.jsx(M,{className:h?"oui-bg-gradient-to-r oui-opacity-20 oui-from-[#26fefe]  oui-via-[#ff7d00] oui-to-[#d92d6b] oui-h-1.5 oui-rounded-full":n?"oui-bg-gradient-to-tr oui-from-[#791438] oui-to-[#ff447c] oui-h-1.5 oui-rounded-full":l?"oui-bg-gradient-to-tr oui-from-[#792e00] oui-to-[#ffb65d] oui-h-1.5 oui-rounded-full":d?"oui-bg-gradient-to-tr oui-from-[#59b0fe] oui-to-[#26fefe] oui-h-1.5 oui-rounded-full":"oui-bg-gradient-to-r oui-opacity-20 oui-from-[#26fefe]  oui-via-[#ff7d00] oui-to-[#d92d6b] oui-h-1.5 oui-rounded-full",style:t&&t!=="--"?{width:t}:{width:"100%"}})}),i.jsxs(m,{className:"oui-gap-2",justify:"between",children:[i.jsxs(m,{direction:"column",children:[i.jsx(at,{content:i.jsx(cs,{description:p("trading.riskRate.tooltip"),formula:p("trading.riskRate.formula")}),children:i.jsx(x,{size:"2xs",color:"neutral",weight:"semibold",className:b("oui-cursor-pointer","oui-border-b oui-border-dashed oui-border-b-white/10"),children:p("trading.riskRate")})}),i.jsx(x,{size:"xs",color:"neutral",weight:"semibold",className:b(g),children:t??"--"})]}),i.jsxs(m,{direction:"column",children:[i.jsx(x,{size:"2xs",color:"neutral",weight:"semibold",className:b("oui-cursor-pointer","oui-border-b oui-border-b-transparent"),children:p("leverage.maxAccountLeverage")}),i.jsxs(m,{className:"oui-gap-1",children:[i.jsx(x.numeral,{dp:2,padding:!1,suffix:o?"x":void 0,children:o??"--"}),i.jsx("span",{className:"oui-text-base-contrast-54",children:"/"}),i.jsxs("button",{className:"oui-flex oui-items-center oui-gap-1",onClick:()=>{ee.show(Cr,{currentLeverage:5})},"data-testid":"oui-testid-riskRate-leverage-button",children:[i.jsx(x.numeral,{dp:2,padding:!1,suffix:a?"x":void 0,"data-testid":"oui-testid-riskRate-leverage-value",children:a??"--"}),typeof a<"u"&&a!==null&&i.jsx(Fs,{size:12,color:"white"})]})]})]})]})]})},Mn=e=>{if(e===null)return{isHigh:!1,isMedium:!1,isLow:!1,isDefault:!0};let t=e<40,s=e>=40&&e<80,r=e>=80;return{isHigh:r,isMedium:s,isLow:t,isDefault:!t&&!s&&!r}},In=()=>{let{state:e}=ue(),t=e.status>=F.EnableTrading||e.status===F.EnableTradingWithoutConnected,{marginRatio:s,currentLeverage:r,mmr:o}=gt(),{maxLeverage:a}=Vt(),n=u.useMemo(()=>!t||s===null||o===null?"--":s===0||o===0?"0%":`${new L(o).div(s).mul(100).todp(2,L.ROUND_UP).toString().replace(/\.?0+$/,"")}%`,[t,s,o]),l=n==="--"?null:parseFloat(n),d=u.useMemo(()=>Mn(l),[l]),c=le(r),h=le(a);return{riskRate:le(n),riskRateColor:d,isConnected:t,currentLeverage:c,maxLeverage:h}},En=()=>{let e=In();return i.jsx(Ln,{...e})},Dn=e=>{var t;return i.jsx("div",{ref:e.containerRef,className:"oui-h-full",children:(((t=e.containerSize)==null?void 0:t.width)||0)>=572?i.jsx(Rn,{...e}):i.jsx(An,{...e})})},Rn=e=>{var s;let{t}=w();return i.jsxs(ye,{cols:2,width:"100%",gap:3,className:"oui-auto-rows-fr",style:{height:(s=e.containerSize)==null?void 0:s.height},children:[i.jsxs(m,{direction:"column",itemAlign:"start",pt:3,pb:3,r:"2xl",className:"oui-bg-base-9",children:[i.jsx(bi,{title:t("trading.orderBook"),className:"oui-pl-3 oui-text-sm"}),i.jsx(Gt,{symbol:e.symbol,height:e.containerSize?e.containerSize.height-29-24:void 0})]}),i.jsxs(m,{direction:"column",itemAlign:"start",py:3,r:"2xl",className:"oui-bg-base-9 oui-h-full",children:[i.jsx(bi,{title:t("trading.lastTrades"),className:"oui-text-sm oui-px-3"}),i.jsx(Zt,{symbol:e.symbol,style:{height:e.containerSize&&e.containerSize.height-29-24},classNames:{listHeader:"oui-px-3",list:"oui-px-3"}})]})]})},An=e=>{var s;let{t}=w();return i.jsx(M,{pt:3,pb:3,pr:0,r:"2xl",className:"oui-bg-base-9",style:{maxHeight:(s=e.containerSize)==null?void 0:s.height},children:i.jsxs(nt,{value:e.tab,variant:"contained",onValueChange:r=>{e.setTab(r)},classNames:{tabsList:"oui-pl-3"},size:"lg",children:[i.jsx(Q,{value:"orderBook",title:t("trading.orderBook"),children:i.jsx(Gt,{symbol:e.symbol,height:e.containerSize?e.containerSize.height-29-18:void 0})}),i.jsx(Q,{value:"lastTrades",title:t("trading.lastTrades"),children:i.jsx(Zt,{symbol:e.symbol,style:{height:e.containerSize&&e.containerSize.height-29-18},classNames:{root:"oui-pt-[6px]",listHeader:"oui-px-3",list:"oui-px-3"}})})]})})},bi=e=>i.jsx(x,{size:"base",intensity:80,className:b("oui-pb-[5px]",e.className),children:e.title}),zn=e=>{let[t,s]=u.useState(void 0),[r,o]=u.useState("orderBook"),a=u.useRef();return u.useEffect(()=>{let n=new ResizeObserver(d=>{for(let c of d){let{width:h,height:p}=c.contentRect;s({width:h,height:p})}}),l=a.current;return l&&n.observe(l),()=>{l&&n.unobserve(l)}},[]),{symbol:e,containerSize:t,containerRef:a,tab:r,setTab:o}},$n=e=>{let t=zn(e.symbol);return i.jsx(Dn,{...t})},Bn=e=>{let{onMouseDown:t,mode:s="horizontal",...r}=e,o=u.useMemo(()=>{var n;return(n=e.className)==null?void 0:n.split(" ").includes("disable")},[e.className]),a=u.useMemo(()=>{var n;return(n=e.className)==null?void 0:n.split(" ").filter(l=>l!=="disable")},[e.className]);return i.jsx("div",{...r,className:b(a,"!oui-transition-none","!oui-shadow-none !oui-bg-transparent","hover:!oui-bg-primary-light hover:!oui-shadow-[0px_0px_4px_0px] hover:!oui-shadow-primary-light/80","active:!oui-bg-primary-light active:!oui-shadow-[0px_0px_4px_0px] active:!oui-shadow-primary-light/80","focus:!oui-bg-primary-light focus:!oui-shadow-[0px_0px_4px_0px] focus:!oui-shadow-primary-light/80",s==="horizontal"?"!oui-w-[2px] !oui-min-w-[2px]  !oui-mx-1":"!oui-h-[2px] !oui-min-h-[2px]  !oui-my-1",o&&"oui-pointer-events-none"),children:i.jsx("div",{onMouseDown:t,className:b("!oui-transition-none",s==="horizontal"?"after:!oui-w-[2px]":"after:!oui-h-[2px]","after:!oui-bg-transparent after:!oui-shadow-transparent")})})},Ze=u.forwardRef((e,t)=>{let{onSizeChange:s,...r}=e;return i.jsx(Ri,{ref:t,...r,lineBar:!0,renderBar:o=>i.jsx(Bn,{...o,mode:e.mode}),onDragEnd:(o,a,n)=>{s==null||s(`${a}`)}})}),Hn=()=>i.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"oui-rounded-full",children:[i.jsxs("g",{clipPath:"url(#a)",children:[i.jsx("path",{d:"m31.002 14.493-8.326-22.51L.166.31l8.327 22.51z",fill:"#03435D"}),i.jsx("path",{d:"m4.456-8.716-18.03 15.84 15.84 18.03 18.03-15.84z",fill:"#157CF2"}),i.jsx("path",{d:"m17.548 38.67 22.825-7.416-7.416-22.825-22.826 7.416z",fill:"#F3E200"})]}),i.jsx("defs",{children:i.jsx("clipPath",{id:"a",children:i.jsx("rect",{width:"24",height:"24",rx:"12",fill:"#fff"})})})]}),Vn=()=>i.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M5.832 2.492A3.333 3.333 0 0 0 2.5 5.826v5a3.333 3.333 0 0 0 3.333 3.333 3.333 3.333 0 0 0 3.334 3.333h5a3.333 3.333 0 0 0 3.333-3.333v-5a3.333 3.333 0 0 0-3.333-3.333 3.333 3.333 0 0 0-3.334-3.334zm8.334 5c.92 0 1.666.746 1.666 1.667v5c0 .92-.746 1.666-1.666 1.666h-5c-.92 0-1.667-.745-1.667-1.666h3.333a3.333 3.333 0 0 0 3.334-3.334z",fill:"rgb(var(--oui-color-primary))"})}),fi=e=>{let{size:t=20}=e;return i.jsxs("svg",{width:t,height:t,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsxs("g",{clipPath:"url(#a)",children:[i.jsx("path",{d:"M10 20c5.542 0 10-4.458 10-10S15.542 0 10 0 0 4.458 0 10s4.458 10 10 10",fill:"#2775CA"}),i.jsx("path",{d:"M13 11.473c0-1.452-.94-1.95-2.82-2.158-1.344-.166-1.613-.498-1.613-1.078s.448-.955 1.343-.955c.806 0 1.254.25 1.478.872.045.124.18.207.313.207h.717c.179 0 .313-.125.313-.29v-.042c-.179-.913-.985-1.618-2.015-1.701v-.996c0-.166-.134-.29-.358-.332h-.671c-.18 0-.314.124-.359.332v.954c-1.343.166-2.194.996-2.194 2.034 0 1.369.896 1.908 2.776 2.116 1.254.207 1.657.456 1.657 1.12s-.627 1.12-1.477 1.12c-1.165 0-1.568-.456-1.702-1.078a.32.32 0 0 0-.313-.25h-.762c-.179 0-.313.125-.313.291v.042c.179 1.037.895 1.784 2.373 1.991v.996c0 .166.134.29.358.332h.672c.18 0 .313-.124.358-.332v-.996C12.105 13.465 13 12.593 13 11.473",fill:"#fff",fillOpacity:".98"}),i.jsx("path",{d:"M7.74 16.57c-3.458-1.215-5.23-4.986-3.945-8.324.665-1.821 2.127-3.208 3.944-3.859.178-.086.266-.216.266-.433v-.607c0-.174-.088-.304-.266-.347-.044 0-.133 0-.177.043-4.21 1.3-6.516 5.68-5.186 9.798.798 2.428 2.704 4.292 5.186 5.072.177.087.355 0 .399-.173.044-.043.044-.087.044-.173v-.608c0-.13-.133-.303-.266-.39m4.698-13.527c-.178-.086-.355 0-.4.174-.043.043-.043.086-.043.173v.607c0 .174.133.347.266.434 3.457 1.213 5.23 4.985 3.944 8.323-.664 1.821-2.127 3.209-3.944 3.859-.178.086-.266.216-.266.433v.607c0 .174.088.304.266.347.044 0 .133 0 .177-.043 4.21-1.3 6.515-5.68 5.186-9.798-.798-2.471-2.748-4.335-5.186-5.116",fill:"#fff"})]}),i.jsx("defs",{children:i.jsx("clipPath",{id:"a",children:i.jsx("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]})},qn=e=>{let{size:t=20}=e;return i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsxs("g",{clipPath:"url(#clip0_6403_64483)",children:[i.jsx("path",{d:"M10.0245 19.9493C15.5198 19.9493 19.9747 15.4944 19.9747 9.99908C19.9747 4.50371 15.5198 0.0488281 10.0245 0.0488281C4.5291 0.0488281 0.0742188 4.50371 0.0742188 9.99908C0.0742188 15.4944 4.5291 19.9493 10.0245 19.9493Z",fill:"url(#paint0_linear_6403_64483)"}),i.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.1553 4.89304C14.2199 4.94541 14.1821 5.04758 14.0989 5.04758H5.95035C5.86716 5.04758 5.82936 4.94541 5.894 4.89304C7.0223 3.97912 8.45953 3.43164 10.0246 3.43164C11.5898 3.43164 13.0269 3.97912 14.1553 4.89304Z",fill:"white"}),i.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.47013 11.7869C7.42315 11.7199 7.34748 11.6777 7.26565 11.6777H3.82985C3.75113 11.6777 3.69375 11.7525 3.71563 11.8281C4.5078 14.565 7.0326 16.566 10.0247 16.566C13.017 16.566 15.5417 14.565 16.3339 11.8281C16.3558 11.7525 16.2984 11.6777 16.2197 11.6777H12.7839C12.702 11.6777 12.6264 11.7199 12.5795 11.7869C12.0155 12.5911 11.0815 13.1167 10.0248 13.1167C8.96803 13.1167 8.03406 12.5911 7.47013 11.7869Z",fill:"white"}),i.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.3347 7.90519C12.3822 7.95756 12.449 7.9891 12.5196 7.9891H16.1137C16.1952 7.9891 16.253 7.90983 16.2261 7.83301C15.9724 7.10689 15.5948 6.43893 15.1187 5.85447C15.074 5.79961 15.0067 5.76855 14.9358 5.76855H5.11323C5.04247 5.76855 4.97512 5.79961 4.93044 5.85447C4.45429 6.43893 4.0767 7.10689 3.82306 7.83301C3.79622 7.90983 3.85398 7.9891 3.93536 7.9891H7.52952C7.60022 7.9891 7.66694 7.95756 7.71445 7.90519C8.28491 7.2763 9.10861 6.88136 10.0246 6.88136C10.9405 6.88136 11.7643 7.2763 12.3347 7.90519Z",fill:"white"}),i.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.1164 10.9586C13.0553 10.9586 13.0118 10.899 13.0284 10.8401C13.1033 10.5722 13.1433 10.2898 13.1433 9.9981C13.1433 9.58758 13.064 9.19556 12.9199 8.83657C12.8954 8.77581 12.9392 8.70801 13.0046 8.70801H16.392C16.4349 8.70801 16.472 8.73831 16.4799 8.78052C16.5538 9.17511 16.5925 9.58216 16.5925 9.9982C16.5925 10.2978 16.5724 10.5926 16.5337 10.8815C16.5277 10.9258 16.4897 10.9586 16.4451 10.9586H13.1164ZM7.02223 10.8401C7.03868 10.899 6.99532 10.9586 6.93421 10.9586H3.60551C3.56084 10.9586 3.52285 10.9258 3.5169 10.8815C3.47807 10.5926 3.45801 10.2978 3.45801 9.9982C3.45801 9.58216 3.4967 9.17511 3.57069 8.78052C3.57859 8.73831 3.61563 8.70801 3.65856 8.70801H7.04593C7.11141 8.70801 7.15516 8.77581 7.13076 8.83657C6.98657 9.19556 6.90722 9.58758 6.90722 9.9981C6.90722 10.2898 6.94728 10.5722 7.02223 10.8401Z",fill:"white"})]}),i.jsxs("defs",{children:[i.jsxs("linearGradient",{id:"paint0_linear_6403_64483",x1:"10.0245",y1:"0.0488561",x2:"10.0245",y2:"19.9493",gradientUnits:"userSpaceOnUse",children:[i.jsx("stop",{stopColor:"#C750FF"}),i.jsx("stop",{offset:"1",stopColor:"#5800E8"})]}),i.jsx("clipPath",{id:"clip0_6403_64483",children:i.jsx("rect",{width:"20",height:"20",fill:"white"})})]})]})},Fn=e=>{let{t}=w();return i.jsxs(m,{direction:"column",gap:4,children:[i.jsx(Un,{...e}),i.jsx(Wn,{...e}),i.jsx(Qn,{...e}),i.jsxs(m,{gap:3,width:"100%",justify:"center",children:[e.showGetTestUSDC&&i.jsx(J,{variant:"outlined",size:"md",onClick:e.onGetTestUSDC,fullWidth:!0,loading:e.gettingTestUSDC,className:"oui-border-primary-light oui-text-primary-light",children:t("trading.faucet.getTestUSDC")}),i.jsx(J,{variant:"outlined",color:"danger",size:"md",onClick:e.onDisconnect,className:e.showGetTestUSDC?"oui-w-full":"oui-w-[50%]",children:t("connector.disconnect")})]})]})},Un=e=>i.jsxs(m,{width:"100%",justify:"between",children:[i.jsxs(m,{gap:3,children:[i.jsx(Hn,{}),i.jsxs(m,{direction:"column",justify:"start",itemAlign:"start",className:"oui-gap-[2px]",children:[i.jsx(x.formatted,{rule:"address",children:e.address}),i.jsx(x.formatted,{size:"2xs",intensity:80,prefix:i.jsx("div",{className:"oui-h-1 oui-w-1 oui-rounded-full oui-bg-success oui-pr-1"}),children:e.chainName})]})]}),i.jsx("button",{className:"oui-cursor-pointer",onClick:()=>{e.onCopyAddress()},children:i.jsx(Vn,{})})]}),Wn=e=>{let{t}=w();return i.jsxs(m,{direction:"column",gap:3,r:"lg",p:3,className:"oui-bg-base-6",width:"100%",children:[i.jsx("button",{onClick:e.onClickReferral,className:"oui-cursor-pointer oui-w-full",children:i.jsxs(m,{justify:"between",width:"100%",children:[i.jsx(x,{size:"2xs",children:t("affiliate.referral")}),i.jsx(Ii,{color:"white",opacity:.98,size:16})]})}),e.isAffiliate&&i.jsxs(m,{gradient:"primary",p:4,r:"lg",width:"100%",angle:180,justify:"between",children:[i.jsxs(m,{direction:"column",itemAlign:"start",children:[i.jsx(x,{size:"xs",children:t("common.affiliate")}),i.jsxs(x,{size:"2xs",intensity:54,children:["(",t("affiliate.commission.30d"),")"]})]}),i.jsxs(m,{className:"oui-gap-[6px]",children:[i.jsx(fi,{}),i.jsx(x.numeral,{dp:2,padding:!1,rm:L.ROUND_DOWN,rule:"price",children:e.affiliateCommission30D??"--"})]})]}),e.isTrader&&i.jsxs(m,{gradient:"success",p:4,r:"lg",width:"100%",angle:180,justify:"between",children:[i.jsxs(m,{direction:"column",itemAlign:"start",children:[i.jsx(x,{size:"xs",children:t("affiliate.trader")}),i.jsxs(x,{size:"2xs",intensity:54,children:["(",t("affiliate.commission.30d"),")"]})]}),i.jsxs(m,{className:"oui-gap-[6px]",children:[i.jsx(fi,{}),i.jsx(x.numeral,{dp:2,padding:!1,rm:L.ROUND_DOWN,rule:"price",children:e.traderCommission30D??"--"})]})]})]})},Qn=e=>{var s;let{t}=w();return i.jsxs(m,{direction:"column",gap:3,r:"lg",p:3,className:"oui-bg-base-6",width:"100%",children:[i.jsx("button",{onClick:e.onClickTradingRewards,className:"oui-cursor-pointer oui-w-full",children:i.jsxs(m,{justify:"between",width:"100%",children:[i.jsxs(m,{gap:1,className:"oui-text-base-contrast oui-text-2xs",children:[i.jsx(x,{children:t("common.tradingRewards")}),i.jsxs(x,{intensity:54,children:["(",i.jsx(x,{children:`${(s=t("tradingRewards.epoch"))==null?void 0:s.toLowerCase()} `}),i.jsx(x,{intensity:98,children:e.curEpochId})," )"]})]}),i.jsx(Ii,{color:"white",opacity:.98,size:16})]})}),i.jsxs(m,{p:4,r:"lg",width:"100%",angle:180,justify:"between",className:"oui-bg-gradient-to-t oui-from-[#2d0061] oui-to-[#bd6bed]",children:[i.jsx(x,{size:"2xs",intensity:80,children:t("tradingRewards.myEstRewards")}),i.jsxs(m,{className:"oui-gap-[6px]",children:[i.jsx(qn,{}),i.jsx(x.numeral,{dp:2,padding:!1,rm:L.ROUND_DOWN,rule:"price",children:e.estRewards})]})]})]})},Kn=e=>{let{t}=w(),[s]=B("orderly_link_device",{}),{account:r,state:o}=ue(),a=r.accountId,n=r.address,{hide:l}=cr(),d=ft(),{connectedChain:c,disconnect:h,namespace:p}=ki(),g=r.chainId||(c==null?void 0:c.id)||(s==null?void 0:s.chainId),y=u.useMemo(()=>g?(o.status===F.EnableTrading||o.status===F.EnableTradingWithoutConnected)&&Ti(parseInt(g)):!1,[o.status,g]),f=Xn(g),C=d.get("operatorUrl"),j=()=>{navigator.clipboard.writeText(n??""),W.success(t("common.copy.copied"))},{affiliateCommission30D:_,traderCommission30D:P,isAffiliate:k,isTrader:v,onClickReferral:S}=Yn(e.onClickReferral),{curEpochId:T,estRewards:I,onClickTradingRewards:z}=Zn(e.onClickTradingRewards),Z=async()=>{var $;localStorage.removeItem("orderly_link_device"),await h({label:($=o.connectWallet)==null?void 0:$.name}),await r.disconnect(),l()},[K,{isMutating:R}]=Pi(`${C}/v1/faucet/usdc`);return{accountId:a,address:n,chainId:g,chainName:f,onCopyAddress:j,affiliateCommission30D:_,onClickReferral:S,isAffiliate:k,isTrader:v,traderCommission30D:P,curEpochId:T,onClickTradingRewards:z,estRewards:I,onDisconnect:Z,showGetTestUSDC:y,onGetTestUSDC:()=>{if(o.status<F.EnableTrading&&o.status!==F.EnableTradingWithoutConnected)return;let $=t("trading.faucet.getTestUSDC.success",{quantity:p===Oi.solana?"100":"1,000"});return K({chain_id:g==null?void 0:g.toString(),user_address:o.address,broker_id:d.get("brokerId")}).then(U=>{if(U.success)return ee.alert({title:t("trading.faucet.getTestUSDC"),message:$,onOk:()=>Promise.resolve(!0)});U.message&&W.error(U.message)},U=>{W.error(U.message)})},gettingTestUSDC:R}},Yn=e=>{let{data:t,isAffiliate:s,isTrader:r}=mr(),o=u.useMemo(()=>{if(s)return t==null?void 0:t.referrer_info["30d_referrer_rebate"]},[t]),a=u.useMemo(()=>{if(r)return t==null?void 0:t.referee_info["30d_referee_rebate"]},[t]);return{onClickReferral:()=>{e==null||e()},affiliateCommission30D:o,traderCommission30D:a,isAffiliate:s,isTrader:r}},Zn=e=>{let[t]=pr(si.normal),[s,r]=gr(si.normal),o=u.useMemo(()=>{var n;return((n=r.curEpochInfo)==null?void 0:n.epoch_id)??"--"},[r]),a=u.useMemo(()=>typeof(t==null?void 0:t.est_r_wallet)>"u"?"--":t==null?void 0:t.est_r_wallet,[t]);return{curEpochId:o,estRewards:a,onClickTradingRewards:()=>{e==null||e()}}};function Xn(e){let[t,{findByChainId:s}]=hr("mainnet",{pick:"network_infos",filter:r=>{var o,a;return((o=r.network_infos)==null?void 0:o.bridge_enable)||((a=r.network_infos)==null?void 0:a.bridgeless)}});return u.useMemo(()=>{let r=s(parseInt(e),"network_infos");return r?r.name:"Unknown"},[e,s])}var Gn=e=>{let t=Kn(e);return i.jsx(Fn,{...t})},Jn=()=>{let{t:e}=w(),{referral:t,tradingRewards:s,bottomSheetLeading:r}=je(),{account:o,state:a}=ue();return{onShowAccountSheet:()=>{ee.sheet({title:e("common.account"),leading:r,content:i.jsx(Gn,{...t,...s})})},address:o.address,state:a}},el=e=>i.jsx(Di,{buttonProps:{size:"sm"},children:i.jsx(J,{variant:"gradient",size:"sm",className:"oui-max-w-[83px]",onClick:t=>{e.onShowAccountSheet()},children:dr(e.address,[4,4])})});lr({name:"mobile-account-menu",positions:[ur.MobileAccountMenu],builder:Jn,__isInternal:!0})(e=>i.jsx(el,{...e}));var tl=()=>{let{account:e}=ue(),t=il(),s=sl(),r=xt(),{t:o}=w(),[a,n]=u.useState(!1),l=u.useCallback(async()=>e.settle().catch(h=>{if(h.code==-1104)return W.error(o("settle.settlement.error")),Promise.reject(h);if(h.message.indexOf("Signing off chain messages with Ledger is not yet supported")!==-1)return r.emit("wallet:sign-message-with-ledger-error",{message:h.message,userAddress:e.address}),Promise.reject(h);if((h==null?void 0:h.code)==="ACTION_REJECTED")return W.error(o("connector.userRejected")),Promise.reject(h)}).then(h=>(W.success(o("settle.settlement.requested")),Promise.resolve(h))),[e,o]),d=u.useCallback(()=>{ee.show(Lt,{activeTab:"deposit"})},[]),c=u.useCallback(()=>{ee.show(Lt,{activeTab:"withdraw"})},[]);return{...t,...s,onSettlePnL:l,onDeposit:d,onWithdraw:c,showSliderTip:a,setShowSliderTip:n}},il=()=>{let{hideAssets:e,setHideAssets:t}=Te(),s=()=>{t(!e)},{totalCollateral:r,freeCollateral:o,totalValue:a,availableBalance:n}=vt({dp:2});return{hideAssets:e,toggleHideAssets:s,totalCollateral:r,freeCollateral:o,totalValue:a,availableBalance:n}},sl=()=>{let{t:e}=w(),[{aggregated:t,totalUnrealizedROI:s},r]=rt(),{marginRatio:o,currentLeverage:a,mmr:n}=gt(),l=u.useMemo(()=>Math.min(10,t.notional===0?r.margin_ratio(10):o),[o,t]),{update:d,curLeverage:c,maxLeverage:h,leverageLevers:p}=Vt(),g=u.useMemo(()=>p==null?void 0:p.map(S=>({label:`${S}x`,value:S})),[p]),[y,f]=u.useState(c??0),C=100/(((g==null?void 0:g.length)||0)-1),j=S=>{f(S)},_=async S=>{try{d({leverage:S}).then(()=>{W.success(e("leverage.updated"))},T=>{W.error(T.message)})}catch{}},P=u.useCallback(S=>{_(Array.isArray(S)?S[0]:S)},[]),k=Us(P,500),v=u.useCallback(S=>{let T=Number.parseInt(S.target.value,10),I=Number.isNaN(T)?0:T,z=Math.min(Math.max(I,1),h);f(z),k(z)},[k,h]);return{aggregated:t,totalUnrealizedROI:s,positionsInfo:r,marginRatio:o,marginRatioVal:l,mmr:n,currentLeverage:a,step:C,marks:g,onLeverageChange:j,onLeverageIncrease:()=>{f(S=>(_(S+1),S+1))},onLeverageReduce:()=>{f(S=>(_(S-1),S-1))},onInputChange:v,isReduceDisabled:y<=1,isIncreaseDisabled:y>=h,onValueCommit:P,value:y,maxLeverage:h,onSaveLeverage:_}};function rl(e,t){if(t===null)return{isRed:!1,isYellow:!1,isGreen:!0};let s=t*2,r=e<=s,o=e>s&&e<1,a=e>=1;return{high:r,mid:o,low:a}}var ol=e=>{let{size:t=20,className:s}=e;return i.jsx("div",{className:"oui-flex oui-justify-center oui-items-end",style:{background:"url(/images/riskLevelBg.png)",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center bottom",width:`${t}px`,height:"14px"},children:i.jsx("div",{className:b("oui-relative oui-w-[2px] oui-h-[2px] oui-rounded-full oui-bg-white after:oui-block after:oui-content-[''] after:oui-absolute after:oui-right-0 after:oui-w-[10px] after:oui-h-[2px] after:oui-bg-white/50",s)})})},al=e=>i.jsxs(m,{direction:"column",gap:4,width:"100%",children:[i.jsx(nl,{...e}),i.jsx(te,{className:"oui-w-full"}),i.jsx(ll,{...e}),i.jsx(ul,{...e})]}),nl=e=>{let{t}=w(),s=u.useCallback(()=>ee.confirm({title:t("settle.settlePnl"),content:i.jsx(x,{intensity:54,size:"xs",children:i.jsx(Mt,{i18nKey:"settle.settlePnl.description"})}),onCancel:()=>Promise.reject(),onOk:()=>typeof e.onSettlePnL!="function"?Promise.resolve():e.onSettlePnL().catch(o=>{})}),[t]),r=e.totalUnrealizedROI>0?"oui-text-success-darken":"oui-text-danger-darken";return i.jsxs(m,{direction:"column",gap:3,width:"100%",children:[i.jsxs(m,{direction:"column",itemAlign:"start",width:"100%",children:[i.jsx(x.formatted,{size:"2xs",intensity:36,suffix:e.hideAssets?i.jsx(Ut,{opacity:1,size:16,className:"oui-text-primary-light"}):i.jsx(Wt,{opacity:1,size:16,className:"oui-text-primary-light"}),onClick:()=>{e.toggleHideAssets()},className:"oui-cursor-pointer",children:`${t("common.totalValue")} (USDC)`}),i.jsx(x.numeral,{size:"base",dp:2,padding:!1,visible:!e.hideAssets,children:e.totalValue??"--"})]}),i.jsxs(ye,{cols:2,rows:1,width:"100%",children:[i.jsx(Be,{label:`${t("common.unrealizedPnl")} (USDC)`,classNames:{label:"oui-text-2xs oui-text-base-contrast-36"},children:i.jsxs(m,{gap:1,children:[i.jsx(x.numeral,{size:"xs",coloring:!0,dp:2,padding:!1,visible:!e.hideAssets,children:e.aggregated.unrealPnL}),!e.hideAssets&&i.jsx(x.numeral,{size:"xs",dp:2,padding:!1,rule:"percentages",prefix:"(",suffix:")",className:r,children:e.totalUnrealizedROI})]})}),i.jsx(Be,{label:`${t("trading.asset.unsettledPnl")} (USDC)`,classNames:{label:"oui-text-2xs oui-text-base-contrast-36"},children:i.jsxs(m,{justify:"between",width:"100%",children:[i.jsx(x.numeral,{size:"xs",coloring:!0,dp:2,padding:!1,visible:!e.hideAssets,children:e.aggregated.unsettledPnL}),i.jsxs("button",{className:"oui-flex oui-gap-1 oui-items-center",onClick:s,children:[i.jsx(Ws,{opacity:1,size:12,className:"oui-text-primary-light"}),i.jsx(x,{size:"2xs",color:"primary",children:t("settle.settlePnl")})]})]})})]})]})},ll=e=>{let{t}=w(),{high:s,mid:r,low:o}=rl(e.marginRatioVal,e.mmr);return i.jsxs(ye,{cols:2,rows:1,width:"100%",children:[i.jsx(Be,{label:t("trading.asset.marginRatio"),classNames:{label:"oui-text-2xs oui-text-base-contrast-36"},children:i.jsxs(m,{gap:2,children:[i.jsx(x.numeral,{size:"xs",rule:"percentages",color:"primary",dp:2,padding:!1,visible:!e.hideAssets,children:e.marginRatioVal}),!e.hideAssets&&i.jsx(ol,{className:o?"oui-rotate-0":r?"oui-rotate-90":s?"oui-rotate-180":""})]})}),i.jsx(Be,{label:`${t("trading.asset.free&TotalCollateral")} (USDC)`,classNames:{label:"oui-text-2xs oui-text-base-contrast-36"},children:i.jsxs(m,{justify:"start",width:"100%",gap:1,children:[i.jsx(x.numeral,{size:"xs",dp:2,padding:!1,visible:!e.hideAssets,children:e.freeCollateral}),i.jsx(x,{size:"xs",children:"/"}),i.jsx(x.numeral,{size:"xs",dp:2,padding:!1,visible:!e.hideAssets,children:e.totalCollateral})]})})]})},ul=e=>{let{t}=w();return i.jsxs(ye,{cols:2,rows:1,gap:3,className:"oui-grid-row-[1fr,1fr]",width:"100%",pt:2,pb:4,children:[i.jsx(J,{icon:i.jsx(Ni,{color:"white",opacity:.8}),size:"md",fullWidth:!0,className:"oui-bg-base-2 hover:oui-bg-base-2/50",onClick:e.onWithdraw,children:t("common.withdraw")}),i.jsx(J,{icon:i.jsx(tt,{color:"white",opacity:.8}),size:"md",fullWidth:!0,onClick:e.onDeposit,children:t("common.deposit")})]})},dl=()=>{let e=tl();return i.jsx(al,{...e})},cl=e=>{let{symbol:t,sharePnLConfig:s}=e,[r,o]=u.useState("Position"),[a,n]=u.useState("Position history"),{t:l}=w(),{onSymbolChange:d}=je(),c=Te(),[h,{cancelAllOrders:p,cancelAllTPSLOrders:g}]=Ce({}),{positionCount:y}=ns(t),{pendingOrderCount:f,tpSlOrderCount:C}=ls(t);return{tab:r,setTab:o,subTab:a,setSubTab:n,sharePnLConfig:s,symbol:t,positionCount:y,pendingOrderCount:f,tpSlOrderCount:C,...c,onCloseAll:j=>{let _=j===re.pending?l("orders.pending.cancelAll"):j===re.tp_sl?l("orders.tpsl.cancelAll"):"",P=j===re.pending?l("orders.pending.cancelAll.description"):j===re.tp_sl?l("orders.tpsl.cancelAll.description"):"";ee.confirm({title:_,content:i.jsx(x,{size:"2xs",children:P}),onOk:async()=>{try{return r==="TP/SL"?await g():await p(),Promise.resolve(!0)}catch(k){return(k==null?void 0:k.message)!==void 0&&toast.error(k.message),Promise.resolve(!1)}finally{Promise.resolve()}}})},onSymbolChange:d}},hl=e=>{let{t}=w();return i.jsxs(nt,{value:e.tab,onValueChange:s=>e.setTab(s),size:"lg",className:e.className,classNames:{tabsList:"oui-bg-base-9 oui-rounded-t-xl oui-p-2 oui-overflow-x-scroll oui-hide-scrollbar"},children:[i.jsx(Q,{title:`${t("common.positions")} ${(e.positionCount??0)>0?`(${e.positionCount})`:""}`,value:"Position",children:i.jsx(ml,{...e})}),i.jsx(Q,{title:`${t("orders.status.pending")} ${(e.pendingOrderCount??0)>0?`(${e.pendingOrderCount})`:""}`,value:"Pending",children:i.jsx(Bt,{type:re.pending,ordersStatus:se.INCOMPLETE,...e})}),i.jsx(Q,{title:`${t("common.tpsl")} ${(e.tpSlOrderCount??0)>0?`(${e.tpSlOrderCount})`:""}`,value:"TP/SL",children:i.jsx(Bt,{type:re.tp_sl,ordersStatus:se.INCOMPLETE,...e})}),i.jsx(Q,{title:t("trading.history"),value:"History",children:i.jsx(gl,{...e})}),i.jsx(Q,{title:t("positions.liquidation"),value:"Liquidation",children:i.jsx(br,{enableLoadMore:!0,symbol:e.showAllSymbol?void 0:e.symbol,classNames:{cell:"oui-p-2 oui-bg-base-9 oui-rounded-xl"}})})]})},ml=e=>i.jsxs(m,{direction:"column",gap:2,children:[i.jsx(as,{pnlNotionalDecimalPrecision:e.pnlNotionalDecimalPrecision,symbol:e.showAllSymbol?void 0:e.symbol,unPnlPriceBasis:e.unPnlPriceBasis}),i.jsx(jr,{symbol:e.showAllSymbol?void 0:e.symbol,onSymbolChange:e.onSymbolChange,sharePnLConfig:e.sharePnLConfig,pnlNotionalDecimalPrecision:e.pnlNotionalDecimalPrecision})]}),Bt=e=>i.jsxs(m,{direction:"column",pb:2,width:"100%",children:[i.jsx(te,{className:"oui-w-full"}),e.type!==re.orderHistory&&i.jsx(pl,{...e}),i.jsx(wr,{symbol:e.showAllSymbol?void 0:e.symbol,onSymbolChange:e.onSymbolChange,type:e.type,ordersStatus:e.ordersStatus,classNames:{root:"oui-w-full oui-hide-scrollbar oui-overflow-y-hidden",content:"!oui-space-y-1",cell:"oui-py-2 oui-bg-base-9 oui-p-2 oui-rounded-xl"},sharePnLConfig:e.sharePnLConfig,showFilter:e.type===re.orderHistory,filterConfig:{range:{from:void 0,to:void 0}}})]}),pl=e=>{let{t}=w();return i.jsxs(m,{px:2,py:2,width:"100%",justify:"between",gap:2,className:"oui-rounded-b-xl oui-bg-base-9",children:[i.jsxs(m,{className:"oui-gap-[2px] oui-cursor-pointer",children:[i.jsx(fe,{color:"white",checked:!e.showAllSymbol,onCheckedChange:s=>{e.setShowAllSymbol(!s)}}),i.jsx(x,{size:"2xs",intensity:54,onClick:()=>{e.setShowAllSymbol(!e.showAllSymbol)},children:t("trading.hideOtherSymbols")})]}),i.jsx(J,{variant:"outlined",size:"xs",color:"secondary",onClick:s=>{e.onCloseAll(e.type)},children:t("trading.orders.closeAll")})]})},gl=e=>{let{t}=w();return i.jsx("div",{className:"oui-min-h-[300px]",children:i.jsxs(nt,{value:e.subTab,onValueChange:s=>e.setSubTab(s),size:"md",classNames:{tabsList:"oui-bg-base-9 oui-rounded-t-xl oui-p-2"},children:[i.jsx(Q,{title:t("positions.positionHistory"),value:"Position history",children:i.jsx(_r,{symbol:e.showAllSymbol?void 0:e.symbol,onSymbolChange:e.onSymbolChange,classNames:{cell:"oui-p-2 oui-bg-base-9 oui-rounded-xl"},sharePnLConfig:e.sharePnLConfig})}),i.jsx(Q,{title:t("orders.orderHistory"),value:"Order history",children:i.jsx(Bt,{type:re.orderHistory,...e})})]})})},xl=e=>{let t=cl(e);return i.jsx(hl,{...t,className:e.className})},bl=e=>{let[t,s]=u.useState(0),r=u.useRef(null);return u.useEffect(()=>{let o=r.current;if(!o)return;let a=new ResizeObserver(n=>{for(let l of n)s(l.contentRect.height)});return a.observe(o),()=>{a.unobserve(o)}},[]),i.jsxs("div",{className:b("oui-grid oui-grid-cols-[4fr,6fr] oui-gap-1 oui-mx-1 ",e.className),children:[i.jsx("div",{className:"oui-bg-base-9 oui-rounded-xl",style:{height:`${t+16}px`},children:i.jsx(Gt,{symbol:e.symbol,height:t?t-44:void 0})}),i.jsx("div",{className:"oui-bg-base-9 oui-rounded-xl oui-p-2",children:i.jsx(qi,{symbol:e.symbol,containerRef:r})})]})},fl=()=>{let{symbol:e}=je();return{symbol:e}},yl=e=>{let t=fl();return i.jsx(bl,{className:e.className,...t})},vl=()=>{let[e,t]=u.useState("chart"),{symbol:s}=je(),[r,o]=u.useState(!0);return{tab:e,setTab:t,symbol:s,toggleContentVisible:()=>{o(a=>!a)},setVisible:o,visible:r}},Cl=e=>i.jsx(Zt,{symbol:e.symbol,classNames:{root:"oui-px-3 ",list:"oui-min-h-[141px] oui-max-h-[202px] oui-w-full",listHeader:"oui-text-xs oui-text-base-contrast-36",listItem:{left:"oui-text-xs",mid:"oui-text-xs",right:"oui-text-xs"}}}),jl=e=>{var s,r,o,a;let{t}=w();return i.jsxs(m,{direction:"column",gap:2,children:[i.jsx(De,{title:t("common.markPrice"),value:(s=e.ticker)==null?void 0:s.mark_price,dp:e.symbolInfo.quote_dp}),i.jsx(De,{title:t("common.indexPrice"),value:(r=e.ticker)==null?void 0:r.index_price,dp:e.symbolInfo.quote_dp}),i.jsx(De,{title:t("markets.column.24hVolume"),value:e.vol_24h,dp:e.symbolInfo.quote_dp,rule:"human",showUSDC:!0}),i.jsx(De,{title:t("trading.column.24High"),value:(o=e.ticker)==null?void 0:o["24h_high"],dp:e.symbolInfo.quote_dp}),i.jsx(De,{title:t("trading.column.24Low"),value:(a=e.ticker)==null?void 0:a["24h_low"],dp:e.symbolInfo.quote_dp}),i.jsx(De,{title:t("markets.openInterest"),value:e.openInterest,dp:e.symbolInfo.quote_dp,rule:"human",showUSDC:!0})]})},De=e=>{let{title:t,value:s,showUSDC:r,dp:o,rule:a="price"}=e;return i.jsxs(m,{justify:"between",width:"100%",className:"oui-text-xs",children:[i.jsx(x,{intensity:36,children:t}),i.jsxs(m,{gap:1,children:[i.jsx(x.numeral,{rule:a,dp:o,intensity:80,children:s}),r&&i.jsx(x,{intensity:36,children:"USDC"})]})]})},wl=e=>{let{symbol:t}=e,s=Ks(t),{symbolInfo:r}=je(),o=u.useMemo(()=>{let n=s==null?void 0:s["24h_close"],l=s==null?void 0:s["24h_volume"];if(n&&l&&!isNaN(n)&&!isNaN(l))return new L(n).mul(l).toFixed(r.quote_dp,L.ROUND_DOWN)},[s]),a=u.useMemo(()=>{let n=s==null?void 0:s.mark_price,l=s==null?void 0:s.open_interest;if(n&&l&&!isNaN(n))return new L(n).mul(Number(l)).toFixed(r.quote_dp,L.ROUND_DOWN)},[s]);return{ticker:s,symbolInfo:r,vol_24h:o,openInterest:a}},_l=e=>{let t=wl(e);return i.jsx(jl,{...t})},Sl=e=>i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("g",{id:"Arrows-expand",children:i.jsx("path",{id:"Vector",d:"M5.9989 1.00708C5.8709 1.00708 5.7369 1.05008 5.6394 1.14758L3.7959 3.00708L4.4989 3.71008L5.4989 2.72607V4.50708C5.4989 4.78308 5.7229 5.00708 5.9989 5.00708C6.2749 5.00708 6.4989 4.78308 6.4989 4.50708V2.72607L7.4989 3.71008L8.2019 3.00708L6.3584 1.14758C6.2604 1.05008 6.1269 1.00708 5.9989 1.00708ZM5.9989 7.00707C5.7229 7.00707 5.4989 7.23107 5.4989 7.50707V9.28808L4.4989 8.30407L3.7959 9.00707L5.6394 10.8666C5.8349 11.0616 6.1629 11.0616 6.3584 10.8666L8.2019 9.00707L7.4989 8.30407L6.4989 9.28808V7.50707C6.4989 7.23107 6.2749 7.00707 5.9989 7.00707Z"})})});function Nl(e){var t,s,r;return i.jsxs("div",{className:"oui-pb-1 oui-flex oui-flex-col oui-gap-1",style:{height:e.height},ref:e.boxRef,children:[i.jsx("div",{className:"oui-w-full oui-h-full",children:i.jsx(ss,{symbol:e.symbol,libraryPath:(t=e.tradingViewConfig)==null?void 0:t.library_path,mode:3,scriptSRC:(s=e.tradingViewConfig)==null?void 0:s.scriptSRC,customCssUrl:(r=e.tradingViewConfig)==null?void 0:r.customCssUrl,...e.tradingViewConfig})}),i.jsx("div",{className:"oui-relative oui-w-full",children:i.jsx("div",{ref:e.dragRef,className:b("oui-h-[1px] oui-absolute oui-left-0 oui-right-0 oui-bottom-0 oui-top-0 oui-z-10 oui-mt-[7px] oui-bg-base-contrast-12",e.dragging&&"oui-bg-primary "),children:i.jsx(Sl,{className:b("oui-w-3 oui-h-3 oui-absolute oui-left-1/2 -oui-top-[5px] -oui-translate-y-[0.5px] oui-text-base-contrast-12",e.dragging&&" oui-text-primary")})})})]})}var kl=354,yi=234,Pl="TRADINGVIEW_MOBILE_HEIGHT";function Tl(e){let[t,s]=B(Pl,yi),[r,o]=u.useState(!1),a=u.useRef(null),n=u.useRef(null),[l,d]=u.useState(0),c=u.useRef(0),h=u.useCallback(y=>{if(!n.current)return;o(!0);let f=y.touches[0],C=n.current.getBoundingClientRect();y.stopPropagation(),y.preventDefault();let j=f.clientY-C.bottom;c.current=C.top,d(j)},[]),p=u.useCallback(y=>{if(n.current&&r){y.stopPropagation(),y.preventDefault();let f=y.touches[0].clientY-c.current-l;return s(Math.min(Math.max(Math.round(f),yi),kl)),!1}},[r,l]),g=u.useCallback(()=>{o(!1)},[]);return u.useEffect(()=>{let y=a.current;if(y)return y.addEventListener("touchstart",h),()=>{y.removeEventListener("touchstart",h)}},[h]),u.useEffect(()=>(document.addEventListener("touchmove",p,{passive:!1}),document.addEventListener("touchend",g),()=>{document.removeEventListener("touchmove",p),document.removeEventListener("touchend",g)}),[r,p,g]),{...e,height:t,dragging:r,dragRef:a,boxRef:n}}function Ol(e){let t=Tl(e);return i.jsx(Nl,{...t})}var Ll=e=>{let{t}=w(),{tradingViewConfig:s}=je();return i.jsxs(nt,{variant:"contained",value:e.tab,contentVisible:e.visible,onValueChange:r=>{e.setTab(r),e.setVisible(!0)},className:e.className,classNames:{tabsList:"oui-p-2",tabsContent:"oui-min-h-[176px] oui-max-h-[396px]"},style:{marginBottom:e.tab==="chart"?"8px":0},trailing:i.jsx("button",{className:"oui-px-5",onClick:e.toggleContentVisible,children:i.jsx(Ml,{className:e.visible?"oui-rotate-0":"oui-rotate-180"})}),children:[i.jsx(Q,{title:t("trading.tabs.chart"),value:"chart",children:i.jsx(Ol,{symbol:e.symbol,tradingViewConfig:s})}),i.jsx(Q,{title:t("trading.tabs.trades"),value:"trades",children:i.jsx(Cl,{symbol:e.symbol})}),i.jsx(Q,{title:t("trading.tabs.data"),value:"data",children:i.jsx(M,{px:3,children:i.jsx(_l,{symbol:e.symbol})})})]})},Ml=e=>i.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:b("oui-fill-base-contrast-54 hover:oui-fill-base-contrast-80",e.className),children:[i.jsx("path",{d:"M5.721 4.585 2.726 6.578a.51.51 0 0 0-.14.7.51.51 0 0 0 .702.14l2.714-1.806 2.715 1.806c.23.153.549.089.702-.14a.51.51 0 0 0-.14-.7L6.283 4.585a.51.51 0 0 0-.562 0"}),i.jsx("defs",{})]}),Il=e=>{let t=vl();return i.jsx(Ll,{className:e.className,...t})},El=()=>i.jsx("svg",{width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:i.jsx("path",{d:"M6.456 3.48a3.5 3.5 0 0 0 .431-.567 9 9 0 0 0 .361-.654l-.648-.66-.107.185q-.071.12-.142.244a3 3 0 0 1-.27.396 1.4 1.4 0 0 1-.318.29.67.67 0 0 1-.38.114q-.307 0-.666-.194t-.742-.42q-.383-.227-.777-.42a1.7 1.7 0 0 0-.771-.194q-.401.001-.72.154a2.1 2.1 0 0 0-.57.404 2.6 2.6 0 0 0-.43.574 5 5 0 0 0-.307.646l.649.66q.165-.437.464-.833.298-.395.742-.396.347 0 .7.194.354.193.721.42.37.227.763.42.396.195.826.195.374.001.665-.155.29-.151.526-.404m.352 2.941a3.5 3.5 0 0 0 .431-.566q.196-.315.361-.654l-.648-.66-.107.184-.142.244a3 3 0 0 1-.27.396 1.4 1.4 0 0 1-.318.29.67.67 0 0 1-.38.115q-.307 0-.666-.195-.36-.193-.742-.42-.383-.226-.778-.42a1.7 1.7 0 0 0-.77-.194q-.401.001-.72.154a2.1 2.1 0 0 0-.57.405 2.6 2.6 0 0 0-.43.574 5 5 0 0 0-.307.646l.649.66q.165-.437.464-.833.297-.395.742-.396.347 0 .7.194.354.193.721.42.369.226.763.42.396.194.826.194.374.001.665-.154.29-.152.526-.404",fill:"#fff",fillOpacity:".54"})}),Dl=e=>{let{t}=w(),s=i.jsxs(M,{intensity:900,px:3,height:54,children:[i.jsx(Nr,{symbol:e.symbol,onSymbol:()=>e.onOpenMarketsSheetChange(!0),trailing:i.jsxs(m,{direction:"column",itemAlign:"end",className:"oui-cursor-pointer oui-text-[11px]",onClick:e.onShowPortfolioSheet,children:[i.jsxs(m,{children:[i.jsx(x,{intensity:54,children:t("common.totalValue")}),i.jsx("button",{onClick:r=>{r.stopPropagation(),r.preventDefault(),e.setHideAssets(!e.hideAssets)},className:"oui-px-1",children:e.hideAssets?i.jsx(Ut,{color:"primary",opacity:1,size:16,className:"oui-text-primary-light"}):i.jsx(Wt,{color:"primary",opacity:1,size:16,className:"oui-text-primary-light"})}),i.jsx(El,{})]}),i.jsx(x.numeral,{suffix:i.jsx(x,{intensity:20,children:"Â USDC"}),dp:2,visible:!e.hideAssets,children:e.canTrade?e.total??"--":"--"})]})}),i.jsx($s,{open:e.openMarketsSheet,onOpenChange:e.onOpenMarketsSheetChange,classNames:{body:"oui-h-full oui-pb-[env(safe-area-inset-bottom)]",content:"oui-w-[280px] !oui-p-0 oui-rounded-bl-[40px] oui-h-full "},contentProps:{side:"left",closeable:!1},children:i.jsx(kr,{symbol:e.symbol,onSymbolChange:r=>{var o;e.onOpenMarketsSheetChange(!1),(o=e.onSymbolChange)==null||o.call(e,r)}})})]});return i.jsx("div",{style:{paddingBottom:"calc(64px + env(safe-area-inset-bottom))"},className:"oui-relative oui-grid oui-h-[calc(100vh-44px)] oui-gap-1 oui-bg-base-10",children:i.jsxs("main",{className:"oui-hide-scrollbar oui-space-y-1 oui-overflow-y-auto",children:[s,i.jsx(Il,{className:"oui-mx-1 oui-rounded-xl oui-bg-base-9"}),i.jsx(yl,{}),i.jsx(xl,{symbol:e.symbol,className:"oui-mx-1 oui-rounded-xl",sharePnLConfig:e.sharePnLConfig})]})})},Xe=(e,t,s)=>[u.useMemo(()=>{let r=localStorage.getItem(e);return r?`${r}%`:t},[e,t,s]),r=>{localStorage.setItem(e,r)}],vi=6,Ci=48,ji=29,ce=12,Ne=54,Nt=280,Rl=360,ht=280,Al=732,xe=464,ze=728,Re=320,mt=540,vs=800,zl=()=>{let[e,t]=u.useState(!1),s=je(),{state:r}=ue(),{t:o}=w(),{wrongNetwork:a,disabledConnect:n,restrictedInfo:l}=lt(),{hideAssets:d,setHideAssets:c}=Te(),{isFirstTimeDeposit:h}=hs(),{totalValue:p}=vt(),g=le(p),y=Pe("(max-width: 1279px)"),f=Pe("(min-width: 1440px)"),C=Pe("(max-width: 1680px)"),[j,_]=B("orderly_order_entry_side_markets_layout","right"),P=u.useMemo(()=>!a&&!n&&(r.status>=F.EnableTrading||r.status===F.EnableTradingWithoutConnected),[r.status,a,n]),k=()=>{P&&ee.sheet({title:o("trading.asset&Margin"),leading:s.bottomSheetLeading,content:i.jsx(dl,{})})},v=u.useMemo(()=>f,[f]),S=Bl({canTrade:P,isFirstTimeDeposit:h}),T=$l({collapsable:f}),I=Hl(j),z=Vl({max2XL:y}),Z=T.collapsed?70:280,K=y?1200:600,R=P?379:277,$=Fl({orderEntryViewRef:z.orderEntryViewRef,tradindviewMaxHeight:K,dataListMinHeight:R}),U={layout:j,onLayout:_,max2XL:y,min3XL:f,max4XL:C,canTrade:P,openMarketsSheet:e,onOpenMarketsSheetChange:t,horizontalDraggable:v,...T,...S,...I,...z,restrictedInfo:l,...$,marketsWidth:Z,tradindviewMaxHeight:K,dataListMinHeight:R,total:g,hideAssets:d,setHideAssets:c,onShowPortfolioSheet:k};return{...s,...U}};function $l(e){let{collapsable:t}=e,[s,r]=u.useState(!1),[o,a]=B("orderly_side_markets_collapsed",void 0),n=d=>{a(d),r(!0)},l=u.useMemo(()=>t?o:!0,[t,o]);return{collapsable:t,collapsed:l,onCollapse:n,animating:s,setAnimating:r}}function Bl(e){let{canTrade:t,isFirstTimeDeposit:s}=e,[r,o]=B("orderly_assets_orderEntry_margin_positions",[0,1,2]),a=(l,d)=>{let c=[...r];if(l===0&&d===c.length-1){c[d]=r[l];for(let h=0;h<c.length-1;h++)c[h]=r[h+1]}else if(l===c.length-1&&d===0){c[d]=r[l];for(let h=1;h<c.length;h++)c[h]=r[h-1]}else[c[l],c[d]]=[c[d],c[l]];o(c)},n=u.useMemo(()=>t&&!s,[t,s]);return{positions:u.useMemo(()=>n?r:[0,1,2],[n,r]),showPositionIcon:n,updatePositions:a}}function Hl(e){let[t,s]=Xe("orderly_main_split_size",void 0,e),[r,o]=Xe("orderly_datalist_split_size","350px"),[a,n]=Xe("orderly_orderbook_split_size","280px",e),[l,d]=Xe("orderly_datalist_split_height_sm","350px"),[c,h]=Xe("orderly_orderbook_split_height_sm","280px");return{orderBookSplitSize:a,setOrderbookSplitSize:n,dataListSplitSize:r,setDataListSplitSize:o,mainSplitSize:t,setMainSplitSize:s,dataListSplitHeightSM:l,setDataListSplitHeightSM:d,orderBookSplitHeightSM:c,setOrderbookSplitHeightSM:h}}function Vl(e){let{max2XL:t}=e,[s,r]=u.useState(0),o=u.useRef(null);return u.useEffect(()=>{let a=o.current;if(!a||!t)return;let n=new ResizeObserver(l=>{for(let d of l){let c=d.contentRect.height;c&&r(c)}});return n.observe(a),()=>{n.unobserve(a)}},[o,t]),{orderEntryViewRef:o,orderEntryHeight:s}}function ql(e){return e?`${100-Math.min(Number(e),100)}`:""}function Fl(e){let{tradindviewMaxHeight:t,dataListMinHeight:s}=e,r=u.useRef(null),o=u.useRef(null),[a,n]=B("orderly_order_entry_extra_height",0),l=22,[d,c]=B("orderly_trading_data_list_height",s);return{max2XLSplitRef:o,tradingviewAndOrderbookSplitRef:r,onTradingviewAndOrderbookDragging:(h,p)=>{var P,k;let g=(P=r==null?void 0:r.current)==null?void 0:P.boxHeight;if(!g)return;let y=g*h/100,f=g*p/100,C=Math.min(Math.max(y,Re),t),j=Math.min(Math.max(f,xe),ze),_=((k=e.orderEntryViewRef.current)==null?void 0:k.clientHeight)||0;if(f>=j){let v=f-j;n(Math.max(0,a-v))}else if(C+j<t+ze){let v=C+j+l+Ne,S=Math.max(0,v-_);n(a+S)}},onDataListSplitHeightDragging:(h,p)=>{var f;let g=(f=o==null?void 0:o.current)==null?void 0:f.boxHeight;if(!g)return;let y=g*p/100;if(y>=s&&y<=vs){c(y);let C=y-d;C>0&&n(Math.max(0,a-C))}},extraHeight:a,dataListHeight:d}}var Ul=e=>{let{t}=w();return i.jsx(Wl,{...e,children:i.jsxs(m,{px:3,className:b("oui-rounded-md","oui-h-[28px]","oui-cursor-pointer oui-transition-all","oui-bg-base-6 hover:oui-bg-base-4","oui-text-base-contrast-54 hover:oui-text-base-contrast-80"),gapX:1,ml:3,justify:"center",itemAlign:"center",children:[i.jsx(Ql,{}),i.jsx(x,{size:"2xs",weight:"semibold",children:t("trading.layout")})]})})},Wl=e=>{let[t,s]=u.useState(!1),{t:r}=w(),o=n=>i.jsxs(m,{direction:"column",gapY:2,onClick:()=>{var l;(l=e.onLayout)==null||l.call(e,n),s(!1)},className:"oui-group",children:[i.jsx(m,{justify:n==="right"?"end":"start",className:b("oui-w-[148px] oui-h-[100px]","oui-bg-base-10 oui-rounded-[10px]","oui-border-[4px] oui-border-base-5 group-hover:oui-border-primary-light",e.layout===n&&"!oui-border-primary-light"),children:i.jsx(M,{p:1,children:i.jsx(Kl,{})})}),i.jsx(x,{size:"2xs",intensity:54,className:b("oui-text-base-contrast-54 group-hover:oui-text-base-contrast-80",e.layout===n&&"oui-text-base-contrast-80"),children:r(n==="right"?"trading.layout.right":"trading.layout.left")})]}),a=i.jsxs(i.Fragment,{children:[i.jsxs(m,{itemAlign:"center",justify:"between",mt:3,className:"oui-mb-[10px]",children:[i.jsx(x,{size:"base",intensity:98,children:r("trading.layout")}),i.jsx(Bs,{size:16,className:"oui-text-base-contrast-80 oui-cursor-pointer",opacity:.98,onClick:()=>{s(!1)}})]}),i.jsx(te,{}),i.jsxs(m,{gapX:6,mt:5,children:[o("right"),o("left")]})]});return i.jsxs(Ve,{open:t,onOpenChange:s,children:[i.jsx(qe,{asChild:!0,children:e.children}),i.jsx(ot,{children:i.jsx(Fe,{onCloseAutoFocus:n=>n.preventDefault(),onClick:n=>n.stopPropagation(),align:"end",className:b("oui-bg-base-8 oui-p-5 oui-pt-0 oui-w-[360px] oui-font-semibold"),children:a})})]})},Ql=e=>i.jsx("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:i.jsx("path",{d:"M3.832 1.994c-.736 0-1.333.597-1.333 1.333v9.334c0 .737.597 1.333 1.333 1.333H6.5c.737 0 1.333-.596 1.333-1.333V3.327c0-.736-.596-1.333-1.333-1.333zm6.667 0c-.737 0-1.333.597-1.333 1.333v2.667c0 .737.596 1.333 1.333 1.333h2.667c.736 0 1.333-.596 1.333-1.333V3.327c0-.736-.597-1.333-1.333-1.333zm.437 6.679a2.7 2.7 0 0 0-1.033.607.284.284 0 0 0-.061.339c.222.411-.01.851-.512.876a.29.29 0 0 0-.26.217c-.05.207-.07.38-.07.608 0 .19.02.407.06.599a.28.28 0 0 0 .252.217c.506.044.756.429.53.92a.28.28 0 0 0 .06.321c.296.273.635.466 1.034.59a.285.285 0 0 0 .312-.104c.31-.427.757-.428 1.05 0a.28.28 0 0 0 .313.113 2.8 2.8 0 0 0 1.042-.599.28.28 0 0 0 .06-.33c-.23-.466.035-.894.513-.902a.28.28 0 0 0 .269-.209c.048-.199.06-.372.06-.616q0-.316-.069-.616a.276.276 0 0 0-.27-.217c-.469-.001-.732-.463-.502-.868a.27.27 0 0 0-.053-.339 2.8 2.8 0 0 0-1.059-.607.274.274 0 0 0-.312.112c-.268.417-.77.425-1.033.009a.284.284 0 0 0-.321-.121m.842 1.536a1.111 1.111 0 1 1 0 2.222 1.111 1.111 0 0 1 0-2.222"})}),Kl=e=>i.jsxs("svg",{width:"36",height:"84",viewBox:"0 0 36 84",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("rect",{width:"36",height:"17",rx:"2",fill:"#181C23"}),i.jsx("rect",{y:"19",width:"36",height:"54",rx:"2",fill:"#181C23"}),i.jsx("rect",{y:"75",width:"36",height:"9",rx:"2",fill:"#181C23"}),i.jsx("rect",{x:"3",y:"79",width:"30",height:"1",rx:"0.5",fill:"url(#paint0_linear_17647_26849)"}),i.jsx("rect",{x:"3",y:"22",width:"14",height:"6",rx:"2",fill:"#008676"}),i.jsx("rect",{x:"19",y:"22",width:"14",height:"6",rx:"2",fill:"#D92D6B"}),i.jsx("rect",{x:"3",y:"11",width:"14",height:"3",rx:"1.5",fill:"#333948"}),i.jsx("rect",{x:"19",y:"11",width:"14",height:"3",rx:"1.5",fill:"#335FFC"}),i.jsx("rect",{x:"3",y:"62",width:"30",height:"8",rx:"2",fill:"#008676"}),i.jsx("defs",{children:i.jsxs("linearGradient",{id:"paint0_linear_17647_26849",x1:"33",y1:"79.5",x2:"3",y2:"79.5",gradientUnits:"userSpaceOnUse",children:[i.jsx("stop",{stopColor:"#59B0FE"}),i.jsx("stop",{offset:"1",stopColor:"#26FEFE"})]})})]}),kt=e=>{let{showIndicator:t=!0}=e,[s,r]=u.useState(!1);return i.jsxs(M,{intensity:900,r:"2xl",p:3,width:"100%",className:b("oui-relative",e.className),children:[e.children,i.jsx(at,{open:s,onOpenChange:r,side:"left",align:"start",sideOffset:-4,alignOffset:-4,content:i.jsx(m,{direction:"column",gapY:2,children:[Zl,Xl,Gl].map((o,a)=>i.jsx(o,{className:b("oui-rounded oui-cursor-pointer hover:oui-bg-base-5",e.index===a&&"oui-bg-base-5"),onClick:()=>{var n;(n=e.onLayout)==null||n.call(e,e.index,a),r(!1)}},a))}),delayDuration:0,className:b("oui-bg-base-9 oui-rounded","oui-border oui-border-line-12","oui-p-1"),arrow:{className:"oui-fill-transparent"},children:t&&i.jsx("div",{className:"oui-absolute oui-right-[1px] oui-top-[18px]",children:i.jsx(Yl,{className:b("oui-text-base-contrast-20 hover:oui-text-base-contrast-80","oui-cursor-pointer")})})})]})},Yl=e=>i.jsxs("svg",{width:"10",height:"16",viewBox:"0 0 10 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[i.jsx("rect",{x:"2",y:"2",width:"6",height:"2",rx:"1"}),i.jsx("rect",{x:"2",y:"7",width:"6",height:"2",rx:"1"}),i.jsx("rect",{x:"2",y:"12",width:"6",height:"2",rx:"1"})]}),Zl=e=>i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[i.jsx("rect",{x:"1.333",y:"2.667",width:"13.333",height:"4",rx:"2",fill:"rgb(var(--oui-color-primary))"}),i.jsx("rect",{x:"2.667",y:"12",width:"10.667",height:"1.333",rx:".667",fill:"#fff",fillOpacity:".2"}),i.jsx("rect",{x:"2.667",y:"8.667",width:"10.667",height:"1.333",rx:".667",fill:"#fff",fillOpacity:".2"})]}),Xl=e=>i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[i.jsx("rect",{x:"1.333",y:"6",width:"13.333",height:"4",rx:"2",fill:"rgb(var(--oui-color-primary))"}),i.jsx("rect",{x:"2.667",y:"12",width:"10.667",height:"1.333",rx:".667",fill:"#fff",fillOpacity:".2"}),i.jsx("rect",{x:"2.667",y:"2.667",width:"10.667",height:"1.333",rx:".667",fill:"#fff",fillOpacity:".2"})]}),Gl=e=>i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[i.jsx("rect",{x:"1.333",y:"9.333",width:"13.333",height:"4",rx:"2",fill:"rgb(var(--oui-color-primary))"}),i.jsx("rect",{x:"2.667",y:"6",width:"10.667",height:"1.333",rx:".667",fill:"#fff",fillOpacity:".2"}),i.jsx("rect",{x:"2.667",y:"2.667",width:"10.667",height:"1.333",rx:".667",fill:"#fff",fillOpacity:".2"})]}),Jl=e=>{let{collapsable:t,collapsed:s,onCollapse:r,layout:o,onLayout:a,orderBookSplitSize:n,setOrderbookSplitSize:l,dataListSplitSize:d,setDataListSplitSize:c,mainSplitSize:h,setMainSplitSize:p,dataListSplitHeightSM:g,setDataListSplitHeightSM:y,orderBookSplitHeightSM:f,setOrderbookSplitHeightSM:C,max2XL:j,max4XL:_,animating:P,setAnimating:k,positions:v,updatePositions:S,showPositionIcon:T,horizontalDraggable:I,marketsWidth:z,tradindviewMaxHeight:Z,dataListMinHeight:K}=e,R=Ci+ji+Ne+xe+K+ce*4,$=Ci+ji+Ne+Re+xe+K+ce*4,U=i.jsx(Pr,{collapsable:t,collapsed:s,onCollapse:r,symbol:e.symbol,onSymbolChange:e.onSymbolChange}),E=i.jsx(M,{intensity:900,pt:3,r:"2xl",height:"100%",width:z,style:{minWidth:z},className:"oui-transition-all oui-duration-150",onTransitionEnd:()=>{k(!1)},children:!P&&U}),G=u.useMemo(()=>i.jsx(Ul,{layout:o,onLayout:a}),[o,a]),ae=i.jsx(M,{intensity:900,r:"2xl",px:3,width:"100%",style:{minHeight:Ne,height:Ne},children:i.jsx(Tr,{symbol:e.symbol,onSymbolChange:e.onSymbolChange,trailing:G})}),{library_path:Ue,...We}=e.tradingViewConfig,ne=i.jsx(ss,{symbol:e.symbol,...We,libraryPath:Ue}),de=i.jsx(M,{width:"100%",height:"100%",intensity:900,r:"2xl",style:{flex:1,minWidth:mt},className:"oui-overflow-hidden",children:ne}),we=i.jsx($n,{symbol:e.symbol}),Qe=i.jsx(M,{r:"2xl",height:"100%",style:{minWidth:ht,maxWidth:I?Al:ht,width:n},className:"oui-overflow-hidden",children:we}),O=i.jsx(Wa,{current:void 0,symbol:e.symbol,sharePnLConfig:e.sharePnLConfig}),V=i.jsx(M,{intensity:900,r:"2xl",p:3,style:{height:d,minHeight:K},className:"oui-overflow-hidden",children:O}),oe=[i.jsx(kt,{className:"oui-border oui-border-line-12",index:v.findIndex(X=>X===0),onLayout:S,showIndicator:T,children:i.jsx(on,{})},"assets"),i.jsx(kt,{index:v.findIndex(X=>X===1),onLayout:S,showIndicator:T,children:i.jsx(qi,{symbol:e.symbol})},"orderEntry"),i.jsx(kt,{index:v.findIndex(X=>X===2),onLayout:S,showIndicator:T,children:i.jsx(En,{})},"margin")],Y=v.map(X=>oe[X]),ie=i.jsx(m,{gapY:3,direction:"column",height:"100%",style:{minWidth:Nt,maxWidth:I?Rl:Nt,width:h},children:Y}),Le=i.jsxs(Ze,{style:{flex:1,minHeight:xe},onSizeChange:l,disable:!I,children:[_&&o==="right"?i.jsxs(m,{gap:3,className:"oui-flex-1 oui-overflow-hidden",style:{minWidth:z+mt+ce},children:[E,de]}):de,Qe]}),D=()=>_&&o==="left"?i.jsxs(m,{gapX:3,style:{minHeight:xe},height:"100%",children:[Le,E]}):Le,ge=i.jsxs(m,{direction:"column",className:"oui-flex-1 oui-overflow-hidden",gap:3,style:{minWidth:_?z+mt+ht+ce*2:mt+ht+ce},children:[ae,i.jsxs(Ze,{className:"oui-w-full !oui-h-[calc(100%_-_54px_-_12px)]",mode:"vertical",onSizeChange:c,children:[D(),V]})]}),Me=X=>p(o==="left"?ql(X):X);return j?i.jsxs(Ze,{ref:e.max2XLSplitRef,style:{minHeight:$,minWidth:1024-vi},className:b("oui-flex oui-flex-1 ","oui-min-w-[1018px] oui-h-full oui-w-full","oui-p-3",e.className),onSizeChange:y,onDragging:e.onDataListSplitHeightDragging,mode:"vertical",children:[i.jsxs(m,{gapX:3,itemAlign:"stretch",className:b("oui-flex-1",o==="left"&&"oui-flex-row-reverse"),style:{minHeight:Math.max(Ne+Re+xe+ce*2,e.orderEntryHeight),maxHeight:Ne+Z+ze+ce*2},children:[i.jsxs(m,{height:"100%",className:"oui-flex-1 oui-w-[calc(100%_-_280px_-_12px)]",direction:"column",gapY:3,children:[ae,i.jsxs(m,{width:"100%",height:"100%",gapX:3,itemAlign:"stretch",style:{minHeight:Re+xe+ce,maxHeight:Z+ze+ce},className:b("oui-flex-1",o==="left"&&"oui-flex-row-reverse"),children:[i.jsx(M,{intensity:900,pt:3,r:"2xl",width:z,style:{minHeight:Re+xe+ce,maxHeight:Z+ze+ce},children:U}),i.jsxs(Ze,{ref:e.tradingviewAndOrderbookSplitRef,mode:"vertical",style:{width:`calc(100% - ${z}px)`},className:"oui-flex-1",onSizeChange:C,onDragging:e.onTradingviewAndOrderbookDragging,children:[i.jsx(M,{width:"100%",intensity:900,r:"2xl",style:{minHeight:Re,maxHeight:Z,height:1200},children:ne}),i.jsx(M,{r:"2xl",height:"100%",width:"100%",style:{minHeight:xe,maxHeight:ze,height:f},className:"oui-flex-1",children:we})]})]})]}),i.jsxs(m,{ref:e.orderEntryViewRef,gapY:3,direction:"column",style:{width:Nt,height:"max-content"},children:[Y,i.jsx(M,{height:e.extraHeight})]})]}),i.jsx(M,{intensity:900,r:"2xl",p:3,style:{height:g,minHeight:Math.max(K,e.dataListHeight),maxHeight:vs},className:"oui-overflow-hidden",children:O})]}):i.jsxs(m,{style:{minHeight:R,minWidth:1440-vi},className:b(e.className,o==="left"&&"oui-flex-row-reverse"),width:"100%",p:3,gap:3,children:[!_&&E,i.jsxs(Ze,{className:"oui-flex oui-flex-1 oui-overflow-hidden",onSizeChange:Me,disable:!I,children:[o==="left"&&ie,ge,o==="right"&&ie]})]})},eu=e=>{let{isMobile:t}=st();return t?i.jsx(Dl,{...e}):i.jsx(Jl,{className:"oui-h-[calc(100vh_-_48px_-_29px)] oui-bg-base-10",...e})},tu=()=>{let e=zl();return i.jsx(eu,{...e})},du=e=>i.jsx(Da,{symbol:e.symbol,tradingViewConfig:e.tradingViewConfig,onSymbolChange:e.onSymbolChange,disableFeatures:e.disableFeatures,overrideFeatures:e.overrideFeatures,referral:e.referral,tradingRewards:e.tradingRewards,bottomSheetLeading:e.bottomSheetLeading,sharePnLConfig:e.sharePnLConfig,children:i.jsx(tu,{})});export{Te as G,du as O};
